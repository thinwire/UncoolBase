var __extends=this&&this.__extends||function(){var h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,c){d.__proto__=c}||function(d,c){for(var b in c)c.hasOwnProperty(b)&&(d[b]=c[b])};return function(d,c){function b(){this.constructor=d}h(d,c);d.prototype=null===c?Object.create(c):(b.prototype=c.prototype,new b)}}();
(function(){var h="undefined"!==typeof module&&module.exports,d="undefined"!==typeof Element&&"ALLOW_KEYBOARD_INPUT"in Element,c=function(){var a,b,f=["requestFullscreen exitFullscreen fullscreenElement fullscreenEnabled fullscreenchange fullscreenerror".split(" "),"webkitRequestFullscreen webkitExitFullscreen webkitFullscreenElement webkitFullscreenEnabled webkitfullscreenchange webkitfullscreenerror".split(" "),"webkitRequestFullScreen webkitCancelFullScreen webkitCurrentFullScreenElement webkitCancelFullScreen webkitfullscreenchange webkitfullscreenerror".split(" "),
"mozRequestFullScreen mozCancelFullScreen mozFullScreenElement mozFullScreenEnabled mozfullscreenchange mozfullscreenerror".split(" "),"msRequestFullscreen msExitFullscreen msFullscreenElement msFullscreenEnabled MSFullscreenChange MSFullscreenError".split(" ")],l=0;b=f.length;for(var k={};l<b;l++)if((a=f[l])&&a[1]in document){l=0;for(b=a.length;l<b;l++)k[f[0][l]]=a[l];return k}return!1}(),b={request:function(a){var b=c.requestFullscreen;a=a||document.documentElement;if(/5\.1[\.\d]* Safari/.test(navigator.userAgent))a[b]();
else a[b](d&&Element.ALLOW_KEYBOARD_INPUT)},exit:function(){document[c.exitFullscreen]()},toggle:function(a){this.isFullscreen?this.exit():this.request(a)},raw:c};c?(Object.defineProperties(b,{isFullscreen:{get:function(){return!!document[c.fullscreenElement]}},element:{enumerable:!0,get:function(){return document[c.fullscreenElement]}},enabled:{enumerable:!0,get:function(){return!!document[c.fullscreenEnabled]}}}),h?module.exports=b:window.screenfull=b):h?module.exports=!1:window.screenfull=!1})();
(function(h){"object"===typeof exports&&"undefined"!==typeof module?module.exports=h():"function"===typeof define&&define.amd?define([],h):("undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof self?self:this).Matter=h()})(function(){return function d(c,b,a){function e(k,l){if(!b[k]){if(!c[k]){var n="function"==typeof require&&require;if(!l&&n)return n(k,!0);if(f)return f(k,!0);n=Error("Cannot find module '"+k+"'");throw n.code="MODULE_NOT_FOUND",n;}n=b[k]={exports:{}};
c[k][0].call(n.exports,function(a){var b=c[k][1][a];return e(b?b:a)},n,n.exports,d,c,b,a)}return b[k].exports}for(var f="function"==typeof require&&require,l=0;l<a.length;l++)e(a[l]);return e}({1:[function(d,c,b){var a={};c.exports=a;var e=d("../geometry/Vertices"),f=d("../geometry/Vector"),l=d("../core/Sleeping");d("../render/Render");var k=d("../core/Common"),x=d("../geometry/Bounds"),n=d("../geometry/Axes");(function(){a._inertiaScale=4;a._nextCollidingGroupId=1;a._nextNonCollidingGroupId=-1;a._nextCategory=
1;a.create=function(b){var g={id:k.nextId(),type:"body",label:"Body",parts:[],angle:0,vertices:e.fromPath("L 0 0 L 40 0 L 40 40 L 0 40"),position:{x:0,y:0},force:{x:0,y:0},torque:0,positionImpulse:{x:0,y:0},constraintImpulse:{x:0,y:0,angle:0},totalContacts:0,speed:0,angularSpeed:0,velocity:{x:0,y:0},angularVelocity:0,isSensor:!1,isStatic:!1,isSleeping:!1,motion:0,sleepThreshold:60,density:.001,restitution:0,friction:.1,frictionStatic:.5,frictionAir:.01,collisionFilter:{category:1,mask:4294967295,
group:0},slop:.05,timeScale:1,render:{visible:!0,opacity:1,sprite:{xScale:1,yScale:1,xOffset:0,yOffset:0},lineWidth:1.5}},g=k.extend(g,b);a.set(g,{bounds:g.bounds||x.create(g.vertices),positionPrev:g.positionPrev||f.clone(g.position),anglePrev:g.anglePrev||g.angle,vertices:g.vertices,parts:g.parts||[g],isStatic:g.isStatic,isSleeping:g.isSleeping,parent:g.parent||g});e.rotate(g.vertices,g.angle,g.position);n.rotate(g.axes,g.angle);x.update(g.bounds,g.vertices,g.velocity);a.set(g,{axes:b.axes||g.axes,
area:b.area||g.area,mass:b.mass||g.mass,inertia:b.inertia||g.inertia});b=g.isStatic?"#eeeeee":k.choose(["#556270","#4ECDC4","#C7F464","#FF6B6B","#C44D58"]);var m=k.shadeColor(b,-20);g.render.fillStyle=g.render.fillStyle||b;g.render.strokeStyle=g.render.strokeStyle||m;g.render.sprite.xOffset+=-(g.bounds.min.x-g.position.x)/(g.bounds.max.x-g.bounds.min.x);g.render.sprite.yOffset+=-(g.bounds.min.y-g.position.y)/(g.bounds.max.y-g.bounds.min.y);return g};a.nextGroup=function(b){return b?a._nextNonCollidingGroupId--:
a._nextCollidingGroupId++};a.nextCategory=function(){a._nextCategory<<=1;return a._nextCategory};a.set=function(b,e,f){var n;"string"===typeof e&&(n=e,e={},e[n]=f);for(n in e)if(f=e[n],e.hasOwnProperty(n))switch(n){case "isStatic":a.setStatic(b,f);break;case "isSleeping":l.set(b,f);break;case "mass":a.setMass(b,f);break;case "density":a.setDensity(b,f);break;case "inertia":a.setInertia(b,f);break;case "vertices":a.setVertices(b,f);break;case "position":a.setPosition(b,f);break;case "angle":a.setAngle(b,
f);break;case "velocity":a.setVelocity(b,f);break;case "angularVelocity":a.setAngularVelocity(b,f);break;case "parts":a.setParts(b,f);break;default:b[n]=f}};a.setStatic=function(a,b){for(var e=0;e<a.parts.length;e++){var f=a.parts[e];if(f.isStatic=b)f.restitution=0,f.friction=1,f.mass=f.inertia=f.density=Infinity,f.inverseMass=f.inverseInertia=0,f.positionPrev.x=f.position.x,f.positionPrev.y=f.position.y,f.anglePrev=f.angle,f.angularVelocity=0,f.speed=0,f.angularSpeed=0,f.motion=0}};a.setMass=function(a,
b){a.mass=b;a.inverseMass=1/a.mass;a.density=a.mass/a.area};a.setDensity=function(b,e){a.setMass(b,e*b.area);b.density=e};a.setInertia=function(a,b){a.inertia=b;a.inverseInertia=1/a.inertia};a.setVertices=function(b,f){b.vertices=f[0].body===b?f:e.create(f,b);b.axes=n.fromVertices(b.vertices);b.area=e.area(b.vertices);a.setMass(b,b.density*b.area);var m=e.centre(b.vertices);e.translate(b.vertices,m,-1);a.setInertia(b,a._inertiaScale*e.inertia(b.vertices,b.mass));e.translate(b.vertices,b.position);
x.update(b.bounds,b.vertices,b.velocity)};a.setParts=function(f,n,k){var l;n=n.slice(0);f.parts.length=0;f.parts.push(f);f.parent=f;for(l=0;l<n.length;l++){var c=n[l];c!==f&&(c.parent=f,f.parts.push(c))}if(1!==f.parts.length){if("undefined"!==typeof k?k:1){k=[];for(l=0;l<n.length;l++)k=k.concat(n[l].vertices);e.clockwiseSort(k);n=e.hull(k);l=e.centre(n);a.setVertices(f,n);e.translate(f.vertices,l)}n=b(f);f.area=n.area;f.parent=f;f.position.x=n.centre.x;f.position.y=n.centre.y;f.positionPrev.x=n.centre.x;
f.positionPrev.y=n.centre.y;a.setMass(f,n.mass);a.setInertia(f,n.inertia);a.setPosition(f,n.centre)}};a.setPosition=function(a,b){var n=f.sub(b,a.position);a.positionPrev.x+=n.x;a.positionPrev.y+=n.y;for(var m=0;m<a.parts.length;m++){var k=a.parts[m];k.position.x+=n.x;k.position.y+=n.y;e.translate(k.vertices,n);x.update(k.bounds,k.vertices,a.velocity)}};a.setAngle=function(a,b){var m=b-a.angle;a.anglePrev+=m;for(var k=0;k<a.parts.length;k++){var l=a.parts[k];l.angle+=m;e.rotate(l.vertices,m,a.position);
n.rotate(l.axes,m);x.update(l.bounds,l.vertices,a.velocity);0<k&&f.rotateAbout(l.position,m,a.position,l.position)}};a.setVelocity=function(a,b){a.positionPrev.x=a.position.x-b.x;a.positionPrev.y=a.position.y-b.y;a.velocity.x=b.x;a.velocity.y=b.y;a.speed=f.magnitude(a.velocity)};a.setAngularVelocity=function(a,b){a.anglePrev=a.angle-b;a.angularVelocity=b;a.angularSpeed=Math.abs(a.angularVelocity)};a.translate=function(b,e){a.setPosition(b,f.add(b.position,e))};a.rotate=function(b,e){a.setAngle(b,
b.angle+e)};a.scale=function(f,k,l,c){for(c=0;c<f.parts.length;c++){var d=f.parts[c];e.scale(d.vertices,k,l,f.position);d.axes=n.fromVertices(d.vertices);f.isStatic||(d.area=e.area(d.vertices),a.setMass(d,f.density*d.area),e.translate(d.vertices,{x:-d.position.x,y:-d.position.y}),a.setInertia(d,e.inertia(d.vertices,d.mass)),e.translate(d.vertices,{x:d.position.x,y:d.position.y}));x.update(d.bounds,d.vertices,f.velocity)}f.circleRadius&&(f.circleRadius=k===l?f.circleRadius*k:null);f.isStatic||(k=b(f),
f.area=k.area,a.setMass(f,k.mass),a.setInertia(f,k.inertia))};a.update=function(a,b,m,k){b=Math.pow(b*m*a.timeScale,2);m=1-a.frictionAir*m*a.timeScale;var l=a.position.y-a.positionPrev.y;a.velocity.x=(a.position.x-a.positionPrev.x)*m*k+a.force.x/a.mass*b;a.velocity.y=l*m*k+a.force.y/a.mass*b;a.positionPrev.x=a.position.x;a.positionPrev.y=a.position.y;a.position.x+=a.velocity.x;a.position.y+=a.velocity.y;a.angularVelocity=(a.angle-a.anglePrev)*m*k+a.torque/a.inertia*b;a.anglePrev=a.angle;a.angle+=
a.angularVelocity;a.speed=f.magnitude(a.velocity);a.angularSpeed=Math.abs(a.angularVelocity);for(k=0;k<a.parts.length;k++)b=a.parts[k],e.translate(b.vertices,a.velocity),0<k&&(b.position.x+=a.velocity.x,b.position.y+=a.velocity.y),0!==a.angularVelocity&&(e.rotate(b.vertices,a.angularVelocity,a.position),n.rotate(b.axes,a.angularVelocity),0<k&&f.rotateAbout(b.position,a.angularVelocity,a.position,b.position)),x.update(b.bounds,b.vertices,a.velocity)};a.applyForce=function(a,b,e){a.force.x+=e.x;a.force.y+=
e.y;a.torque+=(b.x-a.position.x)*e.y-(b.y-a.position.y)*e.x};var b=function(a){for(var b={mass:0,area:0,inertia:0,centre:{x:0,y:0}},e=1===a.parts.length?0:1;e<a.parts.length;e++){var n=a.parts[e];b.mass+=n.mass;b.area+=n.area;b.inertia+=n.inertia;b.centre=f.add(b.centre,f.mult(n.position,Infinity!==n.mass?n.mass:1))}b.centre=f.div(b.centre,Infinity!==b.mass?b.mass:a.parts.length);return b}})()},{"../core/Common":14,"../core/Sleeping":20,"../geometry/Axes":23,"../geometry/Bounds":24,"../geometry/Vector":26,
"../geometry/Vertices":27,"../render/Render":29}],2:[function(d,c,b){var a={};c.exports=a;var e=d("../core/Events"),f=d("../core/Common"),l=d("./Body");(function(){a.create=function(a){return f.extend({id:f.nextId(),type:"composite",parent:null,isModified:!1,bodies:[],constraints:[],composites:[],label:"Composite"},a)};a.setModified=function(b,e,f,m){b.isModified=e;f&&b.parent&&a.setModified(b.parent,e,f,m);if(m)for(var l=0;l<b.composites.length;l++)a.setModified(b.composites[l],e,f,m)};a.add=function(b,
l){var n=[].concat(l);e.trigger(b,"beforeAdd",{object:l});for(var m=0;m<n.length;m++){var c=n[m];switch(c.type){case "body":if(c.parent!==c){f.log("Composite.add: skipped adding a compound body part (you must add its parent instead)","warn");break}a.addBody(b,c);break;case "constraint":a.addConstraint(b,c);break;case "composite":a.addComposite(b,c);break;case "mouseConstraint":a.addConstraint(b,c.constraint)}}e.trigger(b,"afterAdd",{object:l});return b};a.remove=function(b,f,n){var m=[].concat(f);
e.trigger(b,"beforeRemove",{object:f});for(var l=0;l<m.length;l++){var c=m[l];switch(c.type){case "body":a.removeBody(b,c,n);break;case "constraint":a.removeConstraint(b,c,n);break;case "composite":a.removeComposite(b,c,n);break;case "mouseConstraint":a.removeConstraint(b,c.constraint)}}e.trigger(b,"afterRemove",{object:f});return b};a.addComposite=function(b,e){b.composites.push(e);e.parent=b;a.setModified(b,!0,!0,!1);return b};a.removeComposite=function(b,e,n){var m=f.indexOf(b.composites,e);-1!==
m&&(a.removeCompositeAt(b,m),a.setModified(b,!0,!0,!1));if(n)for(n=0;n<b.composites.length;n++)a.removeComposite(b.composites[n],e,!0);return b};a.removeCompositeAt=function(b,e){b.composites.splice(e,1);a.setModified(b,!0,!0,!1);return b};a.addBody=function(b,e){b.bodies.push(e);a.setModified(b,!0,!0,!1);return b};a.removeBody=function(b,e,n){var m=f.indexOf(b.bodies,e);-1!==m&&(a.removeBodyAt(b,m),a.setModified(b,!0,!0,!1));if(n)for(n=0;n<b.composites.length;n++)a.removeBody(b.composites[n],e,!0);
return b};a.removeBodyAt=function(b,e){b.bodies.splice(e,1);a.setModified(b,!0,!0,!1);return b};a.addConstraint=function(b,e){b.constraints.push(e);a.setModified(b,!0,!0,!1);return b};a.removeConstraint=function(b,e,n){var m=f.indexOf(b.constraints,e);-1!==m&&a.removeConstraintAt(b,m);if(n)for(n=0;n<b.composites.length;n++)a.removeConstraint(b.composites[n],e,!0);return b};a.removeConstraintAt=function(b,e){b.constraints.splice(e,1);a.setModified(b,!0,!0,!1);return b};a.clear=function(b,e,f){if(f)for(f=
0;f<b.composites.length;f++)a.clear(b.composites[f],e,!0);e?b.bodies=b.bodies.filter(function(a){return a.isStatic}):b.bodies.length=0;b.constraints.length=0;b.composites.length=0;a.setModified(b,!0,!0,!1);return b};a.allBodies=function(b){for(var e=[].concat(b.bodies),f=0;f<b.composites.length;f++)e=e.concat(a.allBodies(b.composites[f]));return e};a.allConstraints=function(b){for(var e=[].concat(b.constraints),f=0;f<b.composites.length;f++)e=e.concat(a.allConstraints(b.composites[f]));return e};
a.allComposites=function(b){for(var e=[].concat(b.composites),f=0;f<b.composites.length;f++)e=e.concat(a.allComposites(b.composites[f]));return e};a.get=function(b,e,f){var m;switch(f){case "body":m=a.allBodies(b);break;case "constraint":m=a.allConstraints(b);break;case "composite":m=a.allComposites(b).concat(b)}if(!m)return null;b=m.filter(function(a){return a.id.toString()===e.toString()});return 0===b.length?null:b[0]};a.move=function(b,e,f){a.remove(b,e);a.add(f,e);return b};a.rebase=function(b){for(var e=
a.allBodies(b).concat(a.allConstraints(b)).concat(a.allComposites(b)),n=0;n<e.length;n++)e[n].id=f.nextId();a.setModified(b,!0,!0,!1);return b};a.translate=function(b,e,f){f=f?a.allBodies(b):b.bodies;for(var m=0;m<f.length;m++)l.translate(f[m],e);a.setModified(b,!0,!0,!1);return b};a.rotate=function(b,e,f,m){var c=Math.cos(e),g=Math.sin(e);m=m?a.allBodies(b):b.bodies;for(var q=0;q<m.length;q++){var d=m[q],t=d.position.x-f.x,p=d.position.y-f.y;l.setPosition(d,{x:f.x+(t*c-p*g),y:f.y+(t*g+p*c)});l.rotate(d,
e)}a.setModified(b,!0,!0,!1);return b};a.scale=function(b,e,f,m,c){c=c?a.allBodies(b):b.bodies;for(var g=0;g<c.length;g++){var q=c[g];l.setPosition(q,{x:m.x+(q.position.x-m.x)*e,y:m.y+(q.position.y-m.y)*f});l.scale(q,e,f)}a.setModified(b,!0,!0,!1);return b}})()},{"../core/Common":14,"../core/Events":16,"./Body":1}],3:[function(d,c,b){var a={};c.exports=a;var e=d("./Composite");d("../constraint/Constraint");var f=d("../core/Common");(function(){a.create=function(a){var b=e.create();return f.extend(b,
{label:"World",gravity:{x:0,y:1,scale:.001},bounds:{min:{x:-Infinity,y:-Infinity},max:{x:Infinity,y:Infinity}}},a)}})()},{"../constraint/Constraint":12,"../core/Common":14,"./Composite":2}],4:[function(d,c,b){var a={};c.exports=a;(function(){a.create=function(b){return{id:a.id(b),vertex:b,normalImpulse:0,tangentImpulse:0}};a.id=function(a){return a.body.id+"_"+a.index}})()},{}],5:[function(d,c,b){var a={};c.exports=a;var e=d("./SAT"),f=d("./Pair"),l=d("../geometry/Bounds");(function(){a.collisions=
function(b,c){for(var n=[],m=c.pairs.table,d=0;d<b.length;d++){var g=b[d][0],q=b[d][1];if((!g.isStatic&&!g.isSleeping||!q.isStatic&&!q.isSleeping)&&a.canCollide(g.collisionFilter,q.collisionFilter)&&l.overlaps(g.bounds,q.bounds))for(var v=1<g.parts.length?1:0;v<g.parts.length;v++)for(var t=g.parts[v],p=1<q.parts.length?1:0;p<q.parts.length;p++){var u=q.parts[p];if(t===g&&u===q||l.overlaps(t.bounds,u.bounds)){var r=f.id(t,u),r=m[r],u=e.collides(t,u,r&&r.isActive?r.collision:null);u.collided&&n.push(u)}}}return n};
a.canCollide=function(a,b){return a.group===b.group&&0!==a.group?0<a.group:0!==(a.mask&b.category)&&0!==(b.mask&a.category)}})()},{"../geometry/Bounds":24,"./Pair":7,"./SAT":11}],6:[function(d,c,b){var a={};c.exports=a;var e=d("./Pair"),f=d("./Detector"),l=d("../core/Common");(function(){a.create=function(b){return l.extend({controller:a,detector:f.collisions,buckets:{},pairs:{},pairsList:[],bucketWidth:48,bucketHeight:48},b)};a.update=function(a,f,m,c){var g,q,d=m.world,t=a.buckets,p,u;g=!1;for(m=
0;m<f.length;m++){var r=f[m];if(!(r.isSleeping&&!c||r.bounds.max.x<d.bounds.min.x||r.bounds.min.x>d.bounds.max.x||r.bounds.max.y<d.bounds.min.y||r.bounds.min.y>d.bounds.max.y)){var B;B=r.bounds;B=b(Math.floor(B.min.x/a.bucketWidth),Math.floor(B.max.x/a.bucketWidth),Math.floor(B.min.y/a.bucketHeight),Math.floor(B.max.y/a.bucketHeight));if(!r.region||B.id!==r.region.id||c){if(!r.region||c)r.region=B;var y;g=r.region;y=b(Math.min(B.startCol,g.startCol),Math.max(B.endCol,g.endCol),Math.min(B.startRow,
g.startRow),Math.max(B.endRow,g.endRow));for(g=y.startCol;g<=y.endCol;g++)for(q=y.startRow;q<=y.endRow;q++){u=g+","+q;p=t[u];var A=g>=B.startCol&&g<=B.endCol&&q>=B.startRow&&q<=B.endRow,z=g>=r.region.startCol&&g<=r.region.endCol&&q>=r.region.startRow&&q<=r.region.endRow;if(!A&&z&&z&&p){var C=a,E=p,F=r;E.splice(l.indexOf(E,F),1);for(var G=0;G<E.length;G++){var D=e.id(F,E[G]);(D=C.pairs[D])&&--D[2]}}if(r.region===B||A&&!z||c){p||(p=t[u]=[]);u=a;A=r;for(z=0;z<p.length;z++)C=p[z],A.id===C.id||A.isStatic&&
C.isStatic||(E=e.id(A,C),(F=u.pairs[E])?F[2]+=1:u.pairs[E]=[A,C,1]);p.push(A)}}r.region=B;g=!0}}}if(g){m=[];f=l.keys(a.pairs);for(d=0;d<f.length;d++)c=a.pairs[f[d]],0<c[2]?m.push(c):delete a.pairs[f[d]];a.pairsList=m}};a.clear=function(a){a.buckets={};a.pairs={};a.pairsList=[]};var b=function(a,b,e,f){return{id:a+","+b+","+e+","+f,startCol:a,endCol:b,startRow:e,endRow:f}}})()},{"../core/Common":14,"./Detector":5,"./Pair":7}],7:[function(d,c,b){var a={};c.exports=a;var e=d("./Contact");(function(){a.create=
function(b,e){var c=b.bodyA,d=b.bodyB,n=b.parentA,m=b.parentB,c={id:a.id(c,d),bodyA:c,bodyB:d,contacts:{},activeContacts:[],separation:0,isActive:!0,isSensor:c.isSensor||d.isSensor,timeCreated:e,timeUpdated:e,inverseMass:n.inverseMass+m.inverseMass,friction:Math.min(n.friction,m.friction),frictionStatic:Math.max(n.frictionStatic,m.frictionStatic),restitution:Math.max(n.restitution,m.restitution),slop:Math.max(n.slop,m.slop)};a.update(c,b,e);return c};a.update=function(b,c,d){var x=b.contacts,n=c.supports,
m=b.activeContacts,w=c.parentA,g=c.parentB;b.collision=c;b.inverseMass=w.inverseMass+g.inverseMass;b.friction=Math.min(w.friction,g.friction);b.frictionStatic=Math.max(w.frictionStatic,g.frictionStatic);b.restitution=Math.max(w.restitution,g.restitution);b.slop=Math.max(w.slop,g.slop);m.length=0;if(c.collided){for(w=0;w<n.length;w++){var g=n[w],q=e.id(g),v=x[q];v?m.push(v):m.push(x[q]=e.create(g))}b.separation=c.depth;a.setActive(b,!0,d)}else!0===b.isActive&&a.setActive(b,!1,d)};a.setActive=function(a,
b,e){b?(a.isActive=!0,a.timeUpdated=e):(a.isActive=!1,a.activeContacts.length=0)};a.id=function(a,b){return a.id<b.id?a.id+"_"+b.id:b.id+"_"+a.id}})()},{"./Contact":4}],8:[function(d,c,b){var a={};c.exports=a;var e=d("./Pair"),f=d("../core/Common");(function(){a.create=function(a){return f.extend({table:{},list:[],collisionStart:[],collisionActive:[],collisionEnd:[]},a)};a.update=function(a,b,c){var n=a.list,m=a.table,d=a.collisionStart,g=a.collisionEnd;a=a.collisionActive;var q=[],v,t,p,u;d.length=
0;g.length=0;for(u=a.length=0;u<b.length;u++)v=b[u],v.collided&&(t=e.id(v.bodyA,v.bodyB),q.push(t),(p=m[t])?(p.isActive?a.push(p):d.push(p),e.update(p,v,c)):(p=e.create(v,c),m[t]=p,d.push(p),n.push(p)));for(u=0;u<n.length;u++)p=n[u],p.isActive&&-1===f.indexOf(q,p.id)&&(e.setActive(p,!1,c),g.push(p))};a.removeOld=function(a,b){var e=a.list,f=a.table,m=[],c,g,q;for(q=0;q<e.length;q++)c=e[q],g=c.collision,g.bodyA.isSleeping||g.bodyB.isSleeping?c.timeUpdated=b:1E3<b-c.timeUpdated&&m.push(q);for(q=0;q<
m.length;q++)g=m[q]-q,c=e[g],delete f[c.id],e.splice(g,1)};a.clear=function(a){a.table={};a.list.length=0;a.collisionStart.length=0;a.collisionActive.length=0;a.collisionEnd.length=0;return a}})()},{"../core/Common":14,"./Pair":7}],9:[function(d,c,b){var a={};c.exports=a;var e=d("../geometry/Vector"),f=d("./SAT"),l=d("../geometry/Bounds"),k=d("../factory/Bodies"),x=d("../geometry/Vertices");(function(){a.ray=function(a,b,c,g){g=g||1E-100;var q=e.angle(b,c),d=e.magnitude(e.sub(b,c));b=k.rectangle(.5*
(c.x+b.x),.5*(c.y+b.y),d,g,{angle:q});c=[];for(g=0;g<a.length;g++)if(q=a[g],l.overlaps(q.bounds,b.bounds))for(d=1===q.parts.length?0:1;d<q.parts.length;d++){var t=q.parts[d];if(l.overlaps(t.bounds,b.bounds)&&(t=f.collides(t,b),t.collided)){t.body=t.bodyA=t.bodyB=q;c.push(t);break}}return c};a.region=function(a,b,e){for(var f=[],c=0;c<a.length;c++){var d=a[c],k=l.overlaps(d.bounds,b);(k&&!e||!k&&e)&&f.push(d)}return f};a.point=function(a,b){for(var e=[],f=0;f<a.length;f++){var c=a[f];if(l.contains(c.bounds,
b))for(var d=1===c.parts.length?0:1;d<c.parts.length;d++){var k=c.parts[d];if(l.contains(k.bounds,b)&&x.contains(k.vertices,b)){e.push(c);break}}}return e}})()},{"../factory/Bodies":21,"../geometry/Bounds":24,"../geometry/Vector":26,"../geometry/Vertices":27,"./SAT":11}],10:[function(d,c,b){var a={};c.exports=a;var e=d("../geometry/Vertices"),f=d("../geometry/Vector"),l=d("../core/Common"),k=d("../geometry/Bounds");(function(){a._restingThresh=4;a._restingThreshTangent=6;a._positionDampen=.9;a._positionWarming=
.8;a._frictionNormalMultiplier=5;a.preSolvePosition=function(a){var b,e,f;for(b=0;b<a.length;b++)e=a[b],e.isActive&&(f=e.activeContacts.length,e.collision.parentA.totalContacts+=f,e.collision.parentB.totalContacts+=f)};a.solvePosition=function(b,e){var c,l,g,d,k,t,p;p=f._temp[0];var u=f._temp[1],r=f._temp[2],B=f._temp[3];for(c=0;c<b.length;c++)l=b[c],l.isActive&&!l.isSensor&&(g=l.collision,d=g.parentA,k=g.parentB,t=g.normal,d=f.sub(f.add(k.positionImpulse,k.position,p),f.add(d.positionImpulse,f.sub(k.position,
g.penetration,u),r),B),l.separation=f.dot(t,d));for(c=0;c<b.length;c++)if(l=b[c],!(!l.isActive||l.isSensor||0>l.separation)){g=l.collision;d=g.parentA;k=g.parentB;t=g.normal;p=(l.separation-l.slop)*e;if(d.isStatic||k.isStatic)p*=2;d.isStatic||d.isSleeping||(l=a._positionDampen/d.totalContacts,d.positionImpulse.x+=t.x*p*l,d.positionImpulse.y+=t.y*p*l);k.isStatic||k.isSleeping||(l=a._positionDampen/k.totalContacts,k.positionImpulse.x-=t.x*p*l,k.positionImpulse.y-=t.y*p*l)}};a.postSolvePosition=function(b){for(var c=
0;c<b.length;c++){var m=b[c];m.totalContacts=0;if(0!==m.positionImpulse.x||0!==m.positionImpulse.y){for(var l=0;l<m.parts.length;l++){var d=m.parts[l];e.translate(d.vertices,m.positionImpulse);k.update(d.bounds,d.vertices,m.velocity);d.position.x+=m.positionImpulse.x;d.position.y+=m.positionImpulse.y}m.positionPrev.x+=m.positionImpulse.x;m.positionPrev.y+=m.positionImpulse.y;0>f.dot(m.positionImpulse,m.velocity)?(m.positionImpulse.x=0,m.positionImpulse.y=0):(m.positionImpulse.x*=a._positionWarming,
m.positionImpulse.y*=a._positionWarming)}}};a.preSolveVelocity=function(a){var b,e,c,l,d,k,t,p,u,r,B=f._temp[0],y=f._temp[1];for(b=0;b<a.length;b++)if(c=a[b],c.isActive&&!c.isSensor)for(l=c.activeContacts,e=c.collision,c=e.parentA,d=e.parentB,k=e.normal,t=e.tangent,e=0;e<l.length;e++)if(p=l[e],u=p.vertex,r=p.normalImpulse,p=p.tangentImpulse,0!==r||0!==p)B.x=k.x*r+t.x*p,B.y=k.y*r+t.y*p,c.isStatic||c.isSleeping||(r=f.sub(u,c.position,y),c.positionPrev.x+=B.x*c.inverseMass,c.positionPrev.y+=B.y*c.inverseMass,
c.anglePrev+=f.cross(r,B)*c.inverseInertia),d.isStatic||d.isSleeping||(r=f.sub(u,d.position,y),d.positionPrev.x-=B.x*d.inverseMass,d.positionPrev.y-=B.y*d.inverseMass,d.anglePrev-=f.cross(r,B)*d.inverseInertia)};a.solveVelocity=function(b,e){for(var c=e*e,d=f._temp[0],g=f._temp[1],q=f._temp[2],k=f._temp[3],t=f._temp[4],p=f._temp[5],u=0;u<b.length;u++){var r=b[u];if(r.isActive&&!r.isSensor){var B=r.collision,y=B.parentA,A=B.parentB,z=B.normal,B=B.tangent,C=r.activeContacts,E=1/C.length;y.velocity.x=
y.position.x-y.positionPrev.x;y.velocity.y=y.position.y-y.positionPrev.y;A.velocity.x=A.position.x-A.positionPrev.x;A.velocity.y=A.position.y-A.positionPrev.y;y.angularVelocity=y.angle-y.anglePrev;A.angularVelocity=A.angle-A.anglePrev;for(var F=0;F<C.length;F++){var G=C[F],D=G.vertex,I=f.sub(D,y.position,g),D=f.sub(D,A.position,q),H=f.add(y.velocity,f.mult(f.perp(I),y.angularVelocity),k),K=f.add(A.velocity,f.mult(f.perp(D),A.angularVelocity),t),H=f.sub(H,K,p),J=f.dot(z,H),M=f.dot(B,H),L=Math.abs(M),
O=l.sign(M),H=(1+r.restitution)*J,P=l.clamp(r.separation+J,0,1)*a._frictionNormalMultiplier,K=M,N=Infinity;L>r.friction*r.frictionStatic*P*c&&(N=L,K=l.clamp(r.friction*O*c,-N,N));L=f.cross(I,z);O=f.cross(D,z);L=E/(y.inverseMass+A.inverseMass+y.inverseInertia*L*L+A.inverseInertia*O*O);H*=L;K*=L;0>J&&J*J>a._restingThresh*c?G.normalImpulse=0:(J=G.normalImpulse,G.normalImpulse=Math.min(G.normalImpulse+H,0),H=G.normalImpulse-J);M*M>a._restingThreshTangent*c?G.tangentImpulse=0:(J=G.tangentImpulse,G.tangentImpulse=
l.clamp(G.tangentImpulse+K,-N,N),K=G.tangentImpulse-J);d.x=z.x*H+B.x*K;d.y=z.y*H+B.y*K;y.isStatic||y.isSleeping||(y.positionPrev.x+=d.x*y.inverseMass,y.positionPrev.y+=d.y*y.inverseMass,y.anglePrev+=f.cross(I,d)*y.inverseInertia);A.isStatic||A.isSleeping||(A.positionPrev.x-=d.x*A.inverseMass,A.positionPrev.y-=d.y*A.inverseMass,A.anglePrev-=f.cross(D,d)*A.inverseInertia)}}}}})()},{"../core/Common":14,"../geometry/Bounds":24,"../geometry/Vector":26,"../geometry/Vertices":27}],11:[function(d,c,b){var a=
{};c.exports=a;var e=d("../geometry/Vertices"),f=d("../geometry/Vector");(function(){a.collides=function(a,c,k){var g,q;g=!1;k?(q=a.parent,g=c.parent,q=q.speed*q.speed+q.angularSpeed*q.angularSpeed+g.speed*g.speed+g.angularSpeed*g.angularSpeed,g=k&&k.collided&&.2>q,q=k):q={collided:!1,bodyA:a,bodyB:c};if(k&&g){if(g=q.axisBody,k=b(g.vertices,(g===a?c:a).vertices,[g.axes[k.axisNumber]]),q.reused=!0,0>=k.overlap)return q.collided=!1,q}else{k=b(a.vertices,c.vertices,a.axes);if(0>=k.overlap)return q.collided=
!1,q;g=b(c.vertices,a.vertices,c.axes);if(0>=g.overlap)return q.collided=!1,q;k.overlap<g.overlap?q.axisBody=a:(k=g,q.axisBody=c);q.axisNumber=k.axisNumber}q.bodyA=a.id<c.id?a:c;q.bodyB=a.id<c.id?c:a;q.collided=!0;q.normal=k.axis;q.depth=k.overlap;q.parentA=q.bodyA.parent;q.parentB=q.bodyB.parent;a=q.bodyA;c=q.bodyB;0<f.dot(q.normal,f.sub(c.position,a.position))&&(q.normal=f.neg(q.normal));q.tangent=f.perp(q.normal);q.penetration={x:q.normal.x*q.depth,y:q.normal.y*q.depth};k=d(a,c,q.normal);g=q.supports||
[];g.length=0;e.contains(a.vertices,k[0])&&g.push(k[0]);e.contains(a.vertices,k[1])&&g.push(k[1]);2>g.length&&(a=d(c,a,f.neg(q.normal)),e.contains(c.vertices,a[0])&&g.push(a[0]),2>g.length&&e.contains(c.vertices,a[1])&&g.push(a[1]));1>g.length&&(g=[k[0]]);q.supports=g;return q};var b=function(a,b,e){for(var l=f._temp[0],d=f._temp[1],v={overlap:Number.MAX_VALUE},t,p,u=0;u<e.length;u++){p=e[u];c(l,a,p);c(d,b,p);t=Math.min(l.max-d.min,d.max-l.min);if(0>=t){v.overlap=t;break}t<v.overlap&&(v.overlap=t,
v.axis=p,v.axisNumber=u)}return v},c=function(a,b,e){for(var c=f.dot(b[0],e),l=c,d=1;d<b.length;d+=1){var k=f.dot(b[d],e);k>l?l=k:k<c&&(c=k)}a.min=c;a.max=l},d=function(a,b,e){var c=Number.MAX_VALUE,l=f._temp[0];b=b.vertices;a=a.position;var d,k,p,u;for(u=0;u<b.length;u++)k=b[u],l.x=k.x-a.x,l.y=k.y-a.y,d=-f.dot(e,l),d<c&&(c=d,p=k);k=b[0<=p.index-1?p.index-1:b.length-1];l.x=k.x-a.x;l.y=k.y-a.y;c=-f.dot(e,l);u=k;k=b[(p.index+1)%b.length];l.x=k.x-a.x;l.y=k.y-a.y;d=-f.dot(e,l);d<c&&(u=k);return[p,u]}})()},
{"../geometry/Vector":26,"../geometry/Vertices":27}],12:[function(d,c,b){var a={};c.exports=a;var e=d("../geometry/Vertices"),f=d("../geometry/Vector"),l=d("../core/Sleeping"),k=d("../geometry/Bounds"),x=d("../geometry/Axes"),n=d("../core/Common");(function(){a.create=function(a){a.bodyA&&!a.pointA&&(a.pointA={x:0,y:0});a.bodyB&&!a.pointB&&(a.pointB={x:0,y:0});var b=a.bodyA?f.add(a.bodyA.position,a.pointA):a.pointA,e=a.bodyB?f.add(a.bodyB.position,a.pointB):a.pointB,b=f.magnitude(f.sub(b,e));a.length=
a.length||b||1E-6;a.render=n.extend({visible:!0,lineWidth:2,strokeStyle:"#666"},a.render);a.id=a.id||n.nextId();a.label=a.label||"Constraint";a.type="constraint";a.stiffness=a.stiffness||1;a.angularStiffness=a.angularStiffness||0;a.angleA=a.bodyA?a.bodyA.angle:a.angleA;a.angleB=a.bodyB?a.bodyB.angle:a.angleB;return a};a.solveAll=function(b,e){for(var f=0;f<b.length;f++)a.solve(b[f],e)};a.solve=function(a,b){var e=a.bodyA,c=a.bodyB,l=a.pointA,d=a.pointB;e&&!e.isStatic&&(a.pointA=f.rotate(l,e.angle-
a.angleA),a.angleA=e.angle);c&&!c.isStatic&&(a.pointB=f.rotate(d,c.angle-a.angleB),a.angleB=c.angle);var n=l,k=d;e&&(n=f.add(e.position,l));c&&(k=f.add(c.position,d));if(n&&k){var d=f.sub(n,k),r=f.magnitude(d);0===r&&(r=1E-6);var x=(r-a.length)/r,l=f.div(d,r),d=f.mult(d,.5*x*a.stiffness*b*b);if(!(Math.abs(1-r/a.length)<.001*b)){var y,A;e&&!e.isStatic?(y={x:n.x-e.position.x+d.x,y:n.y-e.position.y+d.y},e.velocity.x=e.position.x-e.positionPrev.x,e.velocity.y=e.position.y-e.positionPrev.y,e.angularVelocity=
e.angle-e.anglePrev,n=f.add(e.velocity,f.mult(f.perp(y),e.angularVelocity)),r=f.dot(y,l),r=e.inverseMass+e.inverseInertia*r*r):(n={x:0,y:0},r=e?e.inverseMass:0);c&&!c.isStatic?(A={x:k.x-c.position.x-d.x,y:k.y-c.position.y-d.y},c.velocity.x=c.position.x-c.positionPrev.x,c.velocity.y=c.position.y-c.positionPrev.y,c.angularVelocity=c.angle-c.anglePrev,k=f.add(c.velocity,f.mult(f.perp(A),c.angularVelocity)),x=f.dot(A,l),x=c.inverseMass+c.inverseInertia*x*x):(k={x:0,y:0},x=c?c.inverseMass:0);k=f.sub(k,
n);k=f.dot(l,k)/(r+x);0<k&&(k=0);l={x:l.x*k,y:l.y*k};e&&!e.isStatic&&(y=f.cross(y,l)*e.inverseInertia*(1-a.angularStiffness),e.constraintImpulse.x-=d.x,e.constraintImpulse.y-=d.y,e.constraintImpulse.angle+=y,e.position.x-=d.x,e.position.y-=d.y,e.angle+=y);c&&!c.isStatic&&(y=f.cross(A,l)*c.inverseInertia*(1-a.angularStiffness),c.constraintImpulse.x+=d.x,c.constraintImpulse.y+=d.y,c.constraintImpulse.angle-=y,c.position.x+=d.x,c.position.y+=d.y,c.angle-=y)}}};a.postSolveAll=function(a){for(var b=0;b<
a.length;b++){var c=a[b],d=c.constraintImpulse;if(0!==d.x||0!==d.y||0!==d.angle){l.set(c,!1);for(var n=0;n<c.parts.length;n++){var t=c.parts[n];e.translate(t.vertices,d);0<n&&(t.position.x+=d.x,t.position.y+=d.y);0!==d.angle&&(e.rotate(t.vertices,d.angle,c.position),x.rotate(t.axes,d.angle),0<n&&f.rotateAbout(t.position,d.angle,c.position,t.position));k.update(t.bounds,t.vertices,c.velocity)}d.angle=0;d.x=0;d.y=0}}}})()},{"../core/Common":14,"../core/Sleeping":20,"../geometry/Axes":23,"../geometry/Bounds":24,
"../geometry/Vector":26,"../geometry/Vertices":27}],13:[function(d,c,b){var a={};c.exports=a;var e=d("../geometry/Vertices"),f=d("../core/Sleeping"),l=d("../core/Mouse"),k=d("../core/Events"),x=d("../collision/Detector"),n=d("./Constraint"),m=d("../body/Composite"),w=d("../core/Common"),g=d("../geometry/Bounds");(function(){a.create=function(b,e){var c=(b?b.mouse:null)||(e?e.mouse:null);c||(b&&b.render&&b.render.canvas?c=l.create(b.render.canvas):e&&e.element?c=l.create(e.element):(c=l.create(),w.log("MouseConstraint.create: options.mouse was undefined, options.element was undefined, may not function as expected",
"warn")));var f=n.create({label:"Mouse Constraint",pointA:c.position,pointB:{x:0,y:0},length:.01,stiffness:.1,angularStiffness:1,render:{strokeStyle:"#90EE90",lineWidth:3}}),d=w.extend({type:"mouseConstraint",mouse:c,element:null,body:null,constraint:f,collisionFilter:{category:1,mask:4294967295,group:0}},e);k.on(b,"tick",function(){var e=m.allBodies(b.world);a.update(d,e);var e=d.mouse,c=e.sourceEvents;c.mousemove&&k.trigger(d,"mousemove",{mouse:e});c.mousedown&&k.trigger(d,"mousedown",{mouse:e});
c.mouseup&&k.trigger(d,"mouseup",{mouse:e});l.clearSourceEvents(e)});return d};a.update=function(a,b){var c=a.mouse,d=a.constraint,l=a.body;if(0===c.button)if(d.bodyB)f.set(d.bodyB,!1),d.pointA=c.position;else for(var n=0;n<b.length;n++){if(l=b[n],g.contains(l.bounds,c.position)&&x.canCollide(l.collisionFilter,a.collisionFilter))for(var m=1<l.parts.length?1:0;m<l.parts.length;m++)if(e.contains(l.parts[m].vertices,c.position)){d.pointA=c.position;d.bodyB=a.body=l;d.pointB={x:c.position.x-l.position.x,
y:c.position.y-l.position.y};d.angleB=l.angle;f.set(l,!1);k.trigger(a,"startdrag",{mouse:c,body:l});break}}else d.bodyB=a.body=null,d.pointB=null,l&&k.trigger(a,"enddrag",{mouse:c,body:l})}})()},{"../body/Composite":2,"../collision/Detector":5,"../core/Common":14,"../core/Events":16,"../core/Mouse":18,"../core/Sleeping":20,"../geometry/Bounds":24,"../geometry/Vertices":27,"./Constraint":12}],14:[function(d,c,b){var a={};c.exports=a;(function(){a._nextId=0;a._seed=0;a.extend=function(b,c){var d,k;
"boolean"===typeof c?(d=2,k=c):(d=1,k=!0);d=Array.prototype.slice.call(arguments,d);for(var x=0;x<d.length;x++){var n=d[x];if(n)for(var m in n)k&&n[m]&&n[m].constructor===Object?b[m]&&b[m].constructor!==Object?b[m]=n[m]:(b[m]=b[m]||{},a.extend(b[m],k,n[m])):b[m]=n[m]}return b};a.clone=function(b,c){return a.extend({},c,b)};a.keys=function(a){if(Object.keys)return Object.keys(a);var b=[],c;for(c in a)b.push(c);return b};a.values=function(a){var b=[];if(Object.keys){for(var c=Object.keys(a),d=0;d<c.length;d++)b.push(a[c[d]]);
return b}for(c in a)b.push(a[c]);return b};a.shadeColor=function(a,b){var c=parseInt(a.slice(1),16),d=Math.round(2.55*b),x=(c>>16)+d,n=(c>>8&255)+d,c=(c&255)+d;return"#"+(16777216+65536*(255>x?1>x?0:x:255)+256*(255>n?1>n?0:n:255)+(255>c?1>c?0:c:255)).toString(16).slice(1)};a.shuffle=function(b){for(var c=b.length-1;0<c;c--){var d=Math.floor(a.random()*(c+1)),k=b[c];b[c]=b[d];b[d]=k}return b};a.choose=function(b){return b[Math.floor(a.random()*b.length)]};a.isElement=function(a){try{return a instanceof
HTMLElement}catch(b){return"object"===typeof a&&1===a.nodeType&&"object"===typeof a.style&&"object"===typeof a.ownerDocument}};a.isArray=function(a){return"[object Array]"===Object.prototype.toString.call(a)};a.clamp=function(a,b,c){return a<b?b:a>c?c:a};a.sign=function(a){return 0>a?-1:1};a.now=function(){var a=window.performance||{};a.now=function(){return a.now||a.webkitNow||a.msNow||a.oNow||a.mozNow||function(){return+new Date}}();return a.now()};a.random=function(b,c){b="undefined"!==typeof b?
b:0;a._seed=(9301*a._seed+49297)%233280;return b+a._seed/233280*(("undefined"!==typeof c?c:1)-b)};a.colorToNumber=function(a){a=a.replace("#","");3==a.length&&(a=a.charAt(0)+a.charAt(0)+a.charAt(1)+a.charAt(1)+a.charAt(2)+a.charAt(2));return parseInt(a,16)};a.log=function(a,b){if(console&&console.log&&console.warn)switch(b){case "warn":console.warn("Matter.js:",a);break;case "error":console.log("Matter.js:",a)}};a.nextId=function(){return a._nextId++};a.indexOf=function(a,b){if(a.indexOf)return a.indexOf(b);
for(var c=0;c<a.length;c++)if(a[c]===b)return c;return-1}})()},{}],15:[function(d,c,b){var a={};c.exports=a;var e=d("../body/World"),f=d("./Sleeping"),l=d("../collision/Resolver"),k=d("../render/Render"),x=d("../collision/Pairs");d("./Metrics");var n=d("../collision/Grid"),m=d("./Events"),w=d("../body/Composite"),g=d("../constraint/Constraint"),q=d("./Common"),v=d("../body/Body");(function(){a.create=function(a,b){b=q.isElement(a)?b:a;a=q.isElement(a)?a:null;b=b||{};(a||b.render)&&q.log("Engine.create: engine.render is deprecated (see docs)",
"warn");var c=q.extend({positionIterations:6,velocityIterations:4,constraintIterations:2,enableSleeping:!1,events:[],timing:{timestamp:0,timeScale:1},broadphase:{controller:n}},b);if(a||c.render)c.render=q.extend({element:a,controller:k},c.render);c.render&&c.render.controller&&(c.render=c.render.controller.create(c.render));c.render&&(c.render.engine=c);c.world=b.world||e.create(c.world);c.pairs=x.create();c.broadphase=c.broadphase.controller.create(c.broadphase);c.metrics=c.metrics||{extended:!1};
return c};a.update=function(a,b,c){b=b||1E3/60;c=c||1;var e=a.world,d=a.timing,n=a.broadphase,k=[];d.timestamp+=b*d.timeScale;var q={timestamp:d.timestamp};m.trigger(a,"beforeUpdate",q);var C=w.allBodies(e),k=w.allConstraints(e);a.enableSleeping&&f.update(C,d.timeScale);var E=e.gravity,F="undefined"!==typeof E.scale?E.scale:.001;if((0!==E.x||0!==E.y)&&0!==F)for(var G=0;G<C.length;G++){var D=C[G];D.isStatic||D.isSleeping||(D.force.y+=D.mass*E.y*F,D.force.x+=D.mass*E.x*F)}E=d.timeScale;for(F=0;F<C.length;F++)G=
C[F],G.isStatic||G.isSleeping||v.update(G,b,E,c);for(c=0;c<a.constraintIterations;c++)g.solveAll(k,d.timeScale);g.postSolveAll(C);n.controller?(e.isModified&&n.controller.clear(n),n.controller.update(n,C,a,e.isModified),k=n.pairsList):k=C;e.isModified&&w.setModified(e,!1,!1,!0);n=n.detector(k,a);e=a.pairs;k=d.timestamp;x.update(e,n,k);x.removeOld(e,k);a.enableSleeping&&f.afterCollisions(e.list,d.timeScale);0<e.collisionStart.length&&m.trigger(a,"collisionStart",{pairs:e.collisionStart});l.preSolvePosition(e.list);
for(c=0;c<a.positionIterations;c++)l.solvePosition(e.list,d.timeScale);l.postSolvePosition(C);l.preSolveVelocity(e.list);for(c=0;c<a.velocityIterations;c++)l.solveVelocity(e.list,d.timeScale);0<e.collisionActive.length&&m.trigger(a,"collisionActive",{pairs:e.collisionActive});0<e.collisionEnd.length&&m.trigger(a,"collisionEnd",{pairs:e.collisionEnd});for(d=0;d<C.length;d++)e=C[d],e.force.x=0,e.force.y=0,e.torque=0;m.trigger(a,"afterUpdate",q);return a};a.merge=function(b,c){q.extend(b,c);if(c.world){b.world=
c.world;a.clear(b);for(var e=w.allBodies(b.world),d=0;d<e.length;d++){var l=e[d];f.set(l,!1);l.id=q.nextId()}}};a.clear=function(a){var b=a.world;x.clear(a.pairs);var c=a.broadphase;c.controller&&(b=w.allBodies(b),c.controller.clear(c),c.controller.update(c,b,a,!0))}})()},{"../body/Body":1,"../body/Composite":2,"../body/World":3,"../collision/Grid":6,"../collision/Pairs":8,"../collision/Resolver":10,"../constraint/Constraint":12,"../render/Render":29,"./Common":14,"./Events":16,"./Metrics":17,"./Sleeping":20}],
16:[function(d,c,b){var a={};c.exports=a;var e=d("./Common");(function(){a.on=function(a,b,c){b=b.split(" ");for(var e,d=0;d<b.length;d++)e=b[d],a.events=a.events||{},a.events[e]=a.events[e]||[],a.events[e].push(c);return c};a.off=function(a,b,c){if(b){"function"===typeof b&&(c=b,b=e.keys(a.events).join(" "));b=b.split(" ");for(var d=0;d<b.length;d++){var n=a.events[b[d]],m=[];if(c&&n)for(var w=0;w<n.length;w++)n[w]!==c&&m.push(n[w]);a.events[b[d]]=m}}else a.events={}};a.trigger=function(a,b,c){var d,
n,m;if(a.events){c||(c={});b=b.split(" ");for(var w=0;w<b.length;w++)if(d=b[w],n=a.events[d])for(m=e.clone(c,!1),m.name=d,m.source=a,d=0;d<n.length;d++)n[d].apply(a,[m])}}})()},{"./Common":14}],17:[function(d,c,b){},{"../body/Composite":2,"./Common":14}],18:[function(d,c,b){var a={};c.exports=a;var e=d("../core/Common");(function(){a.create=function(c){var d={};c||e.log("Mouse.create: element was undefined, defaulting to document.body","warn");d.element=c||document.body;d.absolute={x:0,y:0};d.position=
{x:0,y:0};d.mousedownPosition={x:0,y:0};d.mouseupPosition={x:0,y:0};d.offset={x:0,y:0};d.scale={x:1,y:1};d.wheelDelta=0;d.button=-1;d.pixelRatio=d.element.getAttribute("data-pixel-ratio")||1;d.sourceEvents={mousemove:null,mousedown:null,mouseup:null,mousewheel:null};d.mousemove=function(a){var c=b(a,d.element,d.pixelRatio);a.changedTouches&&(d.button=0,a.preventDefault());d.absolute.x=c.x;d.absolute.y=c.y;d.position.x=d.absolute.x*d.scale.x+d.offset.x;d.position.y=d.absolute.y*d.scale.y+d.offset.y;
d.sourceEvents.mousemove=a};d.mousedown=function(a){var c=b(a,d.element,d.pixelRatio);a.changedTouches?(d.button=0,a.preventDefault()):d.button=a.button;d.absolute.x=c.x;d.absolute.y=c.y;d.position.x=d.absolute.x*d.scale.x+d.offset.x;d.position.y=d.absolute.y*d.scale.y+d.offset.y;d.mousedownPosition.x=d.position.x;d.mousedownPosition.y=d.position.y;d.sourceEvents.mousedown=a};d.mouseup=function(a){var c=b(a,d.element,d.pixelRatio);a.changedTouches&&a.preventDefault();d.button=-1;d.absolute.x=c.x;
d.absolute.y=c.y;d.position.x=d.absolute.x*d.scale.x+d.offset.x;d.position.y=d.absolute.y*d.scale.y+d.offset.y;d.mouseupPosition.x=d.position.x;d.mouseupPosition.y=d.position.y;d.sourceEvents.mouseup=a};d.mousewheel=function(a){d.wheelDelta=Math.max(-1,Math.min(1,a.wheelDelta||-a.detail));a.preventDefault()};a.setElement(d,d.element);return d};a.setElement=function(a,b){a.element=b;b.addEventListener("mousemove",a.mousemove);b.addEventListener("mousedown",a.mousedown);b.addEventListener("mouseup",
a.mouseup);b.addEventListener("mousewheel",a.mousewheel);b.addEventListener("DOMMouseScroll",a.mousewheel);b.addEventListener("touchmove",a.mousemove);b.addEventListener("touchstart",a.mousedown);b.addEventListener("touchend",a.mouseup)};a.clearSourceEvents=function(a){a.sourceEvents.mousemove=null;a.sourceEvents.mousedown=null;a.sourceEvents.mouseup=null;a.sourceEvents.mousewheel=null;a.wheelDelta=0};a.setOffset=function(a,b){a.offset.x=b.x;a.offset.y=b.y;a.position.x=a.absolute.x*a.scale.x+a.offset.x;
a.position.y=a.absolute.y*a.scale.y+a.offset.y};a.setScale=function(a,b){a.scale.x=b.x;a.scale.y=b.y;a.position.x=a.absolute.x*a.scale.x+a.offset.x;a.position.y=a.absolute.y*a.scale.y+a.offset.y};var b=function(a,b,c){var e=b.getBoundingClientRect(),d=document.documentElement||document.body.parentNode||document.body,f=void 0!==window.pageXOffset?window.pageXOffset:d.scrollLeft,d=void 0!==window.pageYOffset?window.pageYOffset:d.scrollTop,g=a.changedTouches;g?(f=g[0].pageX-e.left-f,a=g[0].pageY-e.top-
d):(f=a.pageX-e.left-f,a=a.pageY-e.top-d);return{x:f/(b.clientWidth/b.width*c),y:a/(b.clientHeight/b.height*c)}}})()},{"../core/Common":14}],19:[function(d,c,b){var a={};c.exports=a;var e=d("./Events"),f=d("./Engine"),l=d("./Common");(function(){var b,c;"undefined"!==typeof window&&(b=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame||function(a){window.setTimeout(function(){a(l.now())},1E3/60)},c=window.cancelAnimationFrame||
window.mozCancelAnimationFrame||window.webkitCancelAnimationFrame||window.msCancelAnimationFrame);a.create=function(a){a=l.extend({fps:60,correction:1,deltaSampleSize:60,counterTimestamp:0,frameCounter:0,deltaHistory:[],timePrev:null,timeScalePrev:1,frameRequestId:null,isFixed:!1,enabled:!0},a);a.delta=a.delta||1E3/a.fps;a.deltaMin=a.deltaMin||1E3/a.fps;a.deltaMax=a.deltaMax||1E3/(.5*a.fps);a.fps=1E3/a.delta;return a};a.run=function(c,e){"undefined"!==typeof c.positionIterations&&(e=c,c=a.create());
(function g(d){c.frameRequestId=b(g);d&&c.enabled&&a.tick(c,e,d)})();return c};a.tick=function(a,b,c){var d=b.timing,l=1,k,t={timestamp:d.timestamp};e.trigger(a,"beforeTick",t);e.trigger(b,"beforeTick",t);a.isFixed?k=a.delta:(k=c-a.timePrev||a.delta,a.timePrev=c,a.deltaHistory.push(k),a.deltaHistory=a.deltaHistory.slice(-a.deltaSampleSize),k=Math.min.apply(null,a.deltaHistory),k=k<a.deltaMin?a.deltaMin:k,k=k>a.deltaMax?a.deltaMax:k,l=k/a.delta,a.delta=k);0!==a.timeScalePrev&&(l*=d.timeScale/a.timeScalePrev);
0===d.timeScale&&(l=0);a.timeScalePrev=d.timeScale;a.correction=l;a.frameCounter+=1;1E3<=c-a.counterTimestamp&&(a.fps=(c-a.counterTimestamp)/1E3*a.frameCounter,a.counterTimestamp=c,a.frameCounter=0);e.trigger(a,"tick",t);e.trigger(b,"tick",t);b.world.isModified&&b.render&&b.render.controller&&b.render.controller.clear&&b.render.controller.clear(b.render);e.trigger(a,"beforeUpdate",t);f.update(b,k,l);e.trigger(a,"afterUpdate",t);b.render&&b.render.controller&&(e.trigger(a,"beforeRender",t),e.trigger(b,
"beforeRender",t),b.render.controller.world(b.render),e.trigger(a,"afterRender",t),e.trigger(b,"afterRender",t));e.trigger(a,"afterTick",t);e.trigger(b,"afterTick",t)};a.stop=function(a){c(a.frameRequestId)};a.start=function(b,c){a.run(b,c)}})()},{"./Common":14,"./Engine":15,"./Events":16}],20:[function(d,c,b){var a={};c.exports=a;var e=d("./Events");(function(){a._motionWakeThreshold=.18;a._motionSleepThreshold=.08;a._minBias=.9;a.update=function(b,c){for(var e=c*c*c,d=0;d<b.length;d++){var n=b[d],
m=n.speed*n.speed+n.angularSpeed*n.angularSpeed;0!==n.force.x||0!==n.force.y?a.set(n,!1):(n.motion=a._minBias*Math.min(n.motion,m)+(1-a._minBias)*Math.max(n.motion,m),0<n.sleepThreshold&&n.motion<a._motionSleepThreshold*e?(n.sleepCounter+=1,n.sleepCounter>=n.sleepThreshold&&a.set(n,!0)):0<n.sleepCounter&&--n.sleepCounter)}};a.afterCollisions=function(b,c){for(var e=c*c*c,d=0;d<b.length;d++){var n=b[d];if(n.isActive){var m=n.collision,n=m.bodyA.parent,w=m.bodyB.parent;n.isSleeping&&w.isSleeping||n.isStatic||
w.isStatic||!n.isSleeping&&!w.isSleeping||(m=n.isSleeping&&!n.isStatic?n:w,n=m===n?w:n,!m.isStatic&&n.motion>a._motionWakeThreshold*e&&a.set(m,!1))}}};a.set=function(a,b){var c=a.isSleeping;b?(a.isSleeping=!0,a.sleepCounter=a.sleepThreshold,a.positionImpulse.x=0,a.positionImpulse.y=0,a.positionPrev.x=a.position.x,a.positionPrev.y=a.position.y,a.anglePrev=a.angle,a.speed=0,a.angularSpeed=0,a.motion=0,c||e.trigger(a,"sleepStart")):(a.isSleeping=!1,a.sleepCounter=0,c&&e.trigger(a,"sleepEnd"))}})()},
{"./Events":16}],21:[function(d,c,b){var a={};c.exports=a;var e=d("../geometry/Vertices"),f=d("../core/Common"),l=d("../body/Body"),k=d("../geometry/Bounds"),x=d("../geometry/Vector");(function(){a.rectangle=function(a,b,c,d,k){k=k||{};a={label:"Rectangle Body",position:{x:a,y:b},vertices:e.fromPath("L 0 0 L "+c+" 0 L "+c+" "+d+" L 0 "+d)};k.chamfer&&(b=k.chamfer,a.vertices=e.chamfer(a.vertices,b.radius,b.quality,b.qualityMin,b.qualityMax),delete k.chamfer);return l.create(f.extend({},a,k))};a.trapezoid=
function(a,b,c,d,k,v){v=v||{};k*=.5;var t=c*k;c=t+(1-2*k)*c;var p=c+t;a={label:"Trapezoid Body",position:{x:a,y:b},vertices:e.fromPath(.5>k?"L 0 0 L "+t+" "+-d+" L "+c+" "+-d+" L "+p+" 0":"L 0 0 L "+c+" "+-d+" L "+p+" 0")};v.chamfer&&(b=v.chamfer,a.vertices=e.chamfer(a.vertices,b.radius,b.quality,b.qualityMin,b.qualityMax),delete v.chamfer);return l.create(f.extend({},a,v))};a.circle=function(b,c,e,d,l){d=d||{};var k={label:"Circle Body",circleRadius:e};l=Math.ceil(Math.max(10,Math.min(l||25,e)));
1===l%2&&(l+=1);return a.polygon(b,c,l,e,f.extend({},k,d))};a.polygon=function(b,c,d,k,q){q=q||{};if(3>d)return a.circle(b,c,k,q);for(var v=2*Math.PI/d,t="",p=.5*v,u=0;u<d;u+=1)var r=p+u*v,x=Math.sin(r)*k,t=t+("L "+(Math.cos(r)*k).toFixed(3)+" "+x.toFixed(3)+" ");b={label:"Polygon Body",position:{x:b,y:c},vertices:e.fromPath(t)};q.chamfer&&(c=q.chamfer,b.vertices=e.chamfer(b.vertices,c.radius,c.quality,c.qualityMin,c.qualityMax),delete q.chamfer);return l.create(f.extend({},b,q))};a.fromVertices=
function(a,b,c,d,q,v,t){var p,u,r,B;d=d||{};p=[];q="undefined"!==typeof q?q:!1;v="undefined"!==typeof v?v:.01;t="undefined"!==typeof t?t:10;window.decomp||f.log("Bodies.fromVertices: poly-decomp.js required. Could not decompose vertices. Fallback to convex hull.","warn");f.isArray(c[0])||(c=[c]);for(B=0;B<c.length;B+=1)if(r=c[B],(u=e.isConvex(r))||!window.decomp)r=u?e.clockwiseSort(r):e.hull(r),p.push({position:{x:a,y:b},vertices:r});else{var y=new decomp.Polygon;for(u=0;u<r.length;u++)y.vertices.push([r[u].x,
r[u].y]);y.makeCCW();!1!==v&&y.removeCollinearPoints(v);y=y.quickDecomp();for(u=0;u<y.length;u++){var A=y[u],z=[];for(r=0;r<A.vertices.length;r++)z.push({x:A.vertices[r][0],y:A.vertices[r][1]});0<t&&e.area(z)<t||p.push({position:e.centre(z),vertices:z})}}for(u=0;u<p.length;u++)p[u]=l.create(f.extend(p[u],d));if(q)for(u=0;u<p.length;u++)for(v=p[u],r=u+1;r<p.length;r++)if(t=p[r],k.overlaps(v.bounds,t.bounds))for(B=v.vertices,y=t.vertices,c=0;c<v.vertices.length;c++)for(q=0;q<t.vertices.length;q++)A=
x.magnitudeSquared(x.sub(B[(c+1)%B.length],y[q])),z=x.magnitudeSquared(x.sub(B[c],y[(q+1)%y.length])),5>A&&5>z&&(B[c].isInternal=!0,y[q].isInternal=!0);return 1<p.length?(d=l.create(f.extend({parts:p.slice(0)},d)),l.setPosition(d,{x:a,y:b}),d):p[0]}})()},{"../body/Body":1,"../core/Common":14,"../geometry/Bounds":24,"../geometry/Vector":26,"../geometry/Vertices":27}],22:[function(d,c,b){var a={};c.exports=a;var e=d("../body/Composite"),f=d("../constraint/Constraint"),l=d("../core/Common"),k=d("../body/Body"),
x=d("./Bodies");(function(){a.stack=function(a,b,c,d,f,l,t){for(var p=e.create({label:"Stack"}),u=a,r,x=0,y=0;y<d;y++){for(var A=0,z=0;z<c;z++){var C=t(u,b,z,y,r,x);C?(u=C.bounds.max.y-C.bounds.min.y,r=C.bounds.max.x-C.bounds.min.x,u>A&&(A=u),k.translate(C,{x:.5*r,y:.5*u}),u=C.bounds.max.x+f,e.addBody(p,C),r=C,x+=1):u+=f}b+=A+l;u=a}return p};a.chain=function(a,b,c,d,k,v){for(var t=a.bodies,p=1;p<t.length;p++){var u=t[p-1],r=t[p],u=l.extend({bodyA:u,pointA:{x:(u.bounds.max.x-u.bounds.min.x)*b,y:(u.bounds.max.y-
u.bounds.min.y)*c},bodyB:r,pointB:{x:(r.bounds.max.x-r.bounds.min.x)*d,y:(r.bounds.max.y-r.bounds.min.y)*k}},v);e.addConstraint(a,f.create(u))}a.label+=" Chain";return a};a.mesh=function(a,b,c,d,k){var v=a.bodies,t,p,u,r;for(t=0;t<c;t++){for(p=1;p<b;p++)u=v[p-1+t*b],r=v[p+t*b],e.addConstraint(a,f.create(l.extend({bodyA:u,bodyB:r},k)));if(0<t)for(p=0;p<b;p++)u=v[p+(t-1)*b],r=v[p+t*b],e.addConstraint(a,f.create(l.extend({bodyA:u,bodyB:r},k))),d&&0<p&&(u=v[p-1+(t-1)*b],e.addConstraint(a,f.create(l.extend({bodyA:u,
bodyB:r},k)))),d&&p<b-1&&(u=v[p+1+(t-1)*b],e.addConstraint(a,f.create(l.extend({bodyA:u,bodyB:r},k))))}a.label+=" Mesh";return a};a.pyramid=function(b,c,e,d,f,l,t){return a.stack(b,c,e,d,f,l,function(a,c,l,m,v,x){var z=Math.min(d,Math.ceil(e/2));a=v?v.bounds.max.x-v.bounds.min.x:0;if(!(m>z||(m=z-m,z=e-1-m,l<m||l>z)))return 1===x&&k.translate(v,{x:(l+(1===e%2?1:-1))*a,y:0}),t(b+(v?l*a:0)+l*f,c,l,m,v,x)})};a.newtonsCradle=function(a,b,c,d,l){for(var k=e.create({label:"Newtons Cradle"}),t=0;t<c;t++){var p=
x.circle(a+1.9*t*d,b+l,d,{inertia:Infinity,restitution:1,friction:0,frictionAir:1E-4,slop:1}),u=f.create({pointA:{x:a+1.9*t*d,y:b},bodyB:p});e.addBody(k,p);e.addConstraint(k,u)}return k};a.car=function(a,b,c,d,l){var v=k.nextGroup(!0),t=.5*-c+-20,p=.5*c- -20,u=e.create({label:"Car"});c=x.trapezoid(a,b,c,d,.3,{collisionFilter:{group:v},friction:.01,chamfer:{radius:10}});d=x.circle(a+t,b+0,l,{collisionFilter:{group:v},friction:.8,density:.01});a=x.circle(a+p,b+0,l,{collisionFilter:{group:v},friction:.8,
density:.01});t=f.create({bodyA:c,pointA:{x:t,y:0},bodyB:d,stiffness:.2});p=f.create({bodyA:c,pointA:{x:p,y:0},bodyB:a,stiffness:.2});e.addBody(u,c);e.addBody(u,d);e.addBody(u,a);e.addConstraint(u,t);e.addConstraint(u,p);return u};a.softBody=function(b,c,e,d,f,k,t,p,u,r){u=l.extend({inertia:Infinity},u);r=l.extend({stiffness:.4},r);b=a.stack(b,c,e,d,f,k,function(a,b){return x.circle(a,b,p,u)});a.mesh(b,e,d,t,r);b.label="Soft Body";return b}})()},{"../body/Body":1,"../body/Composite":2,"../constraint/Constraint":12,
"../core/Common":14,"./Bodies":21}],23:[function(d,c,b){var a={};c.exports=a;var e=d("../geometry/Vector"),f=d("../core/Common");(function(){a.fromVertices=function(a){for(var b={},c=0;c<a.length;c++){var d=(c+1)%a.length,d=e.normalise({x:a[d].y-a[c].y,y:a[c].x-a[d].x}),m=0===d.y?Infinity:d.x/d.y,m=m.toFixed(3).toString();b[m]=d}return f.values(b)};a.rotate=function(a,b){if(0!==b)for(var c=Math.cos(b),e=Math.sin(b),d=0;d<a.length;d++){var f=a[d],g;g=f.x*c-f.y*e;f.y=f.x*e+f.y*c;f.x=g}}})()},{"../core/Common":14,
"../geometry/Vector":26}],24:[function(d,c,b){var a={};c.exports=a;(function(){a.create=function(b){var c={min:{x:0,y:0},max:{x:0,y:0}};b&&a.update(c,b);return c};a.update=function(a,b,c){a.min.x=Infinity;a.max.x=-Infinity;a.min.y=Infinity;a.max.y=-Infinity;for(var d=0;d<b.length;d++){var x=b[d];x.x>a.max.x&&(a.max.x=x.x);x.x<a.min.x&&(a.min.x=x.x);x.y>a.max.y&&(a.max.y=x.y);x.y<a.min.y&&(a.min.y=x.y)}c&&(0<c.x?a.max.x+=c.x:a.min.x+=c.x,0<c.y?a.max.y+=c.y:a.min.y+=c.y)};a.contains=function(a,b){return b.x>=
a.min.x&&b.x<=a.max.x&&b.y>=a.min.y&&b.y<=a.max.y};a.overlaps=function(a,b){return a.min.x<=b.max.x&&a.max.x>=b.min.x&&a.max.y>=b.min.y&&a.min.y<=b.max.y};a.translate=function(a,b){a.min.x+=b.x;a.max.x+=b.x;a.min.y+=b.y;a.max.y+=b.y};a.shift=function(a,b){var c=a.max.x-a.min.x,d=a.max.y-a.min.y;a.min.x=b.x;a.max.x=b.x+c;a.min.y=b.y;a.max.y=b.y+d}})()},{}],25:[function(d,c,b){var a={};c.exports=a;d("../geometry/Bounds");(function(){a.pathToVertices=function(a,c){var d,x,n,m,w,g,q=[],v,t,p=0,u=0,r=
0;c=c||15;var B=function(a,b,c){c=1===c%2&&1<c;if(!g||a!=g.x||b!=g.y){g&&c?(v=g.x,t=g.y):t=v=0;var d={x:v+a,y:t+b};if(c||!g)g=d;q.push(d);u=v+a;r=t+b}},y=function(a){var b=a.pathSegTypeAsLetter.toUpperCase();if("Z"!==b){switch(b){case "M":case "L":case "T":case "C":case "S":case "Q":u=a.x;r=a.y;break;case "H":u=a.x;break;case "V":r=a.y}B(u,r,a.pathSegType)}};b(a);x=a.getTotalLength();n=[];for(d=0;d<a.pathSegList.numberOfItems;d+=1)n.push(a.pathSegList.getItem(d));for(m=n.concat();p<x;){d=a.getPathSegAtLength(p);
d=n[d];if(d!=w){for(;m.length&&m[0]!=d;)y(m.shift());w=d}switch(d.pathSegTypeAsLetter.toUpperCase()){case "C":case "T":case "S":case "Q":case "A":d=a.getPointAtLength(p),B(d.x,d.y,0)}p+=c}d=0;for(x=m.length;d<x;++d)y(m[d]);return q};var b=function(a){for(var b,c,d,e,m,w,g=a.pathSegList,q=0,v=0,t=g.numberOfItems,p=0;p<t;++p){var u=g.getItem(p),r=u.pathSegTypeAsLetter;if(/[MLHVCSQTA]/.test(r))"x"in u&&(q=u.x),"y"in u&&(v=u.y);else switch("x1"in u&&(d=q+u.x1),"x2"in u&&(m=q+u.x2),"y1"in u&&(e=v+u.y1),
"y2"in u&&(w=v+u.y2),"x"in u&&(q+=u.x),"y"in u&&(v+=u.y),r){case "m":g.replaceItem(a.createSVGPathSegMovetoAbs(q,v),p);break;case "l":g.replaceItem(a.createSVGPathSegLinetoAbs(q,v),p);break;case "h":g.replaceItem(a.createSVGPathSegLinetoHorizontalAbs(q),p);break;case "v":g.replaceItem(a.createSVGPathSegLinetoVerticalAbs(v),p);break;case "c":g.replaceItem(a.createSVGPathSegCurvetoCubicAbs(q,v,d,e,m,w),p);break;case "s":g.replaceItem(a.createSVGPathSegCurvetoCubicSmoothAbs(q,v,m,w),p);break;case "q":g.replaceItem(a.createSVGPathSegCurvetoQuadraticAbs(q,
v,d,e),p);break;case "t":g.replaceItem(a.createSVGPathSegCurvetoQuadraticSmoothAbs(q,v),p);break;case "a":g.replaceItem(a.createSVGPathSegArcAbs(q,v,u.r1,u.r2,u.angle,u.largeArcFlag,u.sweepFlag),p);break;case "z":case "Z":q=b,v=c}if("M"==r||"m"==r)b=q,c=v}}})()},{"../geometry/Bounds":24}],26:[function(d,c,b){var a={};c.exports=a;(function(){a.create=function(a,b){return{x:a||0,y:b||0}};a.clone=function(a){return{x:a.x,y:a.y}};a.magnitude=function(a){return Math.sqrt(a.x*a.x+a.y*a.y)};a.magnitudeSquared=
function(a){return a.x*a.x+a.y*a.y};a.rotate=function(a,b){var c=Math.cos(b),d=Math.sin(b);return{x:a.x*c-a.y*d,y:a.x*d+a.y*c}};a.rotateAbout=function(a,b,c,d){var x=Math.cos(b);b=Math.sin(b);d||(d={});var n=c.x+((a.x-c.x)*x-(a.y-c.y)*b);d.y=c.y+((a.x-c.x)*b+(a.y-c.y)*x);d.x=n;return d};a.normalise=function(b){var c=a.magnitude(b);return 0===c?{x:0,y:0}:{x:b.x/c,y:b.y/c}};a.dot=function(a,b){return a.x*b.x+a.y*b.y};a.cross=function(a,b){return a.x*b.y-a.y*b.x};a.cross3=function(a,b,c){return(b.x-
a.x)*(c.y-a.y)-(b.y-a.y)*(c.x-a.x)};a.add=function(a,b,c){c||(c={});c.x=a.x+b.x;c.y=a.y+b.y;return c};a.sub=function(a,b,c){c||(c={});c.x=a.x-b.x;c.y=a.y-b.y;return c};a.mult=function(a,b){return{x:a.x*b,y:a.y*b}};a.div=function(a,b){return{x:a.x/b,y:a.y/b}};a.perp=function(a,b){b=!0===b?-1:1;return{x:b*-a.y,y:b*a.x}};a.neg=function(a){return{x:-a.x,y:-a.y}};a.angle=function(a,b){return Math.atan2(b.y-a.y,b.x-a.x)};a._temp=[a.create(),a.create(),a.create(),a.create(),a.create(),a.create()]})()},{}],
27:[function(d,c,b){var a={};c.exports=a;var e=d("../geometry/Vector"),f=d("../core/Common");(function(){a.create=function(a,b){for(var c=[],d=0;d<a.length;d++){var e=a[d];c.push({x:e.x,y:e.y,index:d,body:b,isInternal:!1})}return c};a.fromPath=function(b,c){var d=[];b.replace(/L?\s*([\-\d\.e]+)[\s,]*([\-\d\.e]+)*/ig,function(a,b,c){d.push({x:parseFloat(b),y:parseFloat(c)})});return a.create(d,c)};a.centre=function(b){for(var c=a.area(b,!0),d={x:0,y:0},f,m,w=0;w<b.length;w++)m=(w+1)%b.length,f=e.cross(b[w],
b[m]),f=e.mult(e.add(b[w],b[m]),f),d=e.add(d,f);return e.div(d,6*c)};a.mean=function(a){for(var b={x:0,y:0},c=0;c<a.length;c++)b.x+=a[c].x,b.y+=a[c].y;return e.div(b,a.length)};a.area=function(a,b){for(var c=0,d=a.length-1,e=0;e<a.length;e++)c+=(a[d].x-a[e].x)*(a[d].y+a[e].y),d=e;return b?c/2:Math.abs(c)/2};a.inertia=function(a,b){for(var c=0,d=0,f,w,g=0;g<a.length;g++)w=(g+1)%a.length,f=Math.abs(e.cross(a[w],a[g])),c+=f*(e.dot(a[w],a[w])+e.dot(a[w],a[g])+e.dot(a[g],a[g])),d+=f;return b/6*(c/d)};
a.translate=function(a,b,c){var d;if(c)for(d=0;d<a.length;d++)a[d].x+=b.x*c,a[d].y+=b.y*c;else for(d=0;d<a.length;d++)a[d].x+=b.x,a[d].y+=b.y;return a};a.rotate=function(a,b,c){if(0!==b){var d=Math.cos(b);b=Math.sin(b);for(var e=0;e<a.length;e++){var f=a[e],g=f.x-c.x,q=f.y-c.y;f.x=c.x+(g*d-q*b);f.y=c.y+(g*b+q*d)}return a}};a.contains=function(a,b){for(var c=0;c<a.length;c++){var d=a[c],e=a[(c+1)%a.length];if(0<(b.x-d.x)*(e.y-d.y)+(b.y-d.y)*(d.x-e.x))return!1}return!0};a.scale=function(b,c,d,f){if(1===
c&&1===d)return b;f=f||a.centre(b);for(var m,w=0;w<b.length;w++)m=b[w],m=e.sub(m,f),b[w].x=f.x+m.x*c,b[w].y=f.y+m.y*d;return b};a.chamfer=function(a,b,c,d,m){b=b||[8];b.length||(b=[b]);c="undefined"!==typeof c?c:-1;d=d||2;m=m||14;for(var w=[],g=0;g<a.length;g++){var q=a[0<=g-1?g-1:a.length-1],v=a[g],t=a[(g+1)%a.length],p=b[g<b.length?g:b.length-1];if(0===p)w.push(v);else{var q=e.normalise({x:v.y-q.y,y:q.x-v.x}),u=e.normalise({x:t.y-v.y,y:v.x-t.x}),r=Math.sqrt(2*Math.pow(p,2)),t=e.mult(f.clone(q),
p),B=e.normalise(e.mult(e.add(q,u),.5)),v=e.sub(v,e.mult(B,r)),r=c;-1===c&&(r=1.75*Math.pow(p,.32));r=f.clamp(r,d,m);1===r%2&&(r+=1);p=Math.acos(e.dot(q,u))/r;for(q=0;q<r;q++)w.push(e.add(e.rotate(t,p*q),v))}}return w};a.clockwiseSort=function(b){var c=a.mean(b);b.sort(function(a,b){return e.angle(c,a)-e.angle(c,b)});return b};a.isConvex=function(a){var b=0,c=a.length,d,e,f,g;if(3>c)return null;for(d=0;d<c;d++)if(e=(d+1)%c,f=(d+2)%c,g=(a[e].x-a[d].x)*(a[f].y-a[e].y),g-=(a[e].y-a[d].y)*(a[f].x-a[e].x),
0>g?b|=1:0<g&&(b|=2),3===b)return!1;return 0!==b?!0:null};a.hull=function(a){var b=[],c=[],d,f;a=a.slice(0);a.sort(function(a,b){var c=a.x-b.x;return 0!==c?c:a.y-b.y});for(f=0;f<a.length;f++){for(d=a[f];2<=c.length&&0>=e.cross3(c[c.length-2],c[c.length-1],d);)c.pop();c.push(d)}for(f=a.length-1;0<=f;f--){for(d=a[f];2<=b.length&&0>=e.cross3(b[b.length-2],b[b.length-1],d);)b.pop();b.push(d)}b.pop();c.pop();return b.concat(c)}})()},{"../core/Common":14,"../geometry/Vector":26}],28:[function(d,c,b){c=
c.exports={};c.version="master";c.Body=d("../body/Body");c.Composite=d("../body/Composite");c.World=d("../body/World");c.Contact=d("../collision/Contact");c.Detector=d("../collision/Detector");c.Grid=d("../collision/Grid");c.Pairs=d("../collision/Pairs");c.Pair=d("../collision/Pair");c.Query=d("../collision/Query");c.Resolver=d("../collision/Resolver");c.SAT=d("../collision/SAT");c.Constraint=d("../constraint/Constraint");c.MouseConstraint=d("../constraint/MouseConstraint");c.Common=d("../core/Common");
c.Engine=d("../core/Engine");c.Events=d("../core/Events");c.Mouse=d("../core/Mouse");c.Runner=d("../core/Runner");c.Sleeping=d("../core/Sleeping");c.Bodies=d("../factory/Bodies");c.Composites=d("../factory/Composites");c.Axes=d("../geometry/Axes");c.Bounds=d("../geometry/Bounds");c.Svg=d("../geometry/Svg");c.Vector=d("../geometry/Vector");c.Vertices=d("../geometry/Vertices");c.Render=d("../render/Render");c.RenderPixi=d("../render/RenderPixi");c.World.add=c.Composite.add;c.World.remove=c.Composite.remove;
c.World.addComposite=c.Composite.addComposite;c.World.addBody=c.Composite.addBody;c.World.addConstraint=c.Composite.addConstraint;c.World.clear=c.Composite.clear;c.Engine.run=c.Runner.run},{"../body/Body":1,"../body/Composite":2,"../body/World":3,"../collision/Contact":4,"../collision/Detector":5,"../collision/Grid":6,"../collision/Pair":7,"../collision/Pairs":8,"../collision/Query":9,"../collision/Resolver":10,"../collision/SAT":11,"../constraint/Constraint":12,"../constraint/MouseConstraint":13,
"../core/Common":14,"../core/Engine":15,"../core/Events":16,"../core/Metrics":17,"../core/Mouse":18,"../core/Runner":19,"../core/Sleeping":20,"../factory/Bodies":21,"../factory/Composites":22,"../geometry/Axes":23,"../geometry/Bounds":24,"../geometry/Svg":25,"../geometry/Vector":26,"../geometry/Vertices":27,"../render/Render":29,"../render/RenderPixi":30}],29:[function(d,c,b){var a={};c.exports=a;var e=d("../core/Common"),f=d("../body/Composite"),l=d("../geometry/Bounds"),k=d("../core/Events"),x=
d("../collision/Grid"),n=d("../geometry/Vector");(function(){var b,c;"undefined"!==typeof window&&(b=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame||function(a){window.setTimeout(function(){a(e.now())},1E3/60)},c=window.cancelAnimationFrame||window.mozCancelAnimationFrame||window.webkitCancelAnimationFrame||window.msCancelAnimationFrame);a.create=function(b){var c=e.extend({controller:a,engine:null,element:null,canvas:null,
mouse:null,frameRequestId:null,options:{width:800,height:600,pixelRatio:1,background:"#fafafa",wireframeBackground:"#222",hasBounds:!!b.bounds,enabled:!0,wireframes:!0,showSleeping:!0,showDebug:!1,showBroadphase:!1,showBounds:!1,showVelocity:!1,showCollisions:!1,showSeparations:!1,showAxes:!1,showPositions:!1,showAngleIndicator:!1,showIds:!1,showShadows:!1,showVertexNumbers:!1,showConvexHulls:!1,showInternalEdges:!1,showMousePosition:!1}},b);c.canvas&&(c.canvas.width=c.options.width||c.canvas.width,
c.canvas.height=c.options.height||c.canvas.height);c.mouse=b.mouse;c.engine=b.engine;c.canvas=c.canvas||d(c.options.width,c.options.height);c.context=c.canvas.getContext("2d");c.textures={};c.bounds=c.bounds||{min:{x:0,y:0},max:{x:c.canvas.width,y:c.canvas.height}};1!==c.options.pixelRatio&&a.setPixelRatio(c,c.options.pixelRatio);e.isElement(c.element)?c.element.appendChild(c.canvas):e.log("Render.create: options.element was undefined, render.canvas was created but not appended","warn");return c};
a.run=function(c){(function t(d){c.frameRequestId=b(t);a.world(c)})()};a.stop=function(a){c(a.frameRequestId)};a.setPixelRatio=function(a,b){var c=a.options,d=a.canvas;if("auto"===b){var e=d.getContext("2d");b=(window.devicePixelRatio||1)/(e.webkitBackingStorePixelRatio||e.mozBackingStorePixelRatio||e.msBackingStorePixelRatio||e.oBackingStorePixelRatio||e.backingStorePixelRatio||1)}c.pixelRatio=b;d.setAttribute("data-pixel-ratio",b);d.width=c.width*b;d.height=c.height*b;d.style.width=c.width+"px";
d.style.height=c.height+"px";a.context.scale(b,b)};a.world=function(b){var c=b.engine,d=c.world,e=b.canvas,g=b.context,m=b.options,B=f.allBodies(d),d=f.allConstraints(d),w=m.wireframes?m.wireframeBackground:m.background,A=[],z=[],C={timestamp:c.timing.timestamp};k.trigger(b,"beforeRender",C);if(b.currentBackground!==w){var E=w;/(jpg|gif|png)$/.test(w)&&(E="url("+w+")");b.canvas.style.background=E;b.canvas.style.backgroundSize="contain";b.currentBackground=w}g.globalCompositeOperation="source-in";
g.fillStyle="transparent";g.fillRect(0,0,e.width,e.height);g.globalCompositeOperation="source-over";if(m.hasBounds){w=(b.bounds.max.x-b.bounds.min.x)/m.width;E=(b.bounds.max.y-b.bounds.min.y)/m.height;for(e=0;e<B.length;e++){var F=B[e];l.overlaps(F.bounds,b.bounds)&&A.push(F)}for(e=0;e<d.length;e++){var B=d[e],F=B.bodyA,G=B.bodyB,D=B.pointA,I=B.pointB;F&&(D=n.add(F.position,B.pointA));G&&(I=n.add(G.position,B.pointB));D&&I&&(l.contains(b.bounds,D)||l.contains(b.bounds,I))&&z.push(B)}g.scale(1/w,1/
E);g.translate(-b.bounds.min.x,-b.bounds.min.y)}else z=d,A=B;!m.wireframes||c.enableSleeping&&m.showSleeping?a.bodies(b,A,g):(m.showConvexHulls&&a.bodyConvexHulls(b,A,g),a.bodyWireframes(b,A,g));m.showBounds&&a.bodyBounds(b,A,g);(m.showAxes||m.showAngleIndicator)&&a.bodyAxes(b,A,g);m.showPositions&&a.bodyPositions(b,A,g);m.showVelocity&&a.bodyVelocity(b,A,g);m.showIds&&a.bodyIds(b,A,g);m.showSeparations&&a.separations(b,c.pairs.list,g);m.showCollisions&&a.collisions(b,c.pairs.list,g);m.showVertexNumbers&&
a.vertexNumbers(b,A,g);m.showMousePosition&&a.mousePosition(b,b.mouse,g);a.constraints(z,g);m.showBroadphase&&c.broadphase.controller===x&&a.grid(b,c.broadphase,g);m.showDebug&&a.debug(b,g);m.hasBounds&&g.setTransform(m.pixelRatio,0,0,m.pixelRatio,0,0);k.trigger(b,"afterRender",C)};a.debug=function(a,b){var c=a.engine,d=c.metrics,e=a.options;f.allBodies(c.world);if(500<=c.timing.timestamp-(a.debugTimestamp||0)){var g="";d.timing&&(g+="fps: "+Math.round(d.timing.fps)+"    ");a.debugString=g;a.debugTimestamp=
c.timing.timestamp}if(a.debugString)for(b.font="12px Arial",b.fillStyle=e.wireframes?"rgba(255,255,255,0.5)":"rgba(0,0,0,0.5)",c=a.debugString.split("\n"),d=0;d<c.length;d++)b.fillText(c[d],50,50+18*d)};a.constraints=function(a,b){for(var c=0;c<a.length;c++){var d=a[c];if(d.render.visible&&d.pointA&&d.pointB){var e=d.bodyA,f=d.bodyB;e?(b.beginPath(),b.moveTo(e.position.x+d.pointA.x,e.position.y+d.pointA.y)):(b.beginPath(),b.moveTo(d.pointA.x,d.pointA.y));f?b.lineTo(f.position.x+d.pointB.x,f.position.y+
d.pointB.y):b.lineTo(d.pointB.x,d.pointB.y);b.lineWidth=d.render.lineWidth;b.strokeStyle=d.render.strokeStyle;b.stroke()}}};a.bodyShadows=function(a,b,c){for(var d=0;d<b.length;d++){var e=b[d];if(e.render.visible){if(e.circleRadius)c.beginPath(),c.arc(e.position.x,e.position.y,e.circleRadius,0,2*Math.PI);else{c.beginPath();c.moveTo(e.vertices[0].x,e.vertices[0].y);for(var f=1;f<e.vertices.length;f++)c.lineTo(e.vertices[f].x,e.vertices[f].y)}c.closePath();var f=e.position.x-.5*a.options.width,e=e.position.y-
.2*a.options.height,g=Math.abs(f)+Math.abs(e);c.shadowColor="rgba(0,0,0,0.15)";c.shadowOffsetX=.05*f;c.shadowOffsetY=.05*e;c.shadowBlur=1+12*Math.min(1,g/1E3);c.fill();c.shadowColor=null;c.shadowOffsetX=null;c.shadowOffsetY=null;c.shadowBlur=null}}};a.bodies=function(a,b,c){var d=a.options,e=d.showInternalEdges||!d.wireframes,f,g,m,l;for(m=0;m<b.length;m++)if(f=b[m],f.render.visible)for(l=1<f.parts.length?1:0;l<f.parts.length;l++)if(g=f.parts[l],g.render.visible){d.showSleeping&&f.isSleeping?c.globalAlpha=
.5*g.render.opacity:1!==g.render.opacity&&(c.globalAlpha=g.render.opacity);if(g.render.sprite&&g.render.sprite.texture&&!d.wireframes){var k=g.render.sprite,n;n=k.texture;var x=a.textures[n];x||(x=a.textures[n]=new Image,x.src=n);n=x;c.translate(g.position.x,g.position.y);c.rotate(g.angle);c.drawImage(n,n.width*-k.xOffset*k.xScale,n.height*-k.yOffset*k.yScale,n.width*k.xScale,n.height*k.yScale);c.rotate(-g.angle);c.translate(-g.position.x,-g.position.y)}else{if(g.circleRadius)c.beginPath(),c.arc(g.position.x,
g.position.y,g.circleRadius,0,2*Math.PI);else{c.beginPath();c.moveTo(g.vertices[0].x,g.vertices[0].y);for(k=1;k<g.vertices.length;k++)!g.vertices[k-1].isInternal||e?c.lineTo(g.vertices[k].x,g.vertices[k].y):c.moveTo(g.vertices[k].x,g.vertices[k].y),g.vertices[k].isInternal&&!e&&c.moveTo(g.vertices[(k+1)%g.vertices.length].x,g.vertices[(k+1)%g.vertices.length].y);c.lineTo(g.vertices[0].x,g.vertices[0].y);c.closePath()}d.wireframes?(c.lineWidth=1,c.strokeStyle="#bbb"):(c.fillStyle=g.render.fillStyle,
c.lineWidth=g.render.lineWidth,c.strokeStyle=g.render.strokeStyle,c.fill());c.stroke()}c.globalAlpha=1}};a.bodyWireframes=function(a,b,c){a=a.options.showInternalEdges;var d,e,f,g,m;c.beginPath();for(f=0;f<b.length;f++)if(d=b[f],d.render.visible)for(m=1<d.parts.length?1:0;m<d.parts.length;m++){e=d.parts[m];c.moveTo(e.vertices[0].x,e.vertices[0].y);for(g=1;g<e.vertices.length;g++)!e.vertices[g-1].isInternal||a?c.lineTo(e.vertices[g].x,e.vertices[g].y):c.moveTo(e.vertices[g].x,e.vertices[g].y),e.vertices[g].isInternal&&
!a&&c.moveTo(e.vertices[(g+1)%e.vertices.length].x,e.vertices[(g+1)%e.vertices.length].y);c.lineTo(e.vertices[0].x,e.vertices[0].y)}c.lineWidth=1;c.strokeStyle="#bbb";c.stroke()};a.bodyConvexHulls=function(a,b,c){var d,e;c.beginPath();for(d=0;d<b.length;d++)if(a=b[d],a.render.visible&&1!==a.parts.length){c.moveTo(a.vertices[0].x,a.vertices[0].y);for(e=1;e<a.vertices.length;e++)c.lineTo(a.vertices[e].x,a.vertices[e].y);c.lineTo(a.vertices[0].x,a.vertices[0].y)}c.lineWidth=1;c.strokeStyle="rgba(255,255,255,0.2)";
c.stroke()};a.vertexNumbers=function(a,b,c){var d,e;for(a=0;a<b.length;a++){var f=b[a].parts;for(e=1<f.length?1:0;e<f.length;e++){var g=f[e];for(d=0;d<g.vertices.length;d++)c.fillStyle="rgba(255,255,255,0.2)",c.fillText(a+"_"+d,g.position.x+.8*(g.vertices[d].x-g.position.x),g.position.y+.8*(g.vertices[d].y-g.position.y))}}};a.mousePosition=function(a,b,c){c.fillStyle="rgba(255,255,255,0.8)";c.fillText(b.position.x+"  "+b.position.y,b.position.x+5,b.position.y-5)};a.bodyBounds=function(a,b,c){a=a.options;
c.beginPath();for(var d=0;d<b.length;d++)if(b[d].render.visible)for(var e=b[d].parts,f=1<e.length?1:0;f<e.length;f++){var g=e[f];c.rect(g.bounds.min.x,g.bounds.min.y,g.bounds.max.x-g.bounds.min.x,g.bounds.max.y-g.bounds.min.y)}c.strokeStyle=a.wireframes?"rgba(255,255,255,0.08)":"rgba(0,0,0,0.1)";c.lineWidth=1;c.stroke()};a.bodyAxes=function(a,b,c){a=a.options;var d,e,f,g;c.beginPath();for(e=0;e<b.length;e++){d=b[e];var m=d.parts;if(d.render.visible)if(a.showAxes)for(f=1<m.length?1:0;f<m.length;f++)for(d=
m[f],g=0;g<d.axes.length;g++){var l=d.axes[g];c.moveTo(d.position.x,d.position.y);c.lineTo(d.position.x+20*l.x,d.position.y+20*l.y)}else for(f=1<m.length?1:0;f<m.length;f++)for(d=m[f],g=0;g<d.axes.length;g++)c.moveTo(d.position.x,d.position.y),c.lineTo((d.vertices[0].x+d.vertices[d.vertices.length-1].x)/2,(d.vertices[0].y+d.vertices[d.vertices.length-1].y)/2)}a.wireframes?c.strokeStyle="indianred":(c.strokeStyle="rgba(0,0,0,0.8)",c.globalCompositeOperation="overlay");c.lineWidth=1;c.stroke();c.globalCompositeOperation=
"source-over"};a.bodyPositions=function(a,b,c){a=a.options;var d,e,f,g;c.beginPath();for(f=0;f<b.length;f++)if(d=b[f],d.render.visible)for(g=0;g<d.parts.length;g++)e=d.parts[g],c.arc(e.position.x,e.position.y,3,0,2*Math.PI,!1),c.closePath();c.fillStyle=a.wireframes?"indianred":"rgba(0,0,0,0.5)";c.fill();c.beginPath();for(f=0;f<b.length;f++)d=b[f],d.render.visible&&(c.arc(d.positionPrev.x,d.positionPrev.y,2,0,2*Math.PI,!1),c.closePath());c.fillStyle="rgba(255,165,0,0.8)";c.fill()};a.bodyVelocity=function(a,
b,c){c.beginPath();for(a=0;a<b.length;a++){var d=b[a];d.render.visible&&(c.moveTo(d.position.x,d.position.y),c.lineTo(d.position.x+2*(d.position.x-d.positionPrev.x),d.position.y+2*(d.position.y-d.positionPrev.y)))}c.lineWidth=3;c.strokeStyle="cornflowerblue";c.stroke()};a.bodyIds=function(a,b,c){var d;for(a=0;a<b.length;a++)if(b[a].render.visible){var e=b[a].parts;for(d=1<e.length?1:0;d<e.length;d++){var f=e[d];c.font="12px Arial";c.fillStyle="rgba(255,255,255,0.5)";c.fillText(f.id,f.position.x+10,
f.position.y-10)}}};a.collisions=function(a,b,c){a=a.options;var d,e,f;c.beginPath();for(f=0;f<b.length;f++)if(d=b[f],d.isActive)for(e=0;e<d.activeContacts.length;e++){var g=d.activeContacts[e].vertex;c.rect(g.x-1.5,g.y-1.5,3.5,3.5)}c.fillStyle=a.wireframes?"rgba(255,255,255,0.7)":"orange";c.fill();c.beginPath();for(f=0;f<b.length;f++)if(d=b[f],d.isActive&&(e=d.collision,0<d.activeContacts.length)){var g=d.activeContacts[0].vertex.x,m=d.activeContacts[0].vertex.y;2===d.activeContacts.length&&(g=(d.activeContacts[0].vertex.x+
d.activeContacts[1].vertex.x)/2,m=(d.activeContacts[0].vertex.y+d.activeContacts[1].vertex.y)/2);e.bodyB===e.supports[0].body||!0===e.bodyA.isStatic?c.moveTo(g-8*e.normal.x,m-8*e.normal.y):c.moveTo(g+8*e.normal.x,m+8*e.normal.y);c.lineTo(g,m)}c.strokeStyle=a.wireframes?"rgba(255,165,0,0.7)":"orange";c.lineWidth=1;c.stroke()};a.separations=function(a,b,c){a=a.options;var d,e,f,g;c.beginPath();for(g=0;g<b.length;g++)if(d=b[g],d.isActive){d=d.collision;e=d.bodyA;f=d.bodyB;var m=1;f.isStatic||e.isStatic||
(m=.5);f.isStatic&&(m=0);c.moveTo(f.position.x,f.position.y);c.lineTo(f.position.x-d.penetration.x*m,f.position.y-d.penetration.y*m);m=1;f.isStatic||e.isStatic||(m=.5);e.isStatic&&(m=0);c.moveTo(e.position.x,e.position.y);c.lineTo(e.position.x+d.penetration.x*m,e.position.y+d.penetration.y*m)}c.strokeStyle=a.wireframes?"rgba(255,165,0,0.5)":"orange";c.stroke()};a.grid=function(a,b,c){c.strokeStyle=a.options.wireframes?"rgba(255,180,0,0.1)":"rgba(255,180,0,0.5)";c.beginPath();a=e.keys(b.buckets);for(var d=
0;d<a.length;d++){var f=a[d];2>b.buckets[f].length||(f=f.split(","),c.rect(.5+parseInt(f[0],10)*b.bucketWidth,.5+parseInt(f[1],10)*b.bucketHeight,b.bucketWidth,b.bucketHeight))}c.lineWidth=1;c.stroke()};a.inspector=function(a,b){var c=a.selected,d=a.render,e=d.options,f;e.hasBounds&&(b.scale(1/((d.bounds.max.x-d.bounds.min.x)/d.options.width),1/((d.bounds.max.y-d.bounds.min.y)/d.options.height)),b.translate(-d.bounds.min.x,-d.bounds.min.y));for(d=0;d<c.length;d++){f=c[d].data;b.translate(.5,.5);b.lineWidth=
1;b.strokeStyle="rgba(255,165,0,0.9)";b.setLineDash([1,2]);switch(f.type){case "body":f=f.bounds;b.beginPath();b.rect(Math.floor(f.min.x-3),Math.floor(f.min.y-3),Math.floor(f.max.x-f.min.x+6),Math.floor(f.max.y-f.min.y+6));b.closePath();b.stroke();break;case "constraint":var g=f.pointA;f.bodyA&&(g=f.pointB);b.beginPath();b.arc(g.x,g.y,10,0,2*Math.PI);b.closePath();b.stroke()}b.setLineDash([]);b.translate(-.5,-.5)}null!==a.selectStart&&(b.translate(.5,.5),b.lineWidth=1,b.strokeStyle="rgba(255,165,0,0.6)",
b.fillStyle="rgba(255,165,0,0.1)",f=a.selectBounds,b.beginPath(),b.rect(Math.floor(f.min.x),Math.floor(f.min.y),Math.floor(f.max.x-f.min.x),Math.floor(f.max.y-f.min.y)),b.closePath(),b.stroke(),b.fill(),b.translate(-.5,-.5));e.hasBounds&&b.setTransform(1,0,0,1,0,0)};var d=function(a,b){var c=document.createElement("canvas");c.width=a;c.height=b;c.oncontextmenu=function(){return!1};c.onselectstart=function(){return!1};return c}})()},{"../body/Composite":2,"../collision/Grid":6,"../core/Common":14,
"../core/Events":16,"../geometry/Bounds":24,"../geometry/Vector":26}],30:[function(d,c,b){var a={};c.exports=a;var e=d("../body/Composite"),f=d("../core/Common");(function(){var b,c;"undefined"!==typeof window&&(b=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame||function(a){window.setTimeout(function(){a(f.now())},1E3/60)},c=window.cancelAnimationFrame||window.mozCancelAnimationFrame||window.webkitCancelAnimationFrame||
window.msCancelAnimationFrame);a.create=function(b){f.log("RenderPixi.create: Matter.RenderPixi is deprecated (see docs)","warn");var c=f.extend({controller:a,engine:null,element:null,frameRequestId:null,canvas:null,renderer:null,container:null,spriteContainer:null,pixiOptions:null,options:{width:800,height:600,background:"#fafafa",wireframeBackground:"#222",hasBounds:!1,enabled:!0,wireframes:!0,showSleeping:!0,showDebug:!1,showBroadphase:!1,showBounds:!1,showVelocity:!1,showCollisions:!1,showAxes:!1,
showPositions:!1,showAngleIndicator:!1,showIds:!1,showShadows:!1}},b),d=!c.options.wireframes&&"transparent"===c.options.background;c.pixiOptions=c.pixiOptions||{view:c.canvas,transparent:d,antialias:!0,backgroundColor:b.background};c.mouse=b.mouse;c.engine=b.engine;c.renderer=c.renderer||new PIXI.WebGLRenderer(c.options.width,c.options.height,c.pixiOptions);c.container=c.container||new PIXI.Container;c.spriteContainer=c.spriteContainer||new PIXI.Container;c.canvas=c.canvas||c.renderer.view;c.bounds=
c.bounds||{min:{x:0,y:0},max:{x:c.options.width,y:c.options.height}};c.textures={};c.sprites={};c.primitives={};c.container.addChild(c.spriteContainer);f.isElement(c.element)?c.element.appendChild(c.canvas):f.log('No "render.element" passed, "render.canvas" was not inserted into document.',"warn");c.canvas.oncontextmenu=function(){return!1};c.canvas.onselectstart=function(){return!1};return c};a.run=function(c){(function w(d){c.frameRequestId=b(w);a.world(c)})()};a.stop=function(a){c(a.frameRequestId)};
a.clear=function(a){for(var b=a.container,c=a.spriteContainer;b.children[0];)b.removeChild(b.children[0]);for(;c.children[0];)c.removeChild(c.children[0]);c=a.sprites["bg-0"];a.textures={};a.sprites={};a.primitives={};(a.sprites["bg-0"]=c)&&b.addChildAt(c,0);a.container.addChild(a.spriteContainer);a.currentBackground=null;b.scale.set(1,1);b.position.set(0,0)};a.setBackground=function(a,b){if(a.currentBackground!==b){var c=b.indexOf&&-1!==b.indexOf("#"),e=a.sprites["bg-0"];c?(c=f.colorToNumber(b),
a.renderer.backgroundColor=c,e&&a.container.removeChild(e)):e||(e=d(a,b),e=a.sprites["bg-0"]=new PIXI.Sprite(e),e.position.x=0,e.position.y=0,a.container.addChildAt(e,0));a.currentBackground=b}};a.world=function(b){var c=b.engine.world,d=b.renderer,f=b.container,l=b.options,k=e.allBodies(c),c=e.allConstraints(c),x=[];l.wireframes?a.setBackground(b,l.wireframeBackground):a.setBackground(b,l.background);var p=(b.bounds.max.x-b.bounds.min.x)/b.options.width,u=(b.bounds.max.y-b.bounds.min.y)/b.options.height;
if(l.hasBounds){for(l=0;l<k.length;l++){var r=k[l];r.render.sprite.visible=Bounds.overlaps(r.bounds,b.bounds)}for(l=0;l<c.length;l++){var r=c[l],B=r.bodyA,y=r.bodyB,A=r.pointA,z=r.pointB;B&&(A=Vector.add(B.position,r.pointA));y&&(z=Vector.add(y.position,r.pointB));A&&z&&(Bounds.contains(b.bounds,A)||Bounds.contains(b.bounds,z))&&x.push(r)}f.scale.set(1/p,1/u);f.position.set(1/p*-b.bounds.min.x,1/u*-b.bounds.min.y)}else x=c;for(l=0;l<k.length;l++)a.body(b,k[l]);for(l=0;l<x.length;l++)a.constraint(b,
x[l]);d.render(f)};a.constraint=function(a,b){var c=b.bodyA,d=b.bodyB,e=b.pointA,l=b.pointB,k=a.container,p=b.render,x="c-"+b.id,r=a.primitives[x];r||(r=a.primitives[x]=new PIXI.Graphics);p.visible&&b.pointA&&b.pointB?(-1===f.indexOf(k.children,r)&&k.addChild(r),r.clear(),r.beginFill(0,0),r.lineStyle(p.lineWidth,f.colorToNumber(p.strokeStyle),1),c?r.moveTo(c.position.x+e.x,c.position.y+e.y):r.moveTo(e.x,e.y),d?r.lineTo(d.position.x+l.x,d.position.y+l.y):r.lineTo(l.x,l.y),r.endFill()):r.clear()};a.body=
function(a,b){var c=b.render;if(c.visible)if(c.sprite&&c.sprite.texture){var e="b-"+b.id,l=a.sprites[e],k=a.spriteContainer;if(!l){var l=a.sprites,t=d(a,b.render.sprite.texture),t=new PIXI.Sprite(t);t.anchor.x=b.render.sprite.xOffset;t.anchor.y=b.render.sprite.yOffset;l=l[e]=t}-1===f.indexOf(k.children,l)&&k.addChild(l);l.position.x=b.position.x;l.position.y=b.position.y;l.rotation=b.angle;l.scale.x=c.sprite.xScale||1;l.scale.y=c.sprite.yScale||1}else{c="b-"+b.id;k=a.primitives[c];e=a.container;if(!k){var k=
a.primitives,l=b.render,t=a.options,p=new PIXI.Graphics,u=f.colorToNumber(l.fillStyle),r=f.colorToNumber(l.strokeStyle),B=f.colorToNumber(l.strokeStyle),y=f.colorToNumber("#bbb"),A=f.colorToNumber("#CD5C5C"),z;p.clear();for(var C=1<b.parts.length?1:0;C<b.parts.length;C++){z=b.parts[C];t.wireframes?(p.beginFill(0,0),p.lineStyle(1,y,1)):(p.beginFill(u,1),p.lineStyle(l.lineWidth,r,1));p.moveTo(z.vertices[0].x-b.position.x,z.vertices[0].y-b.position.y);for(var E=1;E<z.vertices.length;E++)p.lineTo(z.vertices[E].x-
b.position.x,z.vertices[E].y-b.position.y);p.lineTo(z.vertices[0].x-b.position.x,z.vertices[0].y-b.position.y);p.endFill();if(t.showAngleIndicator||t.showAxes)p.beginFill(0,0),t.wireframes?p.lineStyle(1,A,1):p.lineStyle(1,B),p.moveTo(z.position.x-b.position.x,z.position.y-b.position.y),p.lineTo((z.vertices[0].x+z.vertices[z.vertices.length-1].x)/2-b.position.x,(z.vertices[0].y+z.vertices[z.vertices.length-1].y)/2-b.position.y),p.endFill()}k=k[c]=p;k.initialAngle=b.angle}-1===f.indexOf(e.children,
k)&&e.addChild(k);k.position.x=b.position.x;k.position.y=b.position.y;k.rotation=b.angle-k.initialAngle}};var d=function(a,b){var c=a.textures[b];c||(c=a.textures[b]=PIXI.Texture.fromImage(b));return c}})()},{"../body/Composite":2,"../core/Common":14}]},{},[28])(28)});
(function(h,d,c){function b(a,b){function c(){}c.prototype=a;var d=new c,e;for(e in b)d[e]=b[e];b.toString!==Object.prototype.toString&&(d.toString=b.toString);return d}function a(a,b){if(null==b)return null;null==b.__id__&&(b.__id__=E++);var c;null==a.hx__closures__?a.hx__closures__={}:c=a.hx__closures__[b.__id__];null==c&&(c=function(){return c.method.apply(c.scope,arguments)},c.scope=a,c.method=b,a.hx__closures__[b.__id__]=c);return c}var e=function(){this.bufferList=new y;this.types=new y;this.types.set("mp3",
"audio/mpeg");this.types.set("ogg","audio/ogg");this.types.set("wav","audio/wav");this.types.set("aac","audio/aac");this.types.set("m4a","audio/x-m4a")};e.__name__=!0;e.prototype={checkWebAudioAPISupport:function(){return null!=m.field(window,"AudioContext")||null!=m.field(window,"webkitAudioContext")},unlockAudio:function(){if(null!=this.audioContext){var b=this.audioContext.createBuffer(1,1,g.preferredSampleRate),c=this.audioContext.createBufferSource();c.buffer=b;c.connect(this.audioContext.destination);
null!=m.field(c,"start")?c.start(0):c.noteOn(0);null!=c.onended?c.onended=a(this,this._unlockCallback):r.delay(a(this,this._unlockCallback),1)}else b=window.document.createElement("audio"),c=window.document.createElement("source"),c.src="data:audio/wave;base64,UklGRjIAAABXQVZFZm10IBIAAAABAAEAQB8AAEAfAAABAAgAAABmYWN0BAAAAAAAAABkYXRhAAAAAA==",b.appendChild(c),window.document.appendChild(b),b.play(),null!=g.__touchUnlockCallback&&g.__touchUnlockCallback(),g.dom.ontouchend=null},_unlockCallback:function(){null!=
g.__touchUnlockCallback&&g.__touchUnlockCallback();g.dom.ontouchend=null},createAudioContext:function(){if(null==this.audioContext)try{null!=m.field(window,"AudioContext")?this.audioContext=new AudioContext:null!=m.field(window,"webkitAudioContext")&&(this.audioContext=new webkitAudioContext),this.masterGainNode=this.createGain()}catch(a){a instanceof A&&(a=a.val),this.audioContext=null}return this.audioContext},createGain:function(){return null!=(C=this.audioContext,a(C,C.createGain))?this.audioContext.createGain():
m.callMethod(this.audioContext,m.field(this.audioContext,"createGainNode"),[])},destroy:function(){null!=this.audioContext&&null!=this.audioContext.close&&""!=this.audioContext.close&&this.audioContext.close();this.types=this.bufferList=this.audioContext=null},__class__:e};var f=function(a,b){this._b64=new l("(^data:audio).*(;base64,)","i");null==a||""==a?h.log("invalid sound url"):null==g.audioManager?h.log("initialise Waud using Waud.init() before loading sounds"):(this.isSpriteSound=!1,this.url=
a,this._muted=this._isPlaying=this._isLoaded=!1,this._duration=0,this._options=p.setDefaultOptions(b),this.rate=this._options.playbackRate)};f.__name__=!0;f.prototype={isReady:function(){return this._isLoaded},__class__:f};var l=function(a,b){b=b.split("u").join("");this.r=new RegExp(a,b)};l.__name__=!0;l.prototype={match:function(a){this.r.global&&(this.r.lastIndex=0);this.r.m=this.r.exec(a);this.r.s=a;return null!=this.r.m},matched:function(a){if(null!=this.r.m&&0<=a&&a<this.r.m.length)return this.r.m[a];
throw new A("EReg::matched");},__class__:l};var k=function(){};k.__name__=!0;k.prototype={__class__:k};var x=function(a,b,c){f.call(this,a,b);this._snd=g.dom.createElement("audio");null==c?this._addSource(a):this._snd.appendChild(c);this._options.preload&&this.load();this._b64.match(a)};x.__name__=!0;x.__interfaces__=[k];x.__super__=f;x.prototype=b(f.prototype,{load:function(a){var b=this;this._isLoaded||(this._snd.autoplay=this._options.autoplay,this._snd.loop=this._options.loop,this._snd.volume=
this._options.volume,this._snd.playbackRate=this.rate,null!=a&&(this._options.onload=a),this._snd.preload=this._options.preload?"auto":"metadata",null!=this._options.onload&&(this._isLoaded=!0,this._snd.onloadeddata=function(){b._options.onload(b)}),this._snd.onplaying=function(){b._isPlaying=!0},this._snd.onended=function(){b._isPlaying=!1;if(null!=b._options.onend)b._options.onend(b)},null!=this._options.onerror&&(this._snd.onerror=function(){b._options.onerror(b)}),this._snd.load());return this},
getDuration:function(){return this._isLoaded?this._duration=this._snd.duration:0},_addSource:function(a){this.source=g.dom.createElement("source");this.source.src=a;var b=this._getExt(a);null!=g.audioManager.types.get(b)&&(a=this._getExt(a),this.source.type=g.audioManager.types.get(a));this._snd.appendChild(this.source);return this.source},_getExt:function(a){return a.split(".").pop()},setVolume:function(a,b){0<=a&&1>=a&&(this._options.volume=a);this._isLoaded&&(this._snd.volume=this._options.volume)},
getVolume:function(a){return this._options.volume},mute:function(a,b){this._isLoaded&&(this._snd.muted=a,p.isiOS()&&(a&&this.isPlaying()?(this._muted=!0,this._snd.pause()):this._muted&&(this._muted=!1,this._snd.play())))},toggleMute:function(a){this.mute(!this._muted)},play:function(b,c){var d=this;this.spriteName=b;if(!this._isLoaded||null==this._snd)return h.log("sound not loaded"),-1;if(this._isPlaying)if(this._options.autostop)this.stop(this.spriteName);else{var e;e=z.__cast(this._snd.cloneNode(!0),
HTMLAudioElement);r.delay(a(e,e.play),100)}if(this._muted)return-1;this.isSpriteSound&&null!=c&&(this._snd.currentTime=null==this._pauseTime?c.start:this._pauseTime,null!=this._tmr&&this._tmr.stop(),this._tmr=r.delay(function(){null!=c.loop&&c.loop?d.play(d.spriteName,c):d.stop(d.spriteName)},Math.ceil(1E3*c.duration)));r.delay((C=this._snd,a(C,C.play)),100);this._pauseTime=null;return 0},togglePlay:function(a){this._isPlaying?this.pause():this.play()},isPlaying:function(a){return this._isPlaying},
loop:function(a){this._isLoaded&&null!=this._snd&&(this._snd.loop=a)},autoStop:function(a){this._options.autostop=a},stop:function(a){this._isLoaded&&null!=this._snd&&(this._snd.currentTime=0,this._snd.pause(),this._isPlaying=!1,null!=this._tmr&&this._tmr.stop())},pause:function(a){this._isLoaded&&null!=this._snd&&(this._snd.pause(),this._pauseTime=this._snd.currentTime,this._isPlaying=!1,null!=this._tmr&&this._tmr.stop())},playbackRate:function(a,b){return null==a?this.rate:this.rate=this._snd.playbackRate=
a},setTime:function(a){!this._isLoaded||null==this._snd||a>this._snd.duration||(this._snd.currentTime=a)},getTime:function(){return null!=this._snd&&this._isLoaded&&this._isPlaying?this._snd.currentTime:0},onEnd:function(a,b){this._options.onend=a;return this},onLoad:function(a){this._options.onload=a;return this},onError:function(a){this._options.onerror=a;return this},destroy:function(){null!=this._snd&&(this._snd.pause(),this._snd.removeChild(this.source),this._snd=this.source=null);this._isPlaying=
!1},__class__:x});var n=function(){};n.__name__=!0;n.cca=function(a,b){var c=a.charCodeAt(b);return c!=c?void 0:c};n.indexOf=function(a,b,c){var d=a.length;0>c&&(c+=d,0>c&&(c=0));for(;c<d;){if(a[c]===b)return c;c++}return-1};Math.__name__=!0;var m=function(){};m.__name__=!0;m.field=function(a,b){try{return a[b]}catch(c){return c instanceof A&&(c=c.val),null}};m.callMethod=function(a,b,c){return b.apply(a,c)};m.fields=function(a){var b=[];if(null!=a){var c=Object.prototype.hasOwnProperty,d;for(d in a)"__id__"!=
d&&"hx__closures__"!=d&&c.call(a,d)&&b.push(d)}return b};var w=function(){};w.__name__=!0;w.string=function(a){return z.__string_rec(a,"")};w.parseInt=function(a){var b=parseInt(a,10);0!=b||120!=n.cca(a,1)&&88!=n.cca(a,1)||(b=parseInt(a));return isNaN(b)?null:b};var g=d.Waud=function(){};g.__name__=!0;g.init=function(a){null==g.__audioElement&&(null==a&&(a=window.document),g.dom=a,g.__audioElement=g.dom.createElement("audio"),null==g.audioManager&&(g.audioManager=new e),g.isWebAudioSupported=g.audioManager.checkWebAudioAPISupport(),
g.isHTML5AudioSupported=null!=m.field(window,"Audio"),g.isWebAudioSupported&&(g.audioContext=g.audioManager.createAudioContext()),g.sounds=new y,g._volume=1,g._sayHello())};g._sayHello=function(){1<window.navigator.userAgent.toLowerCase().indexOf("chrome")?window.console.log.apply(window.console,["\n %c %c %c WAUD%c.%cJS%c v"+g.version+" %c  %c http://www.waudjs.com %c %c %c \ud83d\udce2 \n\n","background: #32BEA6; padding:5px 0;","background: #32BEA6; padding:5px 0;","color: #E70000; background: #29162B; padding:5px 0;",
"color: #F3B607; background: #29162B; padding:5px 0;","color: #32BEA6; background: #29162B; padding:5px 0;","color: #999999; background: #29162B; padding:5px 0;","background: #32BEA6; padding:5px 0;","background: #B8FCEF; padding:5px 0;","background: #32BEA6; padding:5px 0;","color: #E70000; background: #32BEA6; padding:5px 0;","color: #FF2424; background: #FFFFFF; padding:5px 0;"]):window.console.log("WAUD.JS v"+g.version+" - http://www.waudjs.com")};g.autoMute=function(){g._focusManager=new v;g._focusManager.focus=
function(){g.mute(!1)};g._focusManager.blur=function(){g.mute(!0)}};g.enableTouchUnlock=function(b){g.__touchUnlockCallback=b;g.dom.ontouchend=(C=g.audioManager,a(C,C.unlockAudio))};g.setVolume=function(a){if(((a|0)===a||"number"==typeof a)&&0<=a&&1>=a){if(g._volume=a,null!=g.sounds)for(var b=g.sounds.iterator();b.hasNext();)b.next().setVolume(a)}else window.console.warn("Volume should be a number between 0 and 1. Received: "+a)};g.getVolume=function(){return g._volume};g.mute=function(a){null==a&&
(a=!0);g.isMuted=a;if(null!=g.sounds)for(var b=g.sounds.iterator();b.hasNext();)b.next().mute(a)};g.playbackRate=function(a){if(null==a)return g._playbackRate;if(null!=g.sounds)for(var b=g.sounds.iterator();b.hasNext();)b.next().playbackRate(a);return g._playbackRate=a};g.stop=function(){if(null!=g.sounds)for(var a=g.sounds.iterator();a.hasNext();)a.next().stop()};g.pause=function(){if(null!=g.sounds)for(var a=g.sounds.iterator();a.hasNext();)a.next().pause()};g.getFormatSupportString=function(){var a=
"OGG: "+g.__audioElement.canPlayType('audio/ogg; codecs="vorbis"'),a=a+(", WAV: "+g.__audioElement.canPlayType('audio/wav; codecs="1"')),a=a+(", MP3: "+g.__audioElement.canPlayType("audio/mpeg;")),a=a+(", AAC: "+g.__audioElement.canPlayType("audio/aac;"));return a+=", M4A: "+g.__audioElement.canPlayType("audio/x-m4a;")};g.isSupported=function(){if(null==g.isWebAudioSupported||null==g.isHTML5AudioSupported)g.isWebAudioSupported=g.audioManager.checkWebAudioAPISupport(),g.isHTML5AudioSupported=null!=
m.field(window,"Audio");return g.isWebAudioSupported||g.isHTML5AudioSupported};g.isOGGSupported=function(){var a=g.__audioElement.canPlayType('audio/ogg; codecs="vorbis"');return g.isHTML5AudioSupported&&null!=a&&("probably"==a||"maybe"==a)};g.isWAVSupported=function(){var a=g.__audioElement.canPlayType('audio/wav; codecs="1"');return g.isHTML5AudioSupported&&null!=a&&("probably"==a||"maybe"==a)};g.isMP3Supported=function(){var a=g.__audioElement.canPlayType("audio/mpeg;");return g.isHTML5AudioSupported&&
null!=a&&("probably"==a||"maybe"==a)};g.isAACSupported=function(){var a=g.__audioElement.canPlayType("audio/aac;");return g.isHTML5AudioSupported&&null!=a&&("probably"==a||"maybe"==a)};g.isM4ASupported=function(){var a=g.__audioElement.canPlayType("audio/x-m4a;");return g.isHTML5AudioSupported&&null!=a&&("probably"==a||"maybe"==a)};g.getSampleRate=function(){return null!=g.audioContext?g.audioContext.sampleRate:0};g.destroy=function(){if(null!=g.sounds)for(var a=g.sounds.iterator();a.hasNext();)a.next().destroy();
g.sounds=null;null!=g.audioManager&&g.audioManager.destroy();g.audioManager=null;g.audioContext=null;g.__audioElement=null;null!=g._focusManager&&(g._focusManager.clearEvents(),g._focusManager.blur=null,g._focusManager.focus=null,g._focusManager=null)};var q=d.WaudBase64Pack=function(a,b,c,d,e,f){null==f&&(f=!1);null==g.audioManager?h.log("initialise Waud using Waud.init() before loading sounds"):(this._sequentialLoad=f,0<a.indexOf(".json")&&(this.progress=0,this._options=p.setDefaultOptions(e),this._loadCount=
this._soundCount=this._totalSize=0,this._onLoaded=b,this._onProgress=c,this._onError=d,this._sounds=new y,this._loadBase64Json(a)))};q.__name__=!0;q.prototype={_loadBase64Json:function(a){var b=this,c=new l('"meta":.[0-9]*,[0-9]*.',"i"),d=new XMLHttpRequest;d.open("GET",a,!0);null!=this._onProgress&&(d.onprogress=function(a){if(c.match(d.responseText)&&0==b._totalSize){var e=JSON.parse("{"+c.matched(0)+"}");b._totalSize=e.meta[1]}b.progress=a.lengthComputable?a.loaded/a.total:a.loaded/b._totalSize;
1<b.progress&&(b.progress=1);b._onProgress(.8*b.progress)});d.onreadystatechange=function(){if(4==d.readyState&&200==d.status){var a=JSON.parse(d.responseText);b._soundsToLoad=new y;b._soundIds=[];for(var c=0,e=m.fields(a);c<e.length;){var f=e[c];++c;if("meta"!=f)if(a instanceof Array&&null==a.__enum__){b._soundIds.push(m.field(a,f).name);var g=m.field(a,f).name,f="data:"+w.string(m.field(a,f).mime)+";base64,"+w.string(m.field(a,f).data);b._soundsToLoad.set(g,f)}else b._soundIds.push(f),g=m.field(a,
f),b._soundsToLoad.set(f,g)}b._soundCount=b._soundIds.length;if(b._sequentialLoad)b._createSound(b._soundIds.shift());else for(;0<b._soundIds.length;)b._createSound(b._soundIds.shift())}};d.send(null)},_createSound:function(a){var b=this;new t(this._soundsToLoad.get(a),{onload:function(c){b._sounds.set(a,c);g.sounds.set(a,c);if(null!=b._options.onload)b._options.onload(c);b._checkProgress()},onerror:function(c){b._sounds.set(a,null);if(null!=b._options.onerror)b._options.onerror(c);b._checkProgress()&&
null!=b._onError&&b._onError()},autoplay:this._options.autoplay,autostop:this._options.autostop,loop:this._options.loop,onend:this._options.onend,playbackRate:this._options.playbackRate,preload:this._options.preload,volume:this._options.volume,webaudio:this._options.webaudio})},_checkProgress:function(){this._loadCount++;null!=this._onProgress&&this._onProgress(.8+this._loadCount/this._soundCount*.2);if(this._loadCount==this._soundCount)return this._soundsToLoad=null,null!=this._onLoaded&&this._onLoaded(this._sounds),
!0;this._sequentialLoad&&this._createSound(this._soundIds.shift());return!1},__class__:q};var v=d.WaudFocusManager=function(){var b=this;this._currentState=this._visibilityChange=this._hidden="";null!=m.field(window.document,"hidden")?(this._hidden="hidden",this._visibilityChange="visibilitychange"):null!=m.field(window.document,"mozHidden")?(this._hidden="mozHidden",this._visibilityChange="mozvisibilitychange"):null!=m.field(window.document,"msHidden")?(this._hidden="msHidden",this._visibilityChange=
"msvisibilitychange"):null!=m.field(window.document,"webkitHidden")&&(this._hidden="webkitHidden",this._visibilityChange="webkitvisibilitychange");null!=m.field(window,"addEventListener")?(window.addEventListener("focus",a(this,this._focus)),window.addEventListener("blur",a(this,this._blur)),window.addEventListener("pageshow",a(this,this._focus)),window.addEventListener("pagehide",a(this,this._blur)),document.addEventListener(this._visibilityChange,a(this,this._handleVisibilityChange))):null!=m.field(window,
"attachEvent")?(window.attachEvent("onfocus",a(this,this._focus)),window.attachEvent("onblur",a(this,this._blur)),window.attachEvent("pageshow",a(this,this._focus)),window.attachEvent("pagehide",a(this,this._blur)),document.attachEvent(this._visibilityChange,a(this,this._handleVisibilityChange))):window.onload=function(){window.onfocus=a(b,b._focus);window.onblur=a(b,b._blur);window.onpageshow=a(b,b._focus);window.onpagehide=a(b,b._blur)}};v.__name__=!0;v.prototype={_handleVisibilityChange:function(){null!=
m.field(window.document,this._hidden)&&m.field(window.document,this._hidden)&&null!=this.blur?this.blur():null!=this.focus&&this.focus()},_focus:function(){"focus"!=this._currentState&&null!=this.focus&&this.focus();this._currentState="focus"},_blur:function(){"blur"!=this._currentState&&null!=this.blur&&this.blur();this._currentState="blur"},clearEvents:function(){null!=m.field(window,"removeEventListener")?(window.removeEventListener("focus",a(this,this._focus)),window.removeEventListener("blur",
a(this,this._blur)),window.removeEventListener("pageshow",a(this,this._focus)),window.removeEventListener("pagehide",a(this,this._blur)),window.removeEventListener(this._visibilityChange,a(this,this._handleVisibilityChange))):null!=m.field(window,"removeEvent")?(window.removeEvent("onfocus",a(this,this._focus)),window.removeEvent("onblur",a(this,this._blur)),window.removeEvent("pageshow",a(this,this._focus)),window.removeEvent("pagehide",a(this,this._blur)),window.removeEvent(this._visibilityChange,
a(this,this._handleVisibilityChange))):(window.onfocus=null,window.onblur=null,window.onpageshow=null,window.onpagehide=null)},__class__:v};var t=d.WaudSound=function(a,b){if(null==g.audioManager)h.log("initialise Waud using Waud.init() before loading sounds");else if(this.rate=1,this._options=b,0<a.indexOf(".json")?(this.isSpriteSound=!0,this._spriteDuration=0,this._spriteSounds=new y,this._spriteSoundEndCallbacks=new y,this._loadSpriteJson(a)):(this.isSpriteSound=!1,this._init(a)),(new l("(^data:audio).*(;base64,)",
"i")).match(a)){var c="snd"+(new Date).getTime();g.sounds.set(c,this)}else g.sounds.set(a,this)};t.__name__=!0;t.__interfaces__=[k];t.prototype={_loadSpriteJson:function(a){var b=this,c=new XMLHttpRequest;c.open("GET",a,!0);c.onreadystatechange=function(){if(4==c.readyState&&200==c.status){b._spriteData=JSON.parse(c.responseText);var d=b._spriteData.src;-1<a.indexOf("/")&&(d=a.substring(0,a.lastIndexOf("/")+1)+d);b._init(d)}};c.send(null)},_init:function(a){this.url=a;if(g.isWebAudioSupported&&g.useWebAudio&&
(null==this._options||null==this._options.webaudio||this._options.webaudio))this.isSpriteSound?this._loadSpriteSound(this.url):this._snd=new u(this.url,this._options);else if(g.isHTML5AudioSupported)if(null!=this._spriteData&&null!=this._spriteData.sprite){a=0;for(var b=this._spriteData.sprite;a<b.length;){var c=b[a];++a;var d=new x(this.url,this._options);d.isSpriteSound=!0;this._spriteSounds.set(c.name,d)}}else this._snd=new x(this.url,this._options);else h.log("no audio support in this browser")},
getDuration:function(){return this.isSpriteSound?this._spriteDuration:null==this._snd?0:this._snd.getDuration()},setVolume:function(a,b){(a|0)===a||"number"==typeof a?this.isSpriteSound?null!=b&&null!=this._spriteSounds.get(b)&&this._spriteSounds.get(b).setVolume(a):null!=this._snd&&this._snd.setVolume(a):window.console.warn("Volume should be a number between 0 and 1. Received: "+a)},getVolume:function(a){return this.isSpriteSound?null!=a&&null!=this._spriteSounds.get(a)?this._spriteSounds.get(a).getVolume():
0:null==this._snd?0:this._snd.getVolume()},mute:function(a,b){if(this.isSpriteSound)if(null!=b&&null!=this._spriteSounds.get(b))this._spriteSounds.get(b).mute(a);else for(var c=this._spriteSounds.iterator();c.hasNext();)c.next().mute(a);else null!=this._snd&&this._snd.mute(a)},toggleMute:function(a){if(this.isSpriteSound)if(null!=a&&null!=this._spriteSounds.get(a))this._spriteSounds.get(a).toggleMute();else for(a=this._spriteSounds.iterator();a.hasNext();)a.next().toggleMute();else null!=this._snd&&
this._snd.toggleMute()},load:function(a){if(null==this._snd||this.isSpriteSound)return null;this._snd.load(a);return this},isReady:function(){if(this.isSpriteSound)for(var a=this._spriteSounds.iterator();a.hasNext();)return a.next().isReady();return this._snd.isReady()},play:function(a,b){if(this.isSpriteSound)if(null!=a){for(var c=0,d=this._spriteData.sprite;c<d.length;){var e=d[c];++c;if(e.name==a){b=e;break}}if(null==b)return null;if(null!=this._spriteSounds.get(a))return this._spriteSounds.get(a).stop(),
this._spriteSounds.get(a).play(a,b)}else return null;return null==this._snd?null:this._snd.play(a,b)},togglePlay:function(a){this.isSpriteSound?null!=a&&null!=this._spriteSounds.get(a)&&this._spriteSounds.get(a).togglePlay():null!=this._snd&&this._snd.togglePlay()},isPlaying:function(a){return this.isSpriteSound?null!=a&&null!=this._spriteSounds.get(a)?this._spriteSounds.get(a).isPlaying():!1:null==this._snd?!1:this._snd.isPlaying()},loop:function(a){null==this._snd||this.isSpriteSound||this._snd.loop(a)},
autoStop:function(a){null!=this._snd&&this._snd.autoStop(a)},stop:function(a){if(this.isSpriteSound)if(null!=a&&null!=this._spriteSounds.get(a))this._spriteSounds.get(a).stop();else for(a=this._spriteSounds.iterator();a.hasNext();)a.next().stop();else null!=this._snd&&this._snd.stop()},pause:function(a){if(this.isSpriteSound)if(null!=a&&null!=this._spriteSounds.get(a))this._spriteSounds.get(a).pause();else for(a=this._spriteSounds.iterator();a.hasNext();)a.next().pause();else null!=this._snd&&this._snd.pause()},
playbackRate:function(a,b){if(null!=a){if(this.isSpriteSound)if(null!=b&&null!=this._spriteSounds.get(b))this._spriteSounds.get(b).playbackRate(a);else for(var c=this._spriteSounds.iterator();c.hasNext();)c.next().playbackRate(a);else null!=this._snd&&this._snd.playbackRate(a);return this.rate=a}return this.rate},setTime:function(a){null==this._snd||this.isSpriteSound||this._snd.setTime(a)},getTime:function(){return null==this._snd||this.isSpriteSound?0:this._snd.getTime()},onEnd:function(a,b){return this.isSpriteSound?
(null!=b&&this._spriteSoundEndCallbacks.set(b,a),this):null!=this._snd?(this._snd.onEnd(a),this):null},onLoad:function(a){if(null==this._snd||this.isSpriteSound)return null;this._snd.onLoad(a);return this},onError:function(a){if(null==this._snd||this.isSpriteSound)return null;this._snd.onError(a);return this},destroy:function(){if(this.isSpriteSound)for(var a=this._spriteSounds.iterator();a.hasNext();)a.next().destroy();else null!=this._snd&&(this._snd.destroy(),this._snd=null)},_loadSpriteSound:function(b){var c=
new XMLHttpRequest;c.open("GET",b,!0);c.responseType="arraybuffer";c.onload=a(this,this._onSpriteSoundLoaded);c.onerror=a(this,this._onSpriteSoundError);c.send()},_onSpriteSoundLoaded:function(b){g.audioManager.audioContext.decodeAudioData(b.target.response,a(this,this._decodeSuccess),a(this,this._onSpriteSoundError))},_onSpriteSoundError:function(){if(null!=this._options&&null!=this._options.onerror)this._options.onerror(this)},_decodeSuccess:function(b){if(null==b)this._onSpriteSoundError();else{g.audioManager.bufferList.set(this.url,
b);this._spriteDuration=b.duration;if(null!=this._options&&null!=this._options.onload)this._options.onload(this);for(var c=0,d=this._spriteData.sprite;c<d.length;){var e=d[c];++c;var f=new u(this.url,this._options,!0,b.duration);f.isSpriteSound=!0;this._spriteSounds.set(e.name,f);f.onEnd(a(this,this._spriteOnEnd),e.name)}}},_spriteOnEnd:function(a){null!=this._spriteSoundEndCallbacks.get(a.spriteName)&&this._spriteSoundEndCallbacks.get(a.spriteName)(a)},__class__:t};var p=d.WaudUtils=function(){};
p.__name__=!0;p.isAndroid=function(a){null==a&&(a=window.navigator.userAgent);return(new l("Android","i")).match(a)};p.isiOS=function(a){null==a&&(a=window.navigator.userAgent);return(new l("(iPad|iPhone|iPod)","i")).match(a)};p.isWindowsPhone=function(a){null==a&&(a=window.navigator.userAgent);return(new l("(IEMobile|Windows Phone)","i")).match(a)};p.isFirefox=function(a){null==a&&(a=window.navigator.userAgent);return(new l("Firefox","i")).match(a)};p.isOpera=function(a){null==a&&(a=window.navigator.userAgent);
return(new l("Opera","i")).match(a)||null!=m.field(window,"opera")};p.isChrome=function(a){null==a&&(a=window.navigator.userAgent);return(new l("Chrome","i")).match(a)};p.isSafari=function(a){null==a&&(a=window.navigator.userAgent);return(new l("Safari","i")).match(a)};p.isMobile=function(a){null==a&&(a=window.navigator.userAgent);return(new l("(iPad|iPhone|iPod|Android|webOS|BlackBerry|Windows Phone|IEMobile)","i")).match(a)};p.getiOSVersion=function(a){null==a&&(a=window.navigator.userAgent);var b=
new l("[0-9_]+?[0-9_]+?[0-9_]+","i"),c=[];if(b.match(a)){a=b.matched(0).split("_");b=[];for(c=0;c<a.length;){var d=a[c];++c;b.push(w.parseInt(d))}c=b}return c};p.setDefaultOptions=function(a){null==a&&(a={});a.autoplay=null!=a.autoplay?a.autoplay:g.defaults.autoplay;a.autostop=null!=a.autostop?a.autostop:g.defaults.autostop;a.webaudio=null!=a.webaudio?a.webaudio:g.defaults.webaudio;a.preload=null!=a.preload?a.preload:g.defaults.preload;a.loop=null!=a.loop?a.loop:g.defaults.loop;a.onload=null!=a.onload?
a.onload:g.defaults.onload;a.onend=null!=a.onend?a.onend:g.defaults.onend;a.onerror=null!=a.onerror?a.onerror:g.defaults.onerror;if(null==a.volume||0>a.volume||1<a.volume)a.volume=g.defaults.volume;if(null==a.playbackRate||0>=a.playbackRate||4<=a.playbackRate)a.playbackRate=g.defaults.playbackRate;return a};var u=function(a,b,c,d){null==d&&(d=0);null==c&&(c=!1);f.call(this,a,b);this._pauseTime=this._playStartTime=0;this._srcNodes=[];this._gainNodes=[];this._currentSoundProps=null;this._isLoaded=c;
this._duration=d;this._manager=g.audioManager;this._b64.match(a)?this._decodeAudio(this._base64ToArrayBuffer(a)):this._options.preload&&!c&&this.load()};u.__name__=!0;u.__interfaces__=[k];u.__super__=f;u.prototype=b(f.prototype,{load:function(b){if(!this._isLoaded){var c=new XMLHttpRequest;c.open("GET",this.url,!0);c.responseType="arraybuffer";c.onload=a(this,this._onSoundLoaded);c.onerror=a(this,this._error);c.send();null!=b&&(this._options.onload=b)}return this},_base64ToArrayBuffer:function(a){a=
window.atob(a.split(",")[1]);for(var b=a.length,c=new Uint8Array(new ArrayBuffer(b)),d=0;d<b;){var e=d++;c[e]=n.cca(a,e)}return c.buffer},_onSoundLoaded:function(b){this._manager.audioContext.decodeAudioData(b.target.response,a(this,this._decodeSuccess),a(this,this._error))},_decodeAudio:function(b){this._manager.audioContext.decodeAudioData(b,a(this,this._decodeSuccess),a(this,this._error))},_error:function(){if(null!=this._options.onerror)this._options.onerror(this)},_decodeSuccess:function(a){if(null==
a)h.log("empty buffer: "+this.url),this._error();else{this._manager.bufferList.set(this.url,a);this._isLoaded=!0;this._duration=a.duration;if(null!=this._options.onload)this._options.onload(this);this._options.autoplay&&this.play()}},_makeSource:function(a){var b=this._manager.audioContext.createBufferSource();b.buffer=a;this._gainNode=this._manager.createGain();b.connect(this._gainNode);b.playbackRate.value=this.rate;this._gainNode.connect(this._manager.masterGainNode);this._manager.masterGainNode.connect(this._manager.audioContext.destination);
this._srcNodes.push(b);this._gainNodes.push(this._gainNode);this._gainNode.gain.value=this._muted?0:this._options.volume;return b},getDuration:function(){return this._isLoaded?this._duration:0},play:function(a,b){var c=this;this.spriteName=a;this._isPlaying&&this._options.autostop&&this.stop(this.spriteName);if(!this._isLoaded)return h.log("sound not loaded"),-1;var d=0,e=-1;this.isSpriteSound&&null!=b&&(this._currentSoundProps=b,d=b.start+this._pauseTime,e=b.duration);var f;f=null!=this._manager.bufferList?
this._manager.bufferList.get(this.url):null;null!=f&&(this.source=this._makeSource(f),0<=d&&-1<e?this._start(0,d,e):(this._start(0,this._pauseTime,this.source.buffer.duration),this.source.loop=this._options.loop),this._playStartTime=this._manager.audioContext.currentTime,this._isPlaying=!0,this.source.onended=function(){c._pauseTime=0;c._isPlaying=!1;if(c.isSpriteSound&&null!=b&&null!=b.loop&&b.loop&&0<=d&&-1<e)c.destroy(),c.play(c.spriteName,b);else if(null!=c._options.onend)c._options.onend(c)});
return n.indexOf(this._srcNodes,this.source,0)},_start:function(a,b,c){null!=m.field(this.source,"start")?this.source.start(a,b,c):null!=m.field(this.source,"noteGrainOn")?m.callMethod(this.source,m.field(this.source,"noteGrainOn"),[a,b,c]):null!=m.field(this.source,"noteOn")&&m.callMethod(this.source,m.field(this.source,"noteOn"),[a,b,c])},togglePlay:function(a){this._isPlaying?this.pause():this.play()},isPlaying:function(a){return this._isPlaying},loop:function(a){this._options.loop=a;null!=this.source&&
(this.source.loop=a)},setVolume:function(a,b){this._options.volume=a;null!=this._gainNode&&this._isLoaded&&!this._muted&&(this._gainNode.gain.value=this._options.volume)},getVolume:function(a){return this._options.volume},mute:function(a,b){this._muted=a;null!=this._gainNode&&this._isLoaded&&(this._gainNode.gain.value=a?0:this._options.volume)},toggleMute:function(a){this.mute(!this._muted)},autoStop:function(a){this._options.autostop=a},stop:function(a){this._pauseTime=0;null!=this.source&&this._isLoaded&&
this._isPlaying&&this.destroy()},pause:function(a){null!=this.source&&this._isLoaded&&this._isPlaying&&(this.destroy(),this._pauseTime+=this._manager.audioContext.currentTime-this._playStartTime)},playbackRate:function(a,b){if(null==a)return this.rate;for(var c=0,d=this._srcNodes;c<d.length;){var e=d[c];++c;e.playbackRate.value=a}return this.rate=a},setTime:function(a){!this._isLoaded||a>this._duration||(this._isPlaying?(this.stop(),this._pauseTime=a,this.play()):this._pauseTime=a)},getTime:function(){return null!=
this.source&&this._isLoaded&&this._isPlaying?this._manager.audioContext.currentTime-this._playStartTime+this._pauseTime:0},onEnd:function(a,b){this._options.onend=a;return this},onLoad:function(a){this._options.onload=a;return this},onError:function(a){this._options.onerror=a;return this},destroy:function(){for(var a=0,b=this._srcNodes;a<b.length;){var c=b[a];++a;null!=m.field(c,"stop")?c.stop(0):null!=m.field(c,"noteOff")&&m.callMethod(c,m.field(c,"noteOff"),[0]);c.disconnect()}a=0;for(b=this._gainNodes;a<
b.length;)c=b[a],++a,c.disconnect();this._srcNodes=[];this._gainNodes=[];this._isPlaying=!1},__class__:u});d=function(){};d.__name__=!0;var r=function(a){var b=this;this.id=setInterval(function(){b.run()},a)};r.__name__=!0;r.delay=function(a,b){var c=new r(b);c.run=function(){c.stop();a()};return c};r.prototype={stop:function(){null!=this.id&&(clearInterval(this.id),this.id=null)},run:function(){},__class__:r};var B=function(a,b){this.map=a;this.keys=b;this.index=0;this.count=b.length};B.__name__=
!0;B.prototype={hasNext:function(){return this.index<this.count},next:function(){return this.map.get(this.keys[this.index++])},__class__:B};var y=function(){this.h={}};y.__name__=!0;y.__interfaces__=[d];y.prototype={set:function(a,b){null!=J[a]?this.setReserved(a,b):this.h[a]=b},get:function(a){return null!=J[a]?this.getReserved(a):this.h[a]},setReserved:function(a,b){null==this.rh&&(this.rh={});this.rh["$"+a]=b},getReserved:function(a){return null==this.rh?null:this.rh["$"+a]},arrayKeys:function(){var a=
[],b;for(b in this.h)this.h.hasOwnProperty(b)&&a.push(b);if(null!=this.rh)for(b in this.rh)36==b.charCodeAt(0)&&a.push(b.substr(1));return a},iterator:function(){return new B(this,this.arrayKeys())},__class__:y};var A=function(a){Error.call(this);this.val=a;this.message=String(a);Error.captureStackTrace&&Error.captureStackTrace(this,A)};A.__name__=!0;A.__super__=Error;A.prototype=b(Error.prototype,{__class__:A});var z=function(){};z.__name__=!0;z.getClass=function(a){if(a instanceof Array&&null==
a.__enum__)return Array;var b=a.__class__;if(null!=b)return b;a=z.__nativeClassName(a);return null!=a?z.__resolveNativeClass(a):null};z.__string_rec=function(a,b){if(null==a)return"null";if(5<=b.length)return"<...>";var c=typeof a;"function"==c&&(a.__name__||a.__ename__)&&(c="object");switch(c){case "object":if(a instanceof Array){if(a.__enum__){if(2==a.length)return a[0];c=a[0]+"(";b+="\t";for(var d=2,e=a.length;d<e;)var f=d++,c=2!=f?c+(","+z.__string_rec(a[f],b)):c+z.__string_rec(a[f],b);return c+
")"}c=a.length;d="[";b+="\t";for(e=0;e<c;)f=e++,d+=(0<f?",":"")+z.__string_rec(a[f],b);return d+"]"}try{d=a.toString}catch(g){return g instanceof A&&(g=g.val),"???"}if(null!=d&&d!=Object.toString&&"function"==typeof d&&(c=a.toString(),"[object Object]"!=c))return c;c=null;d="{\n";b+="\t";e=null!=a.hasOwnProperty;for(c in a)e&&!a.hasOwnProperty(c)||"prototype"==c||"__class__"==c||"__super__"==c||"__interfaces__"==c||"__properties__"==c||(2!=d.length&&(d+=", \n"),d+=b+c+" : "+z.__string_rec(a[c],b));
b=b.substring(1);return d+("\n"+b+"}");case "function":return"<function>";case "string":return a;default:return String(a)}};z.__interfLoop=function(a,b){if(null==a)return!1;if(a==b)return!0;var c=a.__interfaces__;if(null!=c)for(var d=0,e=c.length;d<e;){var f=d++,f=c[f];if(f==b||z.__interfLoop(f,b))return!0}return z.__interfLoop(a.__super__,b)};z.__instanceof=function(a,b){if(null==b)return!1;switch(b){case F:return(a|0)===a;case D:return"number"==typeof a;case I:return"boolean"==typeof a;case String:return"string"==
typeof a;case Array:return a instanceof Array&&null==a.__enum__;case G:return!0;default:if(null!=a)if("function"==typeof b){if(a instanceof b||z.__interfLoop(z.getClass(a),b))return!0}else{if("object"==typeof b&&z.__isNativeObj(b)&&a instanceof b)return!0}else return!1;return b==H&&null!=a.__name__||b==K&&null!=a.__ename__?!0:a.__enum__==b}};z.__cast=function(a,b){if(z.__instanceof(a,b))return a;throw new A("Cannot cast "+w.string(a)+" to "+w.string(b));};z.__nativeClassName=function(a){a=z.__toStr.call(a).slice(8,
-1);return"Object"==a||"Function"==a||"Math"==a||"JSON"==a?null:a};z.__isNativeObj=function(a){return null!=z.__nativeClassName(a)};z.__resolveNativeClass=function(a){return c[a]};var C,E=0;Array.prototype.indexOf&&(n.indexOf=function(a,b,c){return Array.prototype.indexOf.call(a,b,c)});String.prototype.__class__=String;String.__name__=!0;Array.__name__=!0;Date.prototype.__class__=Date;Date.__name__=["Date"];var F={__name__:["Int"]},G={__name__:["Dynamic"]},D=Number;D.__name__=["Float"];var I=Boolean;
I.__ename__=["Bool"];var H={__name__:["Class"]},K={},J={};g.PROBABLY="probably";g.MAYBE="maybe";g.version="0.9.5";g.useWebAudio=!0;g.defaults={autoplay:!1,autostop:!0,loop:!1,preload:!0,webaudio:!0,volume:1,playbackRate:1};g.preferredSampleRate=44100;g.isMuted=!1;g._playbackRate=1;v.FOCUS_STATE="focus";v.BLUR_STATE="blur";v.ON_FOCUS="onfocus";v.ON_BLUR="onblur";v.PAGE_SHOW="pageshow";v.PAGE_HIDE="pagehide";v.WINDOW="window";v.DOCUMENT="document";z.__toStr={}.toString})("undefined"!=typeof console?
console:{log:function(){}},"undefined"!=typeof window?window:exports,"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this);function unlockSound(){window.removeEventListener("touchend",unlockSound,!1);var h=new AudioContext,d=h.createBuffer(1,1,22050),c=h.createBufferSource();c.buffer=d;c.connect(h.destination);c.noteOn&&c.noteOn(0)}window.addEventListener("touchend",unlockSound,!1);var base;
(function(h){var d=function(){function c(b,a,c){void 0===b&&(b=0);void 0===a&&(a=0);void 0===c&&(c=0);this.position=new h.Vec2(b,a);this.radius=c}c.prototype.isPointInside=function(b){return this.isPointInsideXY(b.x,b.y)};c.prototype.isPointInsideXY=function(b,a){var c=this.position.x-b,d=this.position.y-a;return Math.sqrt(c*c+d*d)<this.radius};c.prototype.intersects=function(b){var a=this.position.x-b.position.x,c=this.position.y-b.position.y;return Math.sqrt(a*a+c*c)<this.radius+b.radius};return c}();
h.Circle=d})(base||(base={}));
(function(h){var d=function(){function c(b,a,c,d){void 0===b&&(b=0);void 0===a&&(a=0);void 0===c&&(c=0);void 0===d&&(d=0);this.position=new h.Vec2(b,a);this.size=new h.Vec2(c,d)}c.prototype.isPointInside=function(b){return this.isPointInsideXY(b.x,b.y)};c.prototype.isPointInsideXY=function(b,a){var c=this.position.x,d=c+this.size.x,l=this.position.y,k=l+this.size.y;if(c>d)var h=c,c=d,d=h;l>k&&(h=l,l=k,k=h);return b>=c&&b<d&&a>=l&&a<k};c.prototype.intersectsRect=function(b){var a=this.position.x,c=
a+this.size.x,d=this.position.y,l=d+this.size.y;if(a>c)var k=a,a=c,c=k;d>l&&(k=d,d=l,l=k);var h=b.position.x,n=b.position.y,m=h+b.size.x;b=n+b.size.y;h>m&&(k=h,h=m,m=k);n>b&&(k=n,n=b,b=k);return!(a>m||c<h)&&!(d>b||l<n)};c.prototype.getRandomPoint=function(){var b=new h.Vec2;b.x=this.position.x+Math.random()*this.size.x;b.y=this.position.y+Math.random()*this.size.y;return b};c.prototype.confine=function(b){var a=this.confineX(b);return this.confineY(b)||a};c.prototype.confineX=function(b){var a=b.position.x;
b.position.x=h.clamp(a,this.position.x,this.position.x+this.size.x-b.size.x);return a!=b.position.x};c.prototype.confineY=function(b){var a=b.position.y;b.position.y=h.clamp(a,this.position.y,this.position.y+this.size.y-b.size.y);return a!=b.position.y};return c}();h.Rect=d})(base||(base={}));
(function(h){var d=function(){function c(b){void 0===b&&(b=65536);this._size=b;this._data=new Float64Array(b);this._position=0;this.init()}c.prototype.init=function(){for(var b=0;b<this._size;++b)this._data[b]=Math.random();return this};c.prototype.next=function(){var b=this._position,a=this._data[b];this._data[b]=1-a;this._position=(b+1)%this._size;return a};c.prototype.nextInRange=function(b,a){var c=a-b,d=this.next();return b+d*c};return c}();h.Random=d})(base||(base={}));
(function(h){var d=function(){function c(b,a){void 0===b&&(b=0);void 0===a&&(a=0);this.x=b;this.y=a}c.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y)};c.prototype.normalize=function(){var b=1/this.length();this.x*=b;this.y*=b;return this};c.prototype.invert=function(){this.x=-this.x;this.y=-this.y;return this};c.prototype.invertX=function(){this.x=-this.x;return this};c.prototype.invertY=function(){this.y=-this.y;return this};c.prototype.set=function(b){this.x=b.x;this.y=
b.y;return this};c.prototype.setXY=function(b,a){this.x=b;this.y=a;return this};c.prototype.clamp=function(b,a){return this.clampXY(b.x,a.x,b.y,a.y)};c.prototype.clampX=function(b,a){this.x<b&&(this.x=b);this.x>a&&(this.x=a);return this};c.prototype.clampY=function(b,a){this.y<b&&(this.y=b);this.y>a&&(this.y=a);return this};c.prototype.clampXY=function(b,a,c,d){this.clampX(b,a);this.clampY(c,d);return this};c.prototype.add=function(b){this.x+=b.x;this.y+=b.y;return this};c.prototype.addXY=function(b,
a){this.x+=b;this.y+=a;return this};c.prototype.subtract=function(b){this.x-=b.x;this.y-=b.y;return this};c.prototype.subtractXY=function(b,a){this.x-=b;this.y-=a;return this};c.prototype.multiply=function(b){this.x*=b.x;this.y*=b.y;return this};c.prototype.multiplyXY=function(b,a){void 0===a&&(a=b);this.x*=b;this.y*=a;return this};c.ZERO=new c(0,0);return c}();h.Vec2=d})(base||(base={}));
(function(h){var d=function(){function c(b,a,c,d,l,k){void 0===b&&(b=1);void 0===a&&(a=0);void 0===c&&(c=0);void 0===d&&(d=1);void 0===l&&(l=0);void 0===k&&(k=0);this.a=b;this.b=a;this.c=c;this.d=d;this.tx=l;this.ty=k}c.prototype.set=function(b){this.a=b.a;this.b=b.b;this.c=b.c;this.d=b.d;this.tx=b.tx;this.ty=b.ty;return this};c.prototype.clone=function(){return new c(this.a,this.b,this.c,this.d,this.tx,this.ty)};c.prototype.prepend=function(b){var a=b.b*this.a+b.d*this.b,c=b.a*this.c+b.c*this.d,
d=b.b*this.c+b.d*this.d,l=b.a*this.tx+b.c*this.ty+b.tx,k=b.b*this.tx+b.d*this.ty+b.ty;this.a=b.a*this.a+b.c*this.b;this.b=a;this.c=c;this.d=d;this.tx=l;this.ty=k;return this};c.prototype.multiply=function(b){var a=this.b*b.a+this.d*b.b,c=this.a*b.c+this.c*b.d,d=this.b*b.c+this.d*b.d,l=this.a*b.tx+this.c*b.ty+this.tx,k=this.b*b.tx+this.d*b.ty+this.ty;this.a=this.a*b.a+this.c*b.b;this.b=a;this.c=c;this.d=d;this.tx=l;this.ty=k;return this};c.prototype.scale=function(b){return this.scaleXY(b.x,b.y)};
c.prototype.scaleXY=function(b,a){this.a*=b;this.b*=b;this.c*=a;this.d*=a;return this};c.prototype.rotate=function(b){var a=Math.cos(b);b=Math.sin(b);var c=this.a,d=this.b,l=this.c,k=this.d;this.a=c*a-l*b;this.b=d*a-k*b;this.c=c*b+l*a;this.d=d*b+k*a;return this};c.prototype.translate=function(b){return this.translateXY(b.x,b.y)};c.prototype.translateXY=function(b,a){var c=this.ty+this.b*b+this.d*a;this.tx=this.tx+this.a*b+this.c*a;this.ty=c;return this};c.prototype.identity=function(){this.a=1;this.c=
this.b=0;this.d=1;this.ty=this.tx=0;return this};c.prototype.determinant=function(){var b=this.c,a=this.d,c=this.tx,d=this.ty;return+this.a*(1*a-0*d)-this.b*(1*b-0*c)+0*(b*d-a*c)};c.prototype.normalize=function(){var b=1/Math.sqrt(this.a*this.a+this.b*this.b),a=1/Math.sqrt(this.c*this.c+this.d*this.d),c=1/Math.sqrt(this.tx*this.tx+this.ty*this.ty);this.a*=b;this.b*=b;this.c*=a;this.d*=a;this.tx*=c;this.ty*=c;return this};c.prototype.invert=function(){var b=this.a,a=this.b,c=this.c,d=this.d,l=this.tx,
k=this.ty,h=1/(b*d-a*c);this.a=d*h;this.b=-a*h;this.c=-c*h;this.d=b*h;this.tx=(c*k-d*l)*h;this.ty=-(b*k-a*l)*h;return this};c.prototype.projectXY=function(b,a,c){void 0===c&&(c=new h.Vec2);c.x=b*this.a+a*this.c+this.tx;c.y=b*this.b+a*this.d+this.ty;return c};c.prototype.project=function(b,a){void 0===a&&(a=new h.Vec2);var c=b.x*this.b+b.y*this.d+this.ty;a.x=b.x*this.a+b.y*this.c+this.tx;a.y=c;return a};c.prototype.equals=function(b){return this.a===b.a&&this.b===b.b&&this.c===b.c&&this.d===b.d&&this.tx===
b.tx&&this.ty===b.ty};c.prototype.buildNodeMatrix=function(b,a,c,d){var l=Math.cos(d),k=Math.sin(d);d=a.x*l;c=-(a.y*k);k*=a.x;a=a.y*l;l=b.x+(0*d+0*k);b=b.y+(0*c+0*a);this.a=d;this.b=c;this.c=k;this.d=a;this.tx=l;this.ty=b;return this};c.IDENTITY=new c;return c}();h.Matrix=d})(base||(base={}));
(function(h){h.Easing={Linear:{None:function(d){return d}},Quadratic:{In:function(d){return d*d},Out:function(d){return d*(2-d)},InOut:function(d){return 1>(d*=2)?.5*d*d:-.5*(--d*(d-2)-1)}},Cubic:{In:function(d){return d*d*d},Out:function(d){return--d*d*d+1},InOut:function(d){return 1>(d*=2)?.5*d*d*d:.5*((d-=2)*d*d+2)}},Quartic:{In:function(d){return d*d*d*d},Out:function(d){return 1- --d*d*d*d},InOut:function(d){return 1>(d*=2)?.5*d*d*d*d:-.5*((d-=2)*d*d*d-2)}},Quintic:{In:function(d){return d*d*
d*d*d},Out:function(d){return--d*d*d*d*d+1},InOut:function(d){return 1>(d*=2)?.5*d*d*d*d*d:.5*((d-=2)*d*d*d*d+2)}},Sinusoidal:{In:function(d){return 1-Math.cos(d*Math.PI/2)},Out:function(d){return Math.sin(d*Math.PI/2)},InOut:function(d){return.5*(1-Math.cos(Math.PI*d))}},Exponential:{In:function(d){return 0===d?0:Math.pow(1024,d-1)},Out:function(d){return 1===d?1:1-Math.pow(2,-10*d)},InOut:function(d){return 0===d?0:1===d?1:1>(d*=2)?.5*Math.pow(1024,d-1):.5*(-Math.pow(2,-10*(d-1))+2)}},Circular:{In:function(d){return 1-
Math.sqrt(1-d*d)},Out:function(d){return Math.sqrt(1- --d*d)},InOut:function(d){return 1>(d*=2)?-.5*(Math.sqrt(1-d*d)-1):.5*(Math.sqrt(1-(d-=2)*d)+1)}},Elastic:{In:function(d){return 0===d?0:1===d?1:-Math.pow(2,10*(d-1))*Math.sin(5*(d-1.1)*Math.PI)},Out:function(d){return 0===d?0:1===d?1:Math.pow(2,-10*d)*Math.sin(5*(d-.1)*Math.PI)+1},InOut:function(d){if(0===d)return 0;if(1===d)return 1;d*=2;return 1>d?-.5*Math.pow(2,10*(d-1))*Math.sin(5*(d-1.1)*Math.PI):.5*Math.pow(2,-10*(d-1))*Math.sin(5*(d-1.1)*
Math.PI)+1}},Back:{In:function(d){return d*d*(2.70158*d-1.70158)},Out:function(d){return--d*d*(2.70158*d+1.70158)+1},InOut:function(d){return 1>(d*=2)?.5*d*d*(3.5949095*d-2.5949095):.5*((d-=2)*d*(3.5949095*d+2.5949095)+2)}},Bounce:{In:function(d){return 1-h.Easing.Bounce.Out(1-d)},Out:function(d){return d<1/2.75?7.5625*d*d:d<2/2.75?7.5625*(d-=1.5/2.75)*d+.75:d<2.5/2.75?7.5625*(d-=2.25/2.75)*d+.9375:7.5625*(d-=2.625/2.75)*d+.984375},InOut:function(d){return.5>d?.5*h.Easing.Bounce.In(2*d):.5*h.Easing.Bounce.Out(2*
d-1)+.5}}}})(base||(base={}));(function(h){h.lerp=function(d,c,b){return(b-c)*d+c};h.parabola=function(d,c,b){b-=c;d-=.5;return-4*b*d*d+b+c}})(base||(base={}));
(function(h){h.sign=function(d){return 0==d?0:0>d?-1:1};h.sineWave=function(d,c,b,a){void 0===a&&(a=h.getTimeCurrent());c=.5*(c-d);return Math.sin(.002*a*Math.PI*b)*c+c+d};h.toZero=function(d,c){return 0>Math.abs(d)-c?0:0<d?d-c:d+c};h.clamp=function(d,c,b){return d<c?c:d>b?b:d};h.wrap=function(d,c,b){if(c==b)return c;d-=c;b-=c;d-=(d/b|0)*b;return c+d+(0>d?b:0)};h.toRadian=function(d){return.01745329251994329*d};h.toDegree=function(d){return 57.29577951308329*d}})(base||(base={}));
(function(h){(function(c){c[c.LEFT=37]="LEFT";c[c.RIGHT=39]="RIGHT";c[c.UP=38]="UP";c[c.DOWN=40]="DOWN";c[c.SPACE=32]="SPACE";c[c.SHIFT=16]="SHIFT";c[c.CTRL=17]="CTRL";c[c.ENTER=13]="ENTER";c[c.ESC=27]="ESC";c[c.A=65]="A";c[c.B=66]="B";c[c.C=67]="C";c[c.D=68]="D";c[c.E=69]="E";c[c.F=70]="F";c[c.G=71]="G";c[c.H=72]="H";c[c.I=73]="I";c[c.J=74]="J";c[c.K=75]="K";c[c.L=76]="L";c[c.M=77]="M";c[c.N=78]="N";c[c.O=79]="O";c[c.P=80]="P";c[c.Q=81]="Q";c[c.R=82]="R";c[c.S=83]="S";c[c.T=84]="T";c[c.U=85]="U";
c[c.V=86]="V";c[c.W=87]="W";c[c.X=88]="X";c[c.Y=89]="Y";c[c.Z=90]="Z"})(h.Keys||(h.Keys={}));var d=function(){function c(){this._actual=[];this._current=[];this._last=[];this._nativeHandlers=[];for(var b=0;386>b;++b)this._actual[b]=!1,this._current[b]=!1,this._last[b]=!1}c.prototype.addNativeHandler=function(b){this._nativeHandlers.push(b)};c.prototype._executeNativeHandlers=function(b){for(var a=0;a<this._nativeHandlers.length;++a)this._nativeHandlers[a].call(null,b)};c.prototype.keyDown=function(b){this._actual[b]=
!0};c.prototype.keyUp=function(b){this._actual[b]=!1};c.prototype.isKeyDown=function(b){return this._current[b]};c.prototype.isKeyPressed=function(b){return this._current[b]&&!this._last[b]};c.prototype.isKeyReleased=function(b){return!this._current[b]&&this._last[b]};c.prototype.isKeyHeld=function(b){return this._current[b]&&this._last[b]};c.prototype.update=function(){for(var b=0;386>b;++b)this._last[b]=this._current[b],this._current[b]=this._actual[b]};return c}();h.Keyboard=d})(base||(base={}));
(function(h){var d;(function(b){b[b.LEFT=0]="LEFT";b[b.MIDDLE=1]="MIDDLE";b[b.RIGHT=2]="RIGHT";b[b.WHEEL_UP=4]="WHEEL_UP";b[b.WHEEL_DOWN=5]="WHEEL_DOWN"})(d=h.MouseButton||(h.MouseButton={}));var c=function(){function b(){this._position_actual=new h.Vec2;this._position_current=new h.Vec2;this._position_last=new h.Vec2;this._position_delta=new h.Vec2;this._buttons_actual=[];this._buttons_current=[];this._buttons_last=[];for(var a=0;6>a;++a)this._buttons_actual[a]=!1,this._buttons_current[a]=!1,this._buttons_last[a]=
!1}b.prototype.mouseMoved=function(a,b){this._position_actual.x=a;this._position_actual.y=b};b.prototype.buttonDown=function(a){this._buttons_actual[a]=!0};b.prototype.buttonUp=function(a){this._buttons_actual[a]=!1};b.prototype.getX=function(){return this._position_current.x};b.prototype.getY=function(){return this._position_current.y};b.prototype.getPosition=function(){return this._position_current};b.prototype.getLastX=function(){return this._position_last.x};b.prototype.getLastY=function(){return this._position_last.y};
b.prototype.getLastPosition=function(){return this._position_last};b.prototype.getDeltaX=function(){return this._position_delta.x};b.prototype.getDeltaY=function(){return this._position_delta.y};b.prototype.getDelta=function(){return this._position_delta};b.prototype.isButtonDown=function(a){return this._buttons_current[a]};b.prototype.isButtonPressed=function(a){return this._buttons_current[a]&&!this._buttons_last[a]};b.prototype.isButtonReleased=function(a){return!this._buttons_current[a]&&this._buttons_last[a]};
b.prototype.isButtonHeld=function(a){return this._buttons_current[a]&&this._buttons_last[a]};b.prototype.update=function(){this._position_last.set(this._position_current);this._position_current.set(this._position_actual);this._position_delta.set(this._position_current).subtract(this._position_last);for(var a=0;6>a;++a)this._buttons_last[a]=this._buttons_current[a],this._buttons_current[a]=this._buttons_actual[a];this._buttons_actual[d.WHEEL_UP]=!1;this._buttons_actual[d.WHEEL_DOWN]=!1};return b}();
h.Mouse=c})(base||(base={}));
(function(h){var d=function(){function c(){this._position_act=new h.Vec2;this._position_cur=new h.Vec2;this._position_last=new h.Vec2;this._delta=new h.Vec2;this._tm_last_touch=0;this._down=this._tapped=this._tapped_act=!1}c.prototype.getPosition=function(){return this._position_cur};c.prototype.getPositionLast=function(){return this._position_last};c.prototype.getDelta=function(){return this._delta};c.prototype.getDeltaX=function(){return this._delta.x};c.prototype.getDeltaY=function(){return this._delta.y};
c.prototype.isDown=function(){return this._down};c.prototype.isTapped=function(){return this._tapped};c.prototype.update=function(){this._position_last.set(this._position_cur);this._position_cur.set(this._position_act);this._delta.set(this._position_cur);this._delta.subtract(this._position_last);this._tapped=this._tapped_act;this._tapped_act=!1};c.prototype.updateTouchPosition=function(b,a){this._position_act.setXY(b,a)};c.prototype.touchStart=function(){this._position_cur.set(this._position_act);
this._position_last.set(this._position_cur);this._tm_last_touch=h.getTimeCurrent();this._tapped_act=!1;this._down=!0};c.prototype.touchEnd=function(){this._tapped_act=500>h.getTimeCurrent()-this._tm_last_touch;this._down=!1};return c}();h.Touch=d})(base||(base={}));
(function(h){var d=function(){return function(){}}(),c=function(){function b(){this.onComplete=function(){};this.onProgress=function(){};this.onError=function(){};this._failed=!1;this._images={};this._sounds={};this._musics={};this._fonts={};this._queue=[];this._loadedItems=this._queueSizeTotal=0}b.prototype.hasFailed=function(){return this._failed};b.prototype.getImage=function(a){var b=this._images[a];return b?b:(window.alert('Error: Loader does not contain image named "'+a+'"'),null)};b.prototype.getSound=
function(a){var b=this._sounds[a];return b?new h.Sound(b.url):(window.alert('Error: Loader does not contain sound named "'+a+'"'),null)};b.prototype.getMusic=function(a){var b=this._musics[a];return b?b:(window.alert('Error: Loader does not contain music named "'+a+'"'),null)};b.prototype.getFont=function(a){var b=this._fonts[a];return b?b:(window.alert('Error: Loader does not contain font named "'+a+'"'),null)};b.prototype.queueImage=function(a,b){var c=this,l=new d,k=document.createElement("img");
k.onload=function(){c.itemComplete(l)};k.onerror=function(){c.itemFailed(l)};l.resource=k;l.type="image";l.id=a;l.url=b;this.queueItem(l);k.src=b};b.prototype.queueSound=function(a,b){var c=this,l=new d,k=new WaudSound(b,{onload:function(a){c.itemComplete(l)},onerror:function(a){c.itemFailed(l)},preload:!1,volume:1,loop:!1,autoplay:!1});l.resource=k;l.type="sound";l.id=a;l.url=b;this.queueItem(l);k.load()};b.prototype.queueMusic=function(a,b){var c=this,l=new d,k=new WaudSound(b,{onload:function(a){c.itemComplete(l)},
onerror:function(a){c.itemFailed(l)},preload:!1,volume:1,loop:!0,autoplay:!1});l.resource=k;l.type="music";l.id=a;l.url=b;this.queueItem(l);k.load()};b.prototype.queueFont=function(a,b,c){var l=this,k=new d,h={data:null,image:document.createElement("img"),imageloaded:!1};k.resource=h;k.type="font";k.url=b;k.id=a;this.queueItem(k);h.image.onload=function(){h.imageloaded=!0;null!=h.data&&l.itemComplete(k)};h.image.src=c;var n=new XMLHttpRequest;n.onerror=function(){return l.itemFailed(k)};n.onload=
function(a){h.data=n.responseXML;h.imageloaded&&l.itemComplete(k)};n.open("GET",b,!0);n.send()};b.prototype.queueItem=function(a){this._queue.push(a);this._queueSizeTotal++};b.prototype.dequeueItem=function(a){var b=this._queue.indexOf(a);0<=b?this._queue.splice(b,1):console.error("Did not find item "+a+" in queue!");this._loadedItems++};b.prototype.itemComplete=function(a){this.dequeueItem(a);var b="["+this._loadedItems+"/"+this._queueSizeTotal+"] ";switch(a.type){case "image":this._images[a.id]=
new h.Image(a.resource);a.resource.onload=void 0;a.resource.onerror=void 0;b+="Image "+a.url+' loaded with id "'+a.id+'"';break;case "sound":this._sounds[a.id]={snd:a.resource,url:a.url};b+="Sound "+a.url+' loaded with id "'+a.id+'"';break;case "music":this._musics[a.id]=new h.Music(a.resource);b+="Music "+a.url+' loaded with id "'+a.id+'"';break;case "font":(this._fonts[a.id]=new h.Font(new h.Image(a.resource.image))).initFromXML(a.resource.data);b+="Font "+a.url+' loaded with id "'+a.id+'"';break;
default:b+="ERROR: failed to determine type of item "+a}this.onProgress(b);0==this._queue.length&&this.loadComplete()};b.prototype.itemFailed=function(a){this._failed=!0;this.dequeueItem(a);var b="["+this._loadedItems+"/"+this._queueSizeTotal+"] ";switch(a.type){case "image":a.resource.onload=void 0;a.resource.onerror=void 0;b+="Image "+a.url+" load FAILED";break;case "sound":b+="Sound "+a.url+" load FAILED";break;case "music":b+="Music "+a.url+" load FAILED";break;case "font":b+="Font "+a.url+" load FAILED";
break;default:b+="ERROR: failed to determine type of item "+a}this.onError(b)};b.prototype.loadComplete=function(){console.log("Load complete");this.onComplete()};b.prototype.load=function(a){if(0===a.size())console.log("Load complete"),this.onComplete();else{this._failed=!1;var b=a.getImages(),c=a.getSounds(),d=a.getMusics();a=a.getFonts();for(var k=0,h=b.length;k<h;++k){var n=b[k];this.queueImage(n.id,n.url)}k=0;for(h=c.length;k<h;++k)n=c[k],this.queueSound(n.id,n.url);k=0;for(h=d.length;k<h;++k)n=
d[k],this.queueMusic(n.id,n.url);k=0;for(h=a.length;k<h;++k)b=a[k],this.queueFont(b.id,b.dataurl,b.imageurl)}};return b}();h.Loader=c})(base||(base={}));
(function(h){var d=function(){function c(){this._images=[];this._sounds=[];this._musics=[];this._fonts=[];this._fontBaseUrl=this._soundBaseUrl=this._musicBaseUrl=this._imageBaseUrl=""}c.prototype.size=function(){return this._images.length+this._sounds.length+this._musics.length+this._fonts.length};c.prototype.setImageBaseURL=function(b){this._imageBaseUrl=null==b?"":b;return this};c.prototype.setSoundBaseURL=function(b){this._soundBaseUrl=null==b?"":b;return this};c.prototype.setMusicBaseURL=function(b){this._musicBaseUrl=
null==b?"":b;return this};c.prototype.setFontBaseUrl=function(b){this._fontBaseUrl=null==b?"":b;return this};c.prototype.addImage=function(b,a){this._images.push({id:b,url:this._imageBaseUrl+a});return this};c.prototype.addSound=function(b,a){this._sounds.push({id:b,url:this._soundBaseUrl+a});return this};c.prototype.addMusic=function(b,a){this._musics.push({id:b,url:this._musicBaseUrl+a});return this};c.prototype.addFont=function(b,a,c){a=this._fontBaseUrl+a;c=this._fontBaseUrl+c;this._fonts.push({id:b,
dataurl:a,imageurl:c});return this};c.prototype.getImages=function(){return this._images};c.prototype.getSounds=function(){return this._sounds};c.prototype.getMusics=function(){return this._musics};c.prototype.getFonts=function(){return this._fonts};return c}();h.AssetList=d})(base||(base={}));
(function(h){var d=function(){function c(){this._data=[];this._iterator=this._items=0;this._locked=!1;this._addQueue=[];this._killQueue=[];this._clear=!1}c.prototype.add=function(b){0<=this._data.indexOf(b)||(this._locked?0>this._addQueue.indexOf(b)&&this._addQueue.push(b):(this._data.push(b),this._items++))};c.prototype.remove=function(b){this._locked?this._killQueue.push(b):(b=this._data.indexOf(b),0<=b&&(this._data.splice(b,1),this._items--))};c.prototype.forEach=function(b){this._locked=!0;for(this._iterator=
0;this._iterator<this._items;++this._iterator)b(this._data[this._iterator]);for(this._locked=!1;this._killQueue.length;)b=this._killQueue.pop(),b=this._data.indexOf(b),0<=b&&(this._data.splice(b,1),this._items--);for(;this._addQueue.length;)this._data.push(this._addQueue.shift()),this._items++;this._clear&&this.clear()};c.prototype.clear=function(){if(this._locked)this._clear=!0;else{for(;this._data.length;)this._data.pop();this._items=0}};return c}();h.SafeList=d})(base||(base={}));
(function(h){var d=function(){function c(b){void 0===b&&(b=16);this._data=[];for(var a=0;a<b;++a)this._data[a]=null;this._size=b;this._pos=this._items=0}c.prototype.size=function(){return this._items};c.prototype.add=function(b){this._data[(this._pos+this._items)%this._size]=b;this._items==this._size-1?this._pos=(this._pos+1)%this._size:this._items++};c.prototype.clear=function(){for(var b=0;b<this._size;++b)this._data[b]=null;this._pos=this._items=0};c.prototype.get=function(b){return this._data[(this._pos+
b%this._items)%this._size]};return c}();h.Ringbuffer=d})(base||(base={}));
(function(h){var d=function(){function c(b,a,c){void 0===b&&(b=16);void 0===a&&(a=function(){return{}});void 0===c&&(c=function(){});this._data=[];this._size=Math.max(4,b)|0;this._items=0;this._fn_create=a;this._fn_init=c;for(b=0;b<this._size;++b)this._data[b]=a()}c.prototype.getNext=function(){if(this._items==this._size){var b=Math.max(2,this._size>>1)|0;for(this._size+=b;b--;)this._data.push(this._fn_create())}b=this._data[this._items++];this._fn_init(b);return b};c.prototype.get=function(b){return b>
this._items||0>b?null:this._data[b]};c.prototype.size=function(){return this._items};c.prototype.clear=function(){this._items=0};return c}();h.StaticList=d})(base||(base={}));
(function(h){var d=function(){function c(b,a){void 0===b&&(b=256);this._free=[];this._used=[];this._total=b;this._numUsed=0;this._numFree=b;for(var c=0;c<b;++c)this._free[c]=a(),this._used[c]=null}c.prototype.alloc=function(){var b=null;0<this._numFree?(this._newestUsed=this._numUsed,b=this._used[this._numUsed++]=this._free[--this._numFree],this._free[this._numFree]=null):(b=this._used.shift(),this._used.push(b));return b};c.prototype.free=function(b){b=this._used.indexOf(b);if(0<=b){var a=this._used[b];
this._used.splice(b,1);this._numUsed--;this._free[this._numFree++]=a}};c.prototype.getTotalCount=function(){return this._total};c.prototype.getFreeCount=function(){return this._numFree};c.prototype.getUsedCount=function(){return this._numUsed};c.prototype.getUsed=function(b){return this._used[b]};return c}();h.Pool=d})(base||(base={}));
(function(h){var d=function(){function c(b,a){void 0===a&&(a=30);this._callback=b;this._interval=a;this._elapsed=0}c.prototype.getInterval=function(){return this._interval};c.prototype.setInterval=function(b){this._interval=Math.max(1,b);return this};c.prototype.reset=function(){this._elapsed=0;return this};c.prototype.start=function(){h.addTimer(this);return this};c.prototype.stop=function(){h.removeTimer(this);return this};c.prototype.update=function(b){for(b=this._elapsed-b;b>this._interval;)this._callback(),
b-=this._interval;this._elapsed=b;return this};return c}();h.Timer=d})(base||(base={}));
(function(h){var d=function(){function c(b,a,c,d){void 0===d&&(d=function(){});this._duration=b;this._elapsed=0;this._ease=a;this._onProgress=c;this._onComplete=d}c.prototype.start=function(){this._elapsed=0;this._onProgress(this._ease(this._elapsed/this._duration));h.addTween(this)};c.prototype.stop=function(){h.removeTween(this)};c.prototype.cancel=function(){h.removeTween(this);this._onProgress(this._ease(0));this._elapsed=0};c.prototype.update=function(b){b=this._elapsed+b;b>this._duration?(this._onProgress(this._ease(1)),
this._elapsed=0,h.removeTween(this),this._onComplete()):this._onProgress(this._ease(b/this._duration));this._elapsed=b};return c}();h.Tween=d})(base||(base={}));
(function(h){var d=function(){function c(){this._music=null;this._soundQueue=[];this._musicVolume=this._soundVolume=1}c.prototype.getVolume=function(){return Waud.getVolume()};c.prototype.setVolume=function(b){Waud.setVolume(h.clamp(b,0,1));return this};c.prototype.getSoundVolume=function(){return this._soundVolume};c.prototype.setSoundVolume=function(b){this._soundVolume=h.clamp(b,0,1);return this};c.prototype.setMusicVolume=function(b){this._musicVolume=h.clamp(b,0,1);null!=this._music&&this._music.getWaud().setVolume(this._musicVolume*
this._music.getVolume());return this};c.prototype.stopAllSounds=function(){Waud.stop()};c.prototype.playSound=function(b){-1===this._soundQueue.indexOf(b)&&this._soundQueue.push(b);this._soundQueue.length>c.MAXSOUNDS&&this._soundQueue.shift()};c.prototype.playMusic=function(b){this._music==b&&b.getWaud().stop();this._music=b;this._music.getWaud().setVolume(this._musicVolume*this._music.getVolume());this._music.getWaud().play()};c.prototype.stopMusic=function(b){void 0===b&&(b=null);this._music==b&&
this._music.getWaud().stop()};c.prototype.stopSound=function(b){var a=this._soundQueue.indexOf(b);0<=a?this._soundQueue.splice(a,1):b.getWaud().stop()};c.prototype.update=function(){for(;this._soundQueue.length;){var b=this._soundQueue.pop();b.getWaud().setVolume(b.getVolume()*this._soundVolume);b.getWaud().play()}};c.MAXSOUNDS=16;return c}();h.Mixer=d})(base||(base={}));
(function(h){var d=function(){function c(b){this._data=new WaudSound(b,{loop:!1,autoolay:!1,volume:1});this._volume=1;this._stereo=0}c.prototype.play=function(){h.getMixer().playSound(this);return this};c.prototype.stop=function(){h.getMixer().stopSound(this);return this};c.prototype.getVolume=function(){return this._volume};c.prototype.setVolume=function(b){this._volume=h.clamp(b,0,1);return this};c.prototype.getStereoBias=function(){return this._stereo};c.prototype.setStereoBias=function(b){void 0===
b&&(b=0);this._stereo=h.clamp(b,-1,1);return this};c.prototype.getWaud=function(){return this._data};return c}();h.Sound=d})(base||(base={}));
(function(h){var d=function(){function c(b){this._data=b;this._volume=1}c.prototype.play=function(){h.getMixer().playMusic(this)};c.prototype.stop=function(){h.getMixer().stopMusic(this)};c.prototype.getVolume=function(){return this._volume};c.prototype.setVolume=function(b){this._volume=b;return this};c.prototype.getWaud=function(){return this._data};return c}();h.Music=d})(base||(base={}));
(function(h){var d=function(){function c(b,a,c,d){void 0===b&&(b=255);void 0===a&&(a=255);void 0===c&&(c=255);void 0===d&&(d=255);this._r=h.clamp(b,0,255);this._g=h.clamp(a,0,255);this._b=h.clamp(c,0,255);this._a=h.clamp(d,0,255);this._dirty=!0;this.asString()}c.prototype.setR=function(b){this._r=h.clamp(b,0,255);this._dirty=!0;return this};c.prototype.setG=function(b){this._g=h.clamp(b,0,255);this._dirty=!0;return this};c.prototype.setB=function(b){this._b=h.clamp(b,0,255);this._dirty=!0;return this};
c.prototype.setA=function(b){this._a=h.clamp(b,0,255);this._dirty=!0;return this};c.prototype.set=function(b){this._r=b._r;this._g=b._g;this._b=b._b;this._a=b._a;b._dirty?this._dirty=!0:(this._string=b._string,this._dirty=!1);return this};c.prototype.setRGBA=function(b,a,c,d){this._r=h.clamp(b,0,255);this._g=h.clamp(a,0,255);this._b=h.clamp(c,0,255);this._a=h.clamp(d,0,255);this._dirty=!0;return this};c.prototype.getR=function(){return this._r};c.prototype.getG=function(){return this._g};c.prototype.getB=
function(){return this._b};c.prototype.getA=function(){return this._a};c.prototype.asString=function(){this._dirty&&(this._string="rgba("+(this._r|0)+","+(this._g|0)+","+(this._b|0)+","+this._a/255+")",this._dirty=!1);return this._string};c.prototype.equals=function(b){return this._r===b._r&&this._g===b._g&&this._b===b._b&&this._a===b._a};c.BLACK=new c(0,0,0,255);c.WHITE=new c(255,255,255,255);c.TRANSPARENT=new c(0,0,0,0);c.RED=new c(255,0,0,255);c.GREEN=new c(0,255,0,255);c.BLUE=new c(0,0,255,255);
c.CYAN=new c(0,255,255,255);c.MAGENTA=new c(255,0,255,255);c.YELLOW=new c(255,255,0,255);return c}();h.Color=d})(base||(base={}));
(function(h){var d;(function(a){a[a.ALPHA=0]="ALPHA";a[a.ADDITIVE=1]="ADDITIVE";a[a.MULTIPLY=2]="MULTIPLY"})(d=h.DrawMode||(h.DrawMode={}));var c;(function(a){a[a.TOP_LEFT=0]="TOP_LEFT";a[a.TOP_CENTER=1]="TOP_CENTER";a[a.TOP_RIGHT=2]="TOP_RIGHT";a[a.MIDDLE_LEFT=3]="MIDDLE_LEFT";a[a.MIDDLE=4]="MIDDLE";a[a.MIDDLE_RIGHT=5]="MIDDLE_RIGHT";a[a.BOTTOM_LEFT=6]="BOTTOM_LEFT";a[a.BOTTOM_CENTER=7]="BOTTOM_CENTER";a[a.BOTTOM_RIGHT=8]="BOTTOM_RIGHT"})(c=h.PivotPosition||(h.PivotPosition={}));var b=function(){function a(){this._prevNode=
this._nextNode=this._lastChild=this._firstChild=this._parentNode=null;this._childCount=0;this._stage=null;this._position=new h.Vec2;this._scale=new h.Vec2(1,1);this._rotation=0;this._size=new h.Vec2(0,0);this._pivot=new h.Vec2(0,0);this._matrix=new h.Matrix;this._drawmode=d.ALPHA;this._alpha=1;this._dirty=this._visible=!0}a.prototype.getParent=function(){return this._parentNode};a.prototype.getNextNode=function(){return this._nextNode};a.prototype.getPrevNode=function(){return this._prevNode};a.prototype.getFirstChild=
function(){return this._firstChild};a.prototype.getLastChild=function(){return this._lastChild};a.prototype.getChildCount=function(){return this._childCount};a.prototype.getChildCountDeep=function(){for(var a=this._childCount,b=this._firstChild;null!=b;)a+=b.getChildCountDeep(),b=b.getNextNode();return a};a.prototype.removeFromParent=function(){if(null!=this._parentNode){var a=this._parentNode;a._firstChild==this&&(a._firstChild=this._nextNode);a._lastChild==this&&(a._lastChild=this._prevNode);null!=
this._nextNode&&(this._nextNode._prevNode=this._prevNode);null!=this._prevNode&&(this._prevNode._nextNode=this._nextNode);a._childCount--;this._prevNode=this._nextNode=this._parentNode=null;this.setStage(null)}};a.prototype.addChild=function(a){a.removeFromParent();a._parentNode=this;0==this._childCount?(this._lastChild=this._firstChild=a,this._childCount=1):(a._prevNode=this._lastChild,a._nextNode=null,this._lastChild=this._lastChild._nextNode=a,this._childCount++);a.setStage(this._stage)};a.prototype.clearChildren=
function(){for(;null!=this._firstChild;)this._firstChild.removeFromParent()};a.prototype.setStage=function(a){if(this._stage!=a){this._stage=a;for(var b=this._firstChild;null!=b;)b.setStage(a),b=b._nextNode}return this};a.prototype.getStage=function(){return this._stage};a.prototype.bringToFront=function(){var a=this._parentNode;this.removeFromParent();a.addChild(this)};a.prototype.isDirty=function(){return this._dirty};a.prototype.markAsDirty=function(){this._dirty=!0};a.prototype.isVisible=function(){return this._visible};
a.prototype.setVisible=function(a){this._visible=a;return this};a.prototype.getAlpha=function(){return this._alpha};a.prototype.setAlpha=function(a){this._alpha=h.clamp(a,0,1);return this};a.prototype.getDrawMode=function(){return this._drawmode};a.prototype.setDrawMode=function(a){this._drawmode=a;return this};a.prototype.setSizeXY=function(a,b){this._size.setXY(a,b);this.markAsDirty();return this};a.prototype.setSize=function(a){this._size.set(a);this.markAsDirty();return this};a.prototype.getWidth=
function(){return this._size.x};a.prototype.getHeight=function(){return this._size.y};a.prototype.getSize=function(){return this._size};a.prototype.getPosition=function(){return this._position};a.prototype.getX=function(){return this._position.x};a.prototype.getY=function(){return this._position.y};a.prototype.setPosition=function(a){this._position.set(a);this.markAsDirty();return this};a.prototype.setPositionXY=function(a,b){this._position.setXY(a,b);this.markAsDirty();return this};a.prototype.move=
function(a){this._position.add(a);this.markAsDirty();return this};a.prototype.moveXY=function(a,b){this._position.addXY(a,b);this.markAsDirty();return this};a.prototype.getPivot=function(){return this._pivot};a.prototype.setPivotPosition=function(a){switch(a){case c.TOP_LEFT:this._pivot.setXY(0,0);break;case c.TOP_CENTER:this._pivot.setXY(.5*this._size.x,0);break;case c.TOP_RIGHT:this._pivot.setXY(this._size.x,0);break;case c.MIDDLE_LEFT:this._pivot.setXY(0,.5*this._size.y);break;case c.MIDDLE:this._pivot.setXY(.5*
this._size.x,.5*this._size.y);break;case c.MIDDLE_RIGHT:this._pivot.setXY(this._size.x,.5*this._size.y);break;case c.BOTTOM_LEFT:this._pivot.setXY(0,this._size.y);break;case c.BOTTOM_CENTER:this._pivot.setXY(.5*this._size.x,this._size.y);break;case c.BOTTOM_RIGHT:this._pivot.setXY(this._size.x,this._size.y)}this._dirty=!0;return this};a.prototype.setPivot=function(a){this._pivot.set(a);this._dirty=!0;return this};a.prototype.setPivotXY=function(a,b){this._pivot.setXY(a,b);this._dirty=!0;return this};
a.prototype.getScale=function(){return this._scale};a.prototype.setScale=function(a){this._scale.set(a);this.markAsDirty();return this};a.prototype.setScaleXY=function(a,b){void 0===b&&(b=a);this._scale.setXY(a,b);this.markAsDirty();return this};a.prototype.scale=function(a){this._scale.multiply(a);this.markAsDirty();return this};a.prototype.scaleXY=function(a,b){void 0===b&&(b=a);this._scale.multiplyXY(a,b);this.markAsDirty();return this};a.prototype.getRotation=function(){return h.toDegree(this._rotation)};
a.prototype.setRotation=function(a){this._rotation=h.toRadian(h.wrap(a,0,360));this.markAsDirty();return this};a.prototype.rotate=function(a){this._rotation=h.toRadian(h.wrap(h.toDegree(this._rotation)+a,0,360));this.markAsDirty();return this};a.prototype.getMatrix=function(){this._dirty&&(this._matrix.buildNodeMatrix(this._position,this._scale,this._pivot,this._rotation),this._dirty=!1);return this._matrix};a.prototype.draw=function(a,b,c){};return a}();h.Node=b})(base||(base={}));
(function(h){var d=function(c){function b(a){void 0===a&&(a=h.Color.WHITE);var b=c.call(this)||this;b._color=new h.Color;b._color.set(a);return b}__extends(b,c);b.prototype.draw=function(a,b,c){a.setMatrix(h.Matrix.IDENTITY);a.setAlpha(c);a.setDrawMode(this.getDrawMode());a.setFillColor(this._color);a.drawRectFilled(0,0,a.getWidth(),a.getHeight())};return b}(h.Node);h.ColorLayer=d})(base||(base={}));
(function(h){var d=function(){return function(){}}();h.AnimationFrame=d;var c=function(){function b(a,b,c){this._source=a;this._frames=[];this._frameWidth=b;this._frameHeight=c;this._frameCount=0}b.prototype.getSource=function(){return this._source};b.prototype.getFrameWidth=function(){return this._frameWidth};b.prototype.getFrameHeight=function(){return this._frameHeight};b.prototype.getFrameCount=function(){return this._frameCount};b.prototype.getFrame=function(a){return this._frames[a%this._frameCount]};
b.prototype.addFrame=function(a,b,c,l){void 0===c&&(c=this._frameWidth);void 0===l&&(l=this._frameHeight);var k=new d;k.x=a;k.y=b;k.w=c;k.h=l;this._frames.push(k);this._frameCount++;return this};b.prototype.addFrameIndex=function(a,b,c,d,k){void 0===b&&(b=this._frameWidth);void 0===d&&(d=0);void 0===k&&(k=0);c=this._source.getWidth();this._source.getHeight();this.addFrame((d+a*b)%c,k+(d+a*b)/c|0);return this};b.prototype.addFrameSequence=function(a,b,c,d,k){void 0===b&&(b=0);void 0===c&&(c=0);void 0===
d&&(d=this._frameWidth);void 0===k&&(k=this._frameHeight);var h=this._source.getWidth();this._source.getHeight();for(var n=0;n<a;++n)this.addFrame(b,c,d,k),b+=d,b>h&&(b-=h,c+=k);return this};return b}();h.Animation=c;c=function(){function b(a){this._oncomplete=new h.SafeList;this._animation=a;this._srect=new h.Rect;this._currentFrame=0;this._looping=!1;this._animSpeed=16;this._elapsed=0;this.setFrame(0)}b.prototype.sync=function(a){this._elapsed=a._elapsed};b.prototype.getElement=function(){return this._animation.getSource().getElement()};
b.prototype.getWidth=function(){return this._animation.getFrameWidth()};b.prototype.getHeight=function(){return this._animation.getFrameHeight()};b.prototype.getSampleRect=function(){return this._srect};b.prototype.setFrame=function(a){this._currentFrame=this._looping?a%this._animation.getFrameCount():h.clamp(a,0,this._animation.getFrameCount()-1);a=this._animation.getFrame(this._currentFrame);this._srect.position.setXY(a.x,a.y);this._srect.size.setXY(a.w,a.h);return this};b.prototype.getFrame=function(){return this._currentFrame};
b.prototype.setLooping=function(a){this._looping=a;return this};b.prototype.isLooping=function(){return this._looping};b.prototype.setAnimationSpeed=function(a){this._animSpeed=a;return this};b.prototype.getAnimationSpeed=function(){return this._animSpeed};b.prototype.start=function(){h.addAnimator(this);return this};b.prototype.stop=function(){h.removeAnimator(this);return this};b.prototype.reset=function(){this.setFrame(0);return this};b.prototype.onComplete=function(a){this._oncomplete.add(a);
return this};b.prototype.clearOnComplete=function(){this._oncomplete.clear();return this};b.prototype.update=function(a){if(0!=this._animSpeed){var b=1/this._animSpeed;for(a=this._elapsed+a;a>=b;)this.setFrame(this._currentFrame+1),a-=b;this._elapsed=a;this._looping||this._currentFrame!==this._animation.getFrameCount()-1||(this._oncomplete.forEach(function(a){return a()}),h.removeAnimator(this))}};return b}();h.Animator=c})(base||(base={}));
(function(h){var d=function(){function c(b){this._surface=b;this._context=b.getContext();this._drawmode=h.DrawMode.ALPHA;this._matrix=new h.Matrix;this._alpha=1;this._fillColor=new h.Color(0,0,0,255);this._lineColor=new h.Color(255,255,255,255);this._lineWidth=1;this.restore()}c.prototype.getSurface=function(){return this._surface};c.prototype.getContext=function(){return this._context};c.prototype.getWidth=function(){return this._surface.getWidth()};c.prototype.getHeight=function(){return this._surface.getHeight()};
c.prototype.restore=function(){this.setDrawMode(this._drawmode,!0);this._context.setTransform(1,0,0,1,0,0);this._context.globalAlpha=this._alpha;this._context.fillStyle=this._fillColor.asString();this._context.strokeStyle=this._lineColor.asString();this._context.lineWidth=this._lineWidth};c.prototype.setDrawMode=function(b,a){void 0===a&&(a=!1);if(a||b!==this._drawmode){switch(b){case h.DrawMode.ADDITIVE:this._context.globalCompositeOperation="lighter";break;case h.DrawMode.MULTIPLY:this._context.globalCompositeOperation=
"multiply";break;default:this._context.globalCompositeOperation="source-over"}this._drawmode=b}};c.prototype.setMatrix=function(b){this._matrix.equals(b)||(this._matrix.set(b),this._context.setTransform(b.a,b.b,b.c,b.d,b.tx,b.ty))};c.prototype.getMatrix=function(){return this._matrix};c.prototype.setAlpha=function(b){b=h.clamp(b,0,1);this._alpha!==b&&(this._alpha=this._context.globalAlpha=b)};c.prototype.getAlpha=function(){return this._alpha};c.prototype.setFillColor=function(b){this._fillColor.equals(b)||
(this._fillColor.set(b),this._context.fillStyle=b.asString())};c.prototype.getFillColor=function(){return this._fillColor};c.prototype.setLineColor=function(b){this._lineColor.equals(b)||(this._lineColor.set(b),this._context.strokeStyle=b.asString())};c.prototype.getLineColor=function(){return this._lineColor};c.prototype.setLineWidth=function(b){b=h.clamp(b,.001,100);b!==this._lineWidth&&(this._lineWidth=this._context.lineWidth=b)};c.prototype.getLineWidth=function(){return this._lineWidth};c.prototype.drawRectFilled=
function(b,a,c,d){this._context.fillRect(b,a,c,d)};c.prototype.drawRectOutline=function(b,a,c,d){this._context.strokeRect(b,a,c,d)};c.prototype.drawImage=function(b,a,c,d,l){var k=b.getElement();b=b.getSampleRect();this._context.drawImage(k,b.position.x,b.position.y,b.size.x,b.size.y,a,c,d,l)};return c}();h.Renderer=d})(base||(base={}));
(function(h){var d=function(){function c(b){this._element=b;this._width=b.width;this._height=b.height;this._srect=new h.Rect(0,0,this._width,this._height)}c.prototype.getElement=function(){return this._element};c.prototype.getWidth=function(){return this._width};c.prototype.getHeight=function(){return this._height};c.prototype.getSampleRect=function(){return this._srect};return c}();h.Image=d})(base||(base={}));
(function(h){var d=function(){function c(b){void 0===b&&(b=null);this._element=null===b?window.document.createElement("canvas"):b;this._context=this._element.getContext("2d");this._width=this._element.width;this._height=this._element.height;this._srect=new h.Rect(0,0,this._width,this._height);this._renderer=null}c.prototype.getElement=function(){return this._element};c.prototype.getWidth=function(){return this._width};c.prototype.getHeight=function(){return this._height};c.prototype.setSize=function(b,
a){b|=0;a|=0;this._element.style.width=b+"px";this._element.style.height=a+"px";this._element.width=b;this._element.height=a;this._width=b;this._height=a;this._srect.position.setXY(0,0);this._srect.size.setXY(b,a)};c.prototype.getRenderer=function(){null==this._renderer&&(this._renderer=new h.Renderer(this));return this._renderer};c.prototype.getContext=function(){return this._context};c.prototype.getSampleRect=function(){return this._srect};c.prototype.setSampleRect=function(b,a,c,d){this._srect.position.setXY(b,
a);this._srect.size.setXY(c,d);return this};return c}();h.Surface=d})(base||(base={}));
(function(h){var d=function(c){function b(a){var b=c.call(this)||this;b.setImageSource(a);return b}__extends(b,c);b.prototype.draw=function(a,b,c){var d=this.getPivot();a.setDrawMode(this.getDrawMode());a.setAlpha(c);a.setMatrix(b);a.drawImage(this._image,-d.x,-d.y,this.getWidth(),this.getHeight())};b.prototype.setImageSource=function(a){this._image=a;this.setSize(a.getSampleRect().size);this.setPivotPosition(h.PivotPosition.MIDDLE)};return b}(h.Node);h.Sprite=d})(base||(base={}));
(function(h){var d=function(){return function(){this.aadd=this.sadd=this.yadd=this.xadd=this.a=this.s=this.y=this.x=0}}(),c=function(a){function c(){var d=a.call(this)||this;d._systems=[];d._params=new b;d._params.direction.setXY(1,0);d._projected_position=new h.Vec2;d._projected_direction=new h.Vec2;d._interval=.1;d._elapsed=0;return d}__extends(c,a);c.prototype.setRate=function(a){a=Math.max(1,a);this._interval=1/a;return this};c.prototype.getRate=function(){return 1/this._interval};c.prototype.setParticleSpeed=
function(a,b){this._params.speed_min=a;this._params.speed_max=b;return this};c.prototype.setParticleLife=function(a,b){this._params.life_min=.001*a;this._params.life_max=.001*b;return this};c.prototype.setParticleScale=function(a,b,c){this._params.scale_iniital=a;this._params.scale_delta_min=b;this._params.scale_delta_max=c;return this};c.prototype.setParticleSpread=function(a){this._params.spread=a;return this};c.prototype.setParticleAngle=function(a){a=h.toRadian(a);this._params.direction.x=Math.cos(a);
this._params.direction.y=Math.sin(a);return this};c.prototype.getParticleAngle=function(){return h.toDegree(Math.atan2(this._params.direction.y,this._params.direction.x))};c.prototype.addSystem=function(a){0>this._systems.indexOf(a)&&this._systems.push(a);return this};c.prototype.removeSystem=function(a){a=this._systems.indexOf(a);0<=a&&this._systems.splice(a,1);return this};c.prototype.draw=function(a,b,c){a=h.getTimeDelta();var d=this._elapsed+a;a=0;c=b.project(h.Vec2.ZERO,this._projected_position);
this.getStage().screenToWorld(c,c);b=b.project(this._params.direction,this._projected_direction);this.getStage().screenToWorld(b,b);b.subtract(c);for(b.normalize();d>this._interval;)++a,d-=this._interval;this._elapsed=d;if(0<a)for(var d=0,e=this._systems.length;d<e;++d)this._systems[d].spawn(a,c,b,this._params)};return c}(h.Node);h.ParticleEmitter=c;var b=function(){return function(){this.direction=new h.Vec2;this.spread=10;this.speed_min=100;this.speed_max=250;this.life_min=1;this.life_max=1.5;this.scale_iniital=
1;this.scale_delta_min=-.5;this.scale_delta_max=.5}}();h.ParticleSpawnParameters=b;c=function(a){function b(c,e){void 0===e&&(e=256);var k=a.call(this)||this;k._image=c;k._pool=new h.Pool(e,function(){return new d});k._reap=[];k._gravity=new h.Vec2;k._scroll=new h.Vec2;k._random=new h.Random;k._inverse=new h.Matrix;k._tpos=new h.Vec2;return k}__extends(b,a);b.prototype.sanitize=function(a){a.life_min=Math.max(a.life_min,.01);a.life_max=Math.max(a.life_max,.015)};b.prototype.spawn=function(a,b,c,d){this.sanitize(d);
this._inverse.set(this.getMatrix());for(var e=this.getParent();null!=e;)this._inverse.prepend(e.getMatrix()),e=e.getParent();this._inverse.invert();this._inverse.project(b,this._tpos);b=h.toDegree(Math.atan2(c.y,c.x));c=.5*d.spread;d.direction.normalize();for(e=0;e<a;++e){var m=this._pool.alloc(),w=this._random.nextInRange(d.speed_min,d.speed_max),g=this._random.nextInRange(d.life_min,d.life_max),q=this._random.nextInRange(d.scale_delta_min,d.scale_delta_max),v=this._random.nextInRange(b-c,b+c),v=
h.toRadian(v);m.x=this._tpos.x;m.y=this._tpos.y;m.s=d.scale_iniital;m.a=1;m.xadd=Math.cos(v)*w;m.yadd=Math.sin(v)*w;m.aadd=-1/g;m.sadd=q}};b.prototype.getGravity=function(){return this._gravity};b.prototype.setGravity=function(a){this._gravity.set(a);return this};b.prototype.getScroll=function(){return this._scroll};b.prototype.setScroll=function(a){this._scroll.set(a);return this};b.prototype.update=function(){for(var a=h.getTimeDelta(),b=this._gravity,c=this._scroll,d=b.x*a,b=b.y*a,e=c.x*a,c=c.y*
a,m=0,w=this._pool.getUsedCount();m<w;++m){var g=this._pool.getUsed(m);g.x+=g.xadd*a+e;g.y+=g.yadd*a+c;g.s+=g.sadd*a;g.a+=g.aadd*a;g.xadd+=d;g.yadd+=b;0>g.a&&this._reap.push(g)}for(;this._reap.length;)this._pool.free(this._reap.pop())};b.prototype.draw=function(a,b,c){this.update();a.setDrawMode(this.getDrawMode());a.setMatrix(b);a.setAlpha(c);a=a.getContext();var d=this._image.getSampleRect();b=this._image.getElement();for(var e=d.position.x,h=d.position.y,w=d.size.x,d=d.size.y,g=.5*w,q=0,v=this._pool.getUsedCount();q<
v;++q){var t=this._pool.getUsed(q);a.globalAlpha=t.a*c;a.drawImage(b,e,h,w,d,t.x-g*t.s,t.y-g*t.s,w*t.s,d*t.s)}a.globalAlpha=c};return b}(h.Node);h.ParticleSystem=c})(base||(base={}));
(function(h){var d=function(){return function(){this.y=this.x=0;this.h=this.w=16;this.yoffset=this.xoffset=0;this.advance=16;this.kerning={}}}();h.Glyph=d;var c=function(){function b(a){this._image=a;this._lineHeight=12;this._lineBase=0;this._glyphs={}}b.prototype.getImage=function(){return this._image};b.prototype.getLineHeight=function(){return this._lineHeight};b.prototype.getLineBase=function(){return this._lineBase};b.prototype.defineGlyph=function(a,b,c,l,k,h,n,m){var w=new d;w.x=b;w.y=c;w.w=
l;w.h=k;w.xoffset=h;w.yoffset=n;w.advance=m;this._glyphs[a]=w;return this};b.prototype.defineKerning=function(a,b,c){a=this._glyphs[a];if(!a)return null;a.kerning[b]=c;return this};b.prototype.getGlyph=function(a){return(a=this._glyphs[a])?a:null};b.prototype.getKerning=function(a,b){var c=this.getGlyph(a);return c?(c=c.kerning[b])?c:0:0};b.prototype.parseCommon=function(a){var b=parseInt(a.getAttribute("lineHeight"));a=parseInt(a.getAttribute("base"));this._lineHeight=b;this._lineBase=a};b.prototype.parseChars=
function(a){for(var b=0,c=a.childNodes[0];void 0!=c;)"char"===c.nodeName&&this.parseChar(c),c=a.childNodes[++b]};b.prototype.parseChar=function(a){var b=parseInt(a.getAttribute("id")),c=parseInt(a.getAttribute("x")),d=parseInt(a.getAttribute("y")),k=parseInt(a.getAttribute("width")),h=parseInt(a.getAttribute("height")),n=parseInt(a.getAttribute("xoffset")),m=parseInt(a.getAttribute("yoffset"));a=parseInt(a.getAttribute("xadvance"));this.defineGlyph(String.fromCharCode(b),c,d,k,h,n,m,a)};b.prototype.parseKernings=
function(a){for(var b=0,c=a.childNodes[0];void 0!=c;)"kerning"===c.nodeName&&this.parseKern(c),c=a.childNodes[++b]};b.prototype.parseKern=function(a){var b=parseInt(a.getAttribute("first")),c=parseInt(a.getAttribute("second"));a=parseInt(a.getAttribute("amount"));this.defineKerning(String.fromCharCode(b),String.fromCharCode(c),a)};b.prototype.initFromXML=function(a){for(a=a.firstChild.firstChild;null!=a;)"common"===a.nodeName?this.parseCommon(a):"chars"===a.nodeName?this.parseChars(a):"kernings"===
a.nodeName&&this.parseKernings(a),a=a.nextSibling;return this};return b}();h.Font=c})(base||(base={}));
(function(h){var d=function(){return function(){}}(),c=function(b){function a(a,c){void 0===c&&(c="");var l=b.call(this)||this;l._font=a;l._text=c;l._render=new h.StaticList(c.length,function(){return new d});l._length=0;l._bounds=new h.Rect;l.rebuild();return l}__extends(a,b);a.prototype.setFont=function(a){this._font=a;this.rebuild();return this};a.prototype.setText=function(a){this._text=a;this.rebuild();return this};a.prototype.getBounds=function(){return this._bounds};a.prototype.getText=function(){return this._text};
a.prototype.rebuild=function(){var a=this._text,b=this._length=a.length;this._render.clear();this._bounds.position.setXY(0,0);this._bounds.size.y=this._font.getLineHeight();for(var c=0,d=0;d<b;++d){var h=a.charAt(d),n=this._font.getGlyph(h);if(n&&0<n.w&&0<n.h){var m=this._render.getNext(),w=0;d<b-1&&(w=this._font.getKerning(h,a.charAt(d+1)));m.sx=n.x;m.sy=n.y;m.sw=n.w;m.sh=n.h;m.dx=c+n.xoffset;m.dy=0+n.yoffset;m.dw=n.w;m.dh=n.h}c+=n.advance+w}this._bounds.size.x=c;this.setSize(this._bounds.size)};
a.prototype.draw=function(a,b,c){a.setMatrix(b);a.setDrawMode(this.getDrawMode());a.setAlpha(c);a=a.getContext();b=this._font.getImage().getElement();c=this.getPivot();for(var d=0,h=this._render.size();d<h;++d){var n=this._render.get(d);a.drawImage(b,n.sx,n.sy,n.sw,n.sh,n.dx-c.x,n.dy-c.y,n.dw,n.dh)}};return a}(h.Node);h.Text=c})(base||(base={}));
(function(h){var d=function(){function c(b){this._position=new h.Vec2;this._scaling=new h.Vec2(1,1);this._rotation=0;this._matrix=new h.Matrix;this._dirty=!0;this._stage=b}c.prototype.getPosition=function(){return this._position};c.prototype.setPosition=function(b){this._position.set(b);this._dirty=!0;this._stage.markAsDirty();return this};c.prototype.move=function(b){this._position.add(b);this._dirty=!0;this._stage.markAsDirty();return this};c.prototype.getZoom=function(){return this._scaling.x};
c.prototype.setZoom=function(b){this._scaling.setXY(b,b);this._dirty=!0;this._stage.markAsDirty();return this};c.prototype.getRotation=function(){return h.toDegree(this._rotation)};c.prototype.setRotation=function(b){this._rotation=h.toRadian(h.wrap(b,0,360));this._dirty=!0;this._stage.markAsDirty();return this};c.prototype.rotate=function(b){this._rotation=h.toRadian(h.wrap(h.toDegree(this._rotation)+b,0,360));this._dirty=!0;this._stage.markAsDirty();return this};c.prototype.getMatrix=function(){this._dirty&&
(this._position.invert(),this._matrix.buildNodeMatrix(this._position,this._scaling,h.Vec2.ZERO,-this._rotation),this._position.invert(),this._dirty=!1);return this._matrix};return c}();h.Camera=d})(base||(base={}));
(function(h){var d=function(){return function(){this.node=null;this.matrix=new h.Matrix;this.alpha=1}}(),c=function(){function b(a){void 0===a&&(a=null);this._root=new h.Node;this._camera=new h.Camera(this);this._drawOrder=new h.StaticList(128,function(){return new d});this._matrix=new h.Matrix;this._invMatrix=new h.Matrix;this._tempvector=new h.Vec2;this._dirty=!0;null===a&&(a=h.getScreen());this._output=a;this._root.setStage(this)}b.prototype.markAsDirty=function(){this._dirty=!0;return this};b.prototype.isDirty=
function(){return this._dirty};b.prototype.getOutput=function(){return this._output};b.prototype.setOutput=function(a){this._output=null==a?h.getScreen():a;return this};b.prototype.getCamera=function(){return this._camera};b.prototype.addChild=function(a){this._root.addChild(a);return this};b.prototype.clearChildren=function(){this._root.clearChildren();return this};b.prototype.getChildCount=function(){return this._root.getChildCount()};b.prototype.getChildCountDeep=function(){return this._root.getChildCountDeep()};
b.prototype.getDrawables=function(a,b,c){for(a=a.getFirstChild();null!=a;){if(a.isVisible()){var d=this._drawOrder.getNext();d.node=a;d.matrix.set(b).multiply(a.getMatrix());d.alpha=d.node.getAlpha()*c;this.getDrawables(a,d.matrix,d.alpha)}a=a.getNextNode()}};b.prototype.draw=function(){this.updateMatrix();this._drawOrder.clear();this.getDrawables(this._root,this._matrix,1);for(var a=this._output.getRenderer(),b=0,c=this._drawOrder.size();b<c;++b){var d=this._drawOrder.get(b);d.node.draw(a,d.matrix,
d.alpha)}};b.prototype.updateMatrix=function(){this._dirty&&(this._matrix.identity().translateXY(.5*this._output.getWidth(),.5*this._output.getHeight()).multiply(this._camera.getMatrix()),this._invMatrix.set(this._matrix).invert())};b.prototype.screenToWorld=function(a,b){void 0===b&&(b=this._tempvector);this.updateMatrix();return this._invMatrix.project(a,b)};b.prototype.worldToScreen=function(a,b){void 0===b&&(b=this._tempvector);this.updateMatrix();return this._matrix.project(a,b)};return b}();
h.Stage=c})(base||(base={}));
(function(h){function d(){var a=function(a){if(0!=a.touches.length){a=a.touches[0];var b=m.getBoundingClientRect();z.updateTouchPosition((a.clientX-(b.left|0))/H,(a.clientY-(b.top|0))/H)}},b=function(a){var b=m.getBoundingClientRect();A.mouseMoved((a.clientX-(b.left|0))/H,(a.clientY-(b.top|0))/H)},c=function(a){a.stopPropagation();a.preventDefault()},d=function(a){switch(a){case 18:case 115:case 116:case 122:case 123:return!0}return!1};window.onkeydown=function(a){K&&e();J&&f();y.keyDown(a.keyCode);
y._executeNativeHandlers(a);d(a.keyCode)||c(a)};window.onkeyup=function(a){y.keyUp(a.keyCode);y._executeNativeHandlers(a);d(a.keyCode)||c(a)};window.onmousedown=function(a){K&&e();J&&f();b(a);A.buttonDown(a.button);c(a)};window.oncontextmenu=function(a){b(a);A.buttonDown(a.button);c(a)};window.onmouseup=function(a){b(a);A.buttonUp(a.button);c(a)};window.onmousemove=function(a){b(a);c(a)};window.onmousewheel=function(a){b(a);A.buttonDown(0<a.wheelDelta?h.MouseButton.WHEEL_UP:h.MouseButton.WHEEL_DOWN);
c(a)};window.ontouchstart=function(b){a(b);z.touchStart();b.stopPropagation()};window.ontouchmove=function(b){a(b);b.stopPropagation()};window.ontouchend=function(b){a(b);z.touchEnd();b.stopPropagation()};document.addEventListener("gesturestart",function(a){a.stopPropagation();a.preventDefault()})}function c(a){F=a-C;E=C;C=a;667<F&&(F=0);G=.001*F}function b(a){c(a);y.update();A.update();z.update();t.forEach(function(a){return a.update(F)});p.forEach(function(a){return a.update(F)});u.forEach(function(a){return a.update(G)});
v.forEach(function(a){return a()});B.update();requestAnimationFrame(b)}function a(){w=x.RUN;n.innerHTML="";n.appendChild(m);k(D,I);n.style.width="100%";n.style.height="100%";m.style.left="50%";m.style.top="50%";m.style.transform="translate(-50%,-50%)";m.style.position="absolute";var a=function(){h.onResize();H=Math.min(window.innerWidth/D,window.innerHeight/I);m.style.width=(D*H|0)+"px";m.style.height=(I*H|0)+"px"};window.onresize=a;a();requestAnimationFrame(b)}function e(){K=!1;try{return screenfull.request(m),
!0}catch(a){console.error("Failed to request fullscreen mode through screenfull.js")}return!1}function f(){J=!1;m.requestPointerLock();return!0}function l(a){console.log(a);if(w===x.LOAD&&(q.add(a),w===x.LOAD)){a="";for(var b=0;b<q.size();++b){var c=q.get(b);a+="<span>"+c+"</span><br>"}n.innerHTML=a}}function k(a,b){D=a|0;I=b|0;n.style.width=D+"px";n.style.height=I+"px";r.setSize(D,I)}var x;(function(a){a[a.LOAD=0]="LOAD";a[a.RUN=1]="RUN"})(x||(x={}));var n=document.getElementById("game"),m=document.createElement("canvas"),
w=x.LOAD,g=new h.Loader,q=new h.Ringbuffer(16),v=new h.SafeList,t=new h.SafeList,p=new h.SafeList,u=new h.SafeList,r=new h.Surface(m),B=new h.Mixer,y=new h.Keyboard,A=new h.Mouse,z=new h.Touch,C=0,E=0,F=0,G=0,D=800,I=600,H=1,K=!1,J=!1;g.onProgress=function(a){l(a)};g.onError=function(a){l(a);l("Opening space inventory...");throw Error("Opening space inventory...");};try{Waud.init()}catch(M){console.error("Failed to init Waud.js - sound will not be available")}requestAnimationFrame(c);n.style.width=
D+"px";n.style.height=I+"px";console.log("***        Uncool Bens Jam Base        ***");console.log("***  Oldskool spirit - newschool tech  ***");h.onResize=function(){};h.start=function(b,c){void 0===b&&(b=null);void 0===c&&(c=function(){});d();null!=b?(g.onComplete=function(){g.hasFailed()||(a(),c())},g.load(b),l("Loading "+b.size()+" items...")):(a(),c())};h.log_preload=l;h.getTimeCurrent=function(){return C};h.getTimeLast=function(){return E};h.getTimeDelta=function(){return G};h.getTimeDeltaMillis=
function(){return F};h.getScreen=function(){return r};h.getMixer=function(){return B};h.getKeyboard=function(){return y};h.getMouse=function(){return A};h.getTouch=function(){return z};h.setScreenSize=k;h.getLoader=function(){return g};h.addLoop=function(a){v.add(a)};h.removeLoop=function(a){v.remove(a)};h.addTimer=function(a){t.add(a)};h.removeTimer=function(a){t.remove(a)};h.addTween=function(a){p.add(a)};h.removeTween=function(a){p.remove(a)};h.addAnimator=function(a){u.add(a)};h.removeAnimator=
function(a){u.remove(a)};h.requestMouseCapture=function(){J=!0};h.exitMouseCaputre=function(){try{document.exitPointerLock()}catch(a){console.log("Cannot exit pointer lock")}};h.requestFullscreen=function(){K=!0};h.exitFullscreen=function(){try{return screenfull.exit(),!0}catch(a){console.error("Failed to exit fullscreen mode through screenfull.js")}return!1}})(base||(base={}));var game;
(function(h){var d=function(c){function b(){return c.call(this,h.loader.getImage("crosshair"))||this}__extends(b,c);b.prototype.update=function(){var a=base.getMouse(),a=h.stage.screenToWorld(a.getPosition());this.setPosition(a);this.setScaleXY(.75+.025*Math.sin(.005*base.getTimeCurrent()))};return b}(base.Sprite);h.Crosshair=d})(game||(game={}));
(function(h){var d=function(){function c(b){this._sprite=b;this._sprite.setVisible(!1);this._alive=!1;var a=b.getWidth();b=b.getHeight();this._bounds=new base.Rect(-a,-b,a,b);h.game.addActor(this)}c.prototype.isAlive=function(){return this._alive};c.prototype.spawn=function(b){this._sprite.setPosition(b);this._sprite.setVisible(!0);this._alive=!0};c.prototype.die=function(){this._sprite.setVisible(!1);this._alive=!1};c.prototype.getSprite=function(){return this._sprite};c.prototype.getBounds=function(){return this._bounds};
c.prototype.update=function(){};return c}();h.Actor=d})(game||(game={}));
(function(h){var d=function(c){function b(){var a=c.call(this,new base.Sprite(base.getLoader().getImage("laser")))||this;a._sound=base.getLoader().getSound("laser");a._direction=new base.Vec2;a._speed=100;a._temp=new base.Vec2;return a}__extends(b,c);b.prototype.setDirection=function(a){this._direction.set(a).normalize()};b.prototype.setSpeed=function(a){this._speed=a};b.prototype.update=function(){this.isAlive()&&(this._temp.set(this._direction).multiplyXY(this._speed),this.getSprite().move(this._temp))};
return b}(h.Actor);h.Bullet=d})(game||(game={}));
(function(h){var d=function(){function c(){var b=this;null===c.animation&&(c.animation=new base.Animation(h.loader.getImage("explosion"),134,134),c.animation.addFrameSequence(12));this._animator=new base.Animator(c.animation);this._sprite=new base.Sprite(this._animator);this._animator.onComplete(function(){b._animator.reset();b._sprite.setVisible(!1);b._sprite.removeFromParent()});this._sound=h.loader.getSound("explosion1")}c.prototype.spawn=function(b){this._sprite.setPosition(b);this._sprite.setScaleXY(1);
this._sprite.setVisible(!0);this._animator.reset();this._animator.start();this._sound.play()};c.prototype.getSprite=function(){return this._sprite};c.animation=null;return c}();h.Explosion=d})(game||(game={}));
(function(h){var d=function(c){function b(){var a=c.call(this,new base.Sprite(h.loader.getImage("player")))||this,b=base.getScreen().getWidth(),d=base.getScreen().getHeight();a._moveBounds=new base.Rect(.5*-b,.5*-d,b,d);return a}__extends(b,c);b.prototype.update=function(){var a=base.getMouse(),b=base.getKeyboard(),a=h.stage.screenToWorld(a.getPosition()),c=0,d=0;b.isKeyDown(base.Keys.W)&&(d-=225);b.isKeyDown(base.Keys.S)&&(d+=225);b.isKeyDown(base.Keys.A)&&(c-=225);b.isKeyDown(base.Keys.D)&&(c+=
225);var k=base.getTimeDelta(),b=this.getSprite();b.moveXY(c*k,d*k);c=b.getPosition();d=this.getBounds();d.position.setXY(c.x-.5*b.getWidth(),c.y-.5*b.getHeight());this._moveBounds.confine(d);b.setPositionXY(d.position.x+.5*b.getWidth(),d.position.y+.5*b.getHeight());a=base.wrap(base.toDegree(Math.atan2(c.y-a.y,a.x-c.x)),0,360);c=!1;90<a&&(c=!0);270<a&&(c=!1);b.setRotation(c?180-a:a);b.setScaleXY(c?-1:1,1)};return b}(h.Actor);h.Player=d})(game||(game={}));
(function(h){h.loader=base.getLoader();h.stage=new base.Stage;h.game=null;h.start=function(){h.game=new d;h.game.init()};var d=function(){function c(){var b=this;this.explosions=[];base.addLoop(function(){b.update()});for(var a=0;16>a;++a)this.explosions[a]=new h.Explosion;this.actors=new base.SafeList;this.background=new base.Sprite(base.getLoader().getImage("background"));h.stage.addChild(this.background);this.actorLayer=new base.Node;h.stage.addChild(this.actorLayer);this.fxLayer=new base.Node;
h.stage.addChild(this.fxLayer);this.uiLayer=new base.Node;h.stage.addChild(this.uiLayer);this.font=h.loader.getFont("font");this.text=new base.Text(this.font,"Score: 0000");this.text.setPivotPosition(base.PivotPosition.MIDDLE);this.text.setPositionXY(0,-250);this.uiLayer.addChild(this.text)}c.prototype.init=function(){this.player=new h.Player;this.player.spawn(new base.Vec2);this.crosshair=new h.Crosshair;this.uiLayer.addChild(this.crosshair);this.particles=new base.ParticleSystem(h.loader.getImage("dot"));
this.fxLayer.addChild(this.particles);this.emitter=new base.ParticleEmitter;this.emitter.addSystem(this.particles);this.crosshair.addChild(this.emitter);this.emitter.setRate(100);this.particles.setGravity(new base.Vec2(0,200))};c.prototype.addActor=function(b){this.actors.add(b);this.actorLayer.addChild(b.getSprite())};c.prototype.removeActor=function(b){this.actors.remove(b);b.getSprite().removeFromParent()};c.prototype.update=function(){var b=base.getMouse(),a=h.stage.screenToWorld(b.getPosition());
this.emitter.rotate(1);b.isButtonPressed(base.MouseButton.LEFT)&&(b=this.explosions.pop(),b.spawn(a),this.fxLayer.addChild(b.getSprite()),this.explosions.unshift(b));this.actors.forEach(function(a){return a.update()});this.crosshair.update();this.background.setScaleXY(1+.05*Math.cos(1.5E-4*base.getTimeLast()));this.background.setRotation(5*Math.sin(2.5E-4*base.getTimeCurrent()));h.stage.draw()};return c}();h.Game=d})(game||(game={}));var main;
(function(h){h=new base.AssetList;h.setImageBaseURL("gfx/");h.setSoundBaseURL("sfx/");h.setMusicBaseURL("mus/");h.setFontBaseUrl("font/");h.addImage("player","dude.png");h.addImage("enemy","enemy.png");h.addImage("bullet","laser.png");h.addImage("crosshair","crosshair.png");h.addImage("explosion","explosion_anim.png");h.addImage("background","space.png");h.addImage("dot","dot.png");h.addFont("font","font.xml","font.png");h.addSound("explosion1","explosion1.mp3");h.addSound("laser","laser.mp3");base.log_preload("*** The Greatest Game Ever Initializing ***");
base.log_preload("   ");base.start(h,function(){game.start()})})(main||(main={}));
